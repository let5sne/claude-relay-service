import{a as js}from"./element-plus-CqiD73Lu.js";import{r as I,aP as Os,o as le,V as Fs,x as n,y as o,z as e,L as k,K as y,al as $e,aT as Rt,O as $,aq as A,aa as Ds,P as p,aV as Jt,aY as as,C as M,c as Ge,q as Yt,I as Ne,an as oe,Q as ae,ac as ue,a5 as ls,R as Fe,B as lt,u as Ue,_ as Ns,J as Mt,Y as at}from"./vue-vendor-Bsazo-x0.js";import{c as O,s as R,_ as os}from"./index-D3EStWnN.js";import{C as _s}from"./ConfirmModal-F2VIa16J.js";import{C as ss}from"./CustomDropdown-Bozi2pIv.js";import"./vendor-Dr8jvgFu.js";const Ht=I(!1),Us=I({title:"",message:"",confirmText:"继续",cancelText:"取消"}),rt=I(null);function Vs(){return{showConfirmModal:Ht,confirmOptions:Us,showConfirm:(ge,V,G="继续",X="取消")=>new Promise(g=>{Us.value={title:ge,message:V,confirmText:G,cancelText:X},rt.value=g,Ht.value=!0}),handleConfirm:()=>{Ht.value=!1,rt.value&&(rt.value(!0),rt.value=null)},handleCancel:()=>{Ht.value=!1,rt.value&&(rt.value(!1),rt.value=null)}}}const Ss=Os("accounts",()=>{const be=I([]),Ae=I([]),v=I([]),ge=I([]),V=I([]),G=I([]),X=I([]),g=I(!1),w=I(null),q=I(""),j=I("asc"),H=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/claude-accounts");if(b.success)be.value=b.data||[];else throw new Error(b.message||"获取Claude账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},W=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/claude-console-accounts");if(b.success)Ae.value=b.data||[];else throw new Error(b.message||"获取Claude Console账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},B=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/bedrock-accounts");if(b.success)v.value=b.data||[];else throw new Error(b.message||"获取Bedrock账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},ee=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/gemini-accounts");if(b.success)ge.value=b.data||[];else throw new Error(b.message||"获取Gemini账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},se=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/openai-accounts");if(b.success)V.value=b.data||[];else throw new Error(b.message||"获取OpenAI账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},F=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/azure-openai-accounts");if(b.success)G.value=b.data||[];else throw new Error(b.message||"获取Azure OpenAI账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}},d=async()=>{g.value=!0,w.value=null;try{const b=await O.get("/admin/openai-responses-accounts");if(b.success)X.value=b.data||[];else throw new Error(b.message||"获取OpenAI-Responses账户失败")}catch(b){throw w.value=b.message,b}finally{g.value=!1}};return{claudeAccounts:be,claudeConsoleAccounts:Ae,bedrockAccounts:v,geminiAccounts:ge,openaiAccounts:V,azureOpenaiAccounts:G,openaiResponsesAccounts:X,loading:g,error:w,sortBy:q,sortOrder:j,fetchClaudeAccounts:H,fetchClaudeConsoleAccounts:W,fetchBedrockAccounts:B,fetchGeminiAccounts:ee,fetchOpenAIAccounts:se,fetchAzureOpenAIAccounts:F,fetchOpenAIResponsesAccounts:d,fetchAllAccounts:async()=>{g.value=!0,w.value=null;try{await Promise.all([H(),W(),B(),ee(),se(),F(),d()])}catch(b){throw w.value=b.message,b}finally{g.value=!1}},createClaudeAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/claude-accounts",b);if(m.success)return await H(),m.data;throw new Error(m.message||"创建Claude账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createClaudeConsoleAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/claude-console-accounts",b);if(m.success)return await W(),m.data;throw new Error(m.message||"创建Claude Console账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createBedrockAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/bedrock-accounts",b);if(m.success)return await B(),m.data;throw new Error(m.message||"创建Bedrock账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createGeminiAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/gemini-accounts",b);if(m.success)return await ee(),m.data;throw new Error(m.message||"创建Gemini账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createOpenAIAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/openai-accounts",b);if(m.success)return await se(),m.data;throw new Error(m.message||"创建OpenAI账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createAzureOpenAIAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/azure-openai-accounts",b);if(m.success)return await F(),m.data;throw new Error(m.message||"创建Azure OpenAI账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},createOpenAIResponsesAccount:async b=>{g.value=!0,w.value=null;try{const m=await O.post("/admin/openai-responses-accounts",b);if(m.success)return await d(),m.data;throw new Error(m.message||"创建OpenAI-Responses账户失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},updateClaudeAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/claude-accounts/${b}`,m);if(_.success)return await H(),_;throw new Error(_.message||"更新Claude账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateClaudeConsoleAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/claude-console-accounts/${b}`,m);if(_.success)return await W(),_;throw new Error(_.message||"更新Claude Console账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateBedrockAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/bedrock-accounts/${b}`,m);if(_.success)return await B(),_;throw new Error(_.message||"更新Bedrock账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateGeminiAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/gemini-accounts/${b}`,m);if(_.success)return await ee(),_;throw new Error(_.message||"更新Gemini账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateOpenAIAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/openai-accounts/${b}`,m);if(_.success)return await se(),_;throw new Error(_.message||"更新OpenAI账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateAzureOpenAIAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/azure-openai-accounts/${b}`,m);if(_.success)return await F(),_;throw new Error(_.message||"更新Azure OpenAI账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},updateOpenAIResponsesAccount:async(b,m)=>{g.value=!0,w.value=null;try{const _=await O.put(`/admin/openai-responses-accounts/${b}`,m);if(_.success)return await d(),_;throw new Error(_.message||"更新OpenAI-Responses账户失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},toggleAccount:async(b,m)=>{g.value=!0,w.value=null;try{let _;b==="claude"?_=`/admin/claude-accounts/${m}/toggle`:b==="claude-console"?_=`/admin/claude-console-accounts/${m}/toggle`:b==="bedrock"?_=`/admin/bedrock-accounts/${m}/toggle`:b==="gemini"?_=`/admin/gemini-accounts/${m}/toggle`:b==="openai"?_=`/admin/openai-accounts/${m}/toggle`:b==="azure_openai"?_=`/admin/azure-openai-accounts/${m}/toggle`:b==="openai-responses"?_=`/admin/openai-responses-accounts/${m}/toggle`:_=`/admin/openai-accounts/${m}/toggle`;const Ie=await O.put(_);if(Ie.success)return b==="claude"?await H():b==="claude-console"?await W():b==="bedrock"?await B():b==="gemini"?await ee():b==="openai"?await se():b==="azure_openai"?await F():b==="openai-responses"?await d():await se(),Ie;throw new Error(Ie.message||"切换状态失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},deleteAccount:async(b,m)=>{g.value=!0,w.value=null;try{let _;b==="claude"?_=`/admin/claude-accounts/${m}`:b==="claude-console"?_=`/admin/claude-console-accounts/${m}`:b==="bedrock"?_=`/admin/bedrock-accounts/${m}`:b==="gemini"?_=`/admin/gemini-accounts/${m}`:b==="openai"?_=`/admin/openai-accounts/${m}`:b==="azure_openai"?_=`/admin/azure-openai-accounts/${m}`:b==="openai-responses"?_=`/admin/openai-responses-accounts/${m}`:_=`/admin/openai-accounts/${m}`;const Ie=await O.delete(_);if(Ie.success)return b==="claude"?await H():b==="claude-console"?await W():b==="bedrock"?await B():b==="gemini"?await ee():b==="openai"?await se():b==="azure_openai"?await F():b==="openai-responses"?await d():await se(),Ie;throw new Error(Ie.message||"删除失败")}catch(_){throw w.value=_.message,_}finally{g.value=!1}},refreshClaudeToken:async b=>{g.value=!0,w.value=null;try{const m=await O.post(`/admin/claude-accounts/${b}/refresh`);if(m.success)return await H(),m;throw new Error(m.message||"Token刷新失败")}catch(m){throw w.value=m.message,m}finally{g.value=!1}},generateClaudeAuthUrl:async b=>{try{const m=await O.post("/admin/claude-accounts/generate-auth-url",b);if(m.success)return m.data;throw new Error(m.message||"生成授权URL失败")}catch(m){throw w.value=m.message,m}},exchangeClaudeCode:async b=>{try{const m=await O.post("/admin/claude-accounts/exchange-code",b);if(m.success)return m.data;throw new Error(m.message||"交换授权码失败")}catch(m){throw w.value=m.message,m}},generateClaudeSetupTokenUrl:async b=>{try{const m=await O.post("/admin/claude-accounts/generate-setup-token-url",b);if(m.success)return m.data;throw new Error(m.message||"生成Setup Token URL失败")}catch(m){throw w.value=m.message,m}},exchangeClaudeSetupTokenCode:async b=>{try{const m=await O.post("/admin/claude-accounts/exchange-setup-token-code",b);if(m.success)return m.data;throw new Error(m.message||"交换Setup Token授权码失败")}catch(m){throw w.value=m.message,m}},generateGeminiAuthUrl:async b=>{try{const m=await O.post("/admin/gemini-accounts/generate-auth-url",b);if(m.success)return m.data;throw new Error(m.message||"生成授权URL失败")}catch(m){throw w.value=m.message,m}},exchangeGeminiCode:async b=>{try{const m=await O.post("/admin/gemini-accounts/exchange-code",b);if(m.success)return m.data;throw new Error(m.message||"交换授权码失败")}catch(m){throw w.value=m.message,m}},generateOpenAIAuthUrl:async b=>{try{const m=await O.post("/admin/openai-accounts/generate-auth-url",b);if(m.success)return m.data;throw new Error(m.message||"生成授权URL失败")}catch(m){throw w.value=m.message,m}},exchangeOpenAICode:async b=>{try{const m=await O.post("/admin/openai-accounts/exchange-code",b);if(m.success)return m.data;throw new Error(m.message||"交换授权码失败")}catch(m){throw w.value=m.message,m}},sortAccounts:b=>{q.value===b?j.value=j.value==="asc"?"desc":"asc":(q.value=b,j.value="asc")},reset:()=>{be.value=[],Ae.value=[],v.value=[],ge.value=[],V.value=[],G.value=[],X.value=[],g.value=!1,w.value=null,q.value="",j.value="asc"}}}),Es={class:"space-y-4"},qs={class:"flex items-center justify-between"},Ws={class:"flex cursor-pointer items-center"},Gs={key:0,class:"space-y-4 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-600 dark:bg-gray-800"},Bs={class:"relative"},Qs={key:0,class:"mt-1 text-xs text-red-500"},Hs={key:1,class:"mt-1 text-xs text-green-500"},Js={class:"grid grid-cols-2 gap-4"},Ys={class:"space-y-4"},Zs={class:"flex items-center"},Xs={key:0,class:"grid grid-cols-2 gap-4"},ea={class:"relative"},ta=["type"],rs={__name:"ProxyConfig",props:{modelValue:{type:Object,default:()=>({enabled:!1,type:"socks5",host:"",port:"",username:"",password:""})}},emits:["update:modelValue"],setup(be,{emit:Ae}){const v=be,ge=Ae,V=I({...v.modelValue}),G=I(!!(V.value.username||V.value.password)),X=I(!1),g=I(""),w=I(""),q=I(!1);le(()=>v.modelValue,F=>{JSON.stringify(F)!==JSON.stringify(V.value)&&(V.value={...F},G.value=!!(F.username||F.password))},{deep:!0}),le(()=>V.value.enabled,()=>{H()}),le(()=>V.value.type,()=>{H()}),le(()=>V.value.host,()=>{H()}),le(()=>V.value.port,()=>{H()}),le(()=>V.value.username,()=>{H()}),le(()=>V.value.password,()=>{H()}),le(G,F=>{F||(V.value.username="",V.value.password="",H())});let j=null;function H(){j&&clearTimeout(j),j=setTimeout(()=>{const F={...V.value};G.value||(F.username="",F.password=""),ge("update:modelValue",F)},100)}function W(){if(w.value="",q.value=!1,!!g.value)try{const F=g.value.split("#")[0].trim();if(!F)return;const d=/^(socks5|https?):\/\/(?:([^:@]+):([^@]+)@)?([^:]+):(\d+)$/i,f=F.match(d);if(!f){const ze=/^([^:]+):(\d+)$/,Pe=F.match(ze);if(Pe){V.value.type="socks5",V.value.host=Pe[1],V.value.port=Pe[2],V.value.username="",V.value.password="",G.value=!1,q.value=!0,H(),setTimeout(()=>{q.value=!1},3e3);return}w.value="无效的代理URL格式，请检查输入";return}const[,P,K,c,U,E]=f;V.value.type=P.toLowerCase(),V.value.host=U,V.value.port=E,K&&c?(V.value.username=decodeURIComponent(K),V.value.password=decodeURIComponent(c),G.value=!0):(V.value.username="",V.value.password="",G.value=!1),q.value=!0,H(),setTimeout(()=>{q.value=!1},3e3)}catch{w.value="解析失败，请检查URL格式"}}function B(){g.value="",w.value="",q.value=!1}function ee(){setTimeout(()=>{W()},0)}function se(){const F=g.value.trim();F.includes("://")?(/^(socks5|https?):\/\/[^:]+:\d+/i.test(F)||/^(socks5|https?):\/\/[^:@]+:[^@]+@[^:]+:\d+/i.test(F))&&W():/^[^:]+:\d{2,5}$/.test(F)&&W()}return Fs(()=>{j&&clearTimeout(j)}),(F,d)=>(o(),n("div",Es,[e("div",qs,[d[10]||(d[10]=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},"代理设置 (可选)",-1)),e("label",Ws,[y(e("input",{"onUpdate:modelValue":d[0]||(d[0]=f=>V.value.enabled=f),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[$e,V.value.enabled]]),d[9]||(d[9]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"启用代理",-1))])]),V.value.enabled?(o(),n("div",Gs,[d[22]||(d[22]=Rt('<div class="mb-3 flex items-start gap-3"><div class="flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-gray-500"><i class="fas fa-server text-sm text-white"></i></div><div class="flex-1"><p class="text-sm text-gray-700 dark:text-gray-300"> 配置代理以访问受限的网络资源。支持 SOCKS5 和 HTTP 代理。 </p><p class="mt-1 text-xs text-gray-500 dark:text-gray-400"> 请确保代理服务器稳定可用，否则会影响账户的正常使用。 </p></div></div>',1)),e("div",null,[d[14]||(d[14]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},[$(" 快速配置 "),e("span",{class:"ml-1 text-xs font-normal text-gray-500 dark:text-gray-400"}," (粘贴完整代理URL自动填充) ")],-1)),e("div",Bs,[y(e("input",{"onUpdate:modelValue":d[1]||(d[1]=f=>g.value=f),class:"form-input w-full border-gray-300 pr-10 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如: socks5://username:password@host:port 或 http://host:port",type:"text",onInput:se,onKeyup:Ds(W,["enter"]),onPaste:ee},null,544),[[A,g.value]]),g.value?(o(),n("button",{key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400",type:"button",onClick:B},d[11]||(d[11]=[e("i",{class:"fas fa-times"},null,-1)]))):k("",!0)]),w.value?(o(),n("p",Qs,[d[12]||(d[12]=e("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),$(" "+p(w.value),1)])):q.value?(o(),n("p",Hs,d[13]||(d[13]=[e("i",{class:"fas fa-check-circle mr-1"},null,-1),$(" 代理配置已自动填充 ",-1)]))):k("",!0)]),d[23]||(d[23]=e("div",{class:"my-3 border-t border-gray-200 dark:border-gray-600"},null,-1)),e("div",null,[d[16]||(d[16]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"代理类型",-1)),y(e("select",{"onUpdate:modelValue":d[2]||(d[2]=f=>V.value.type=f),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},d[15]||(d[15]=[e("option",{value:"socks5"},"SOCKS5",-1),e("option",{value:"http"},"HTTP",-1),e("option",{value:"https"},"HTTPS",-1)]),512),[[Jt,V.value.type]])]),e("div",Js,[e("div",null,[d[17]||(d[17]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"主机地址",-1)),y(e("input",{"onUpdate:modelValue":d[3]||(d[3]=f=>V.value.host=f),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如: 192.168.1.100",type:"text"},null,512),[[A,V.value.host]])]),e("div",null,[d[18]||(d[18]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"端口",-1)),y(e("input",{"onUpdate:modelValue":d[4]||(d[4]=f=>V.value.port=f),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如: 1080",type:"number"},null,512),[[A,V.value.port]])])]),e("div",Ys,[e("div",Zs,[y(e("input",{id:"proxyAuth","onUpdate:modelValue":d[5]||(d[5]=f=>G.value=f),class:"h-4 w-4 rounded border-gray-300 bg-gray-100 text-blue-600 focus:ring-blue-500",type:"checkbox"},null,512),[[$e,G.value]]),d[19]||(d[19]=e("label",{class:"ml-2 cursor-pointer text-sm text-gray-700 dark:text-gray-300",for:"proxyAuth"}," 需要身份验证 ",-1))]),G.value?(o(),n("div",Xs,[e("div",null,[d[20]||(d[20]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"用户名",-1)),y(e("input",{"onUpdate:modelValue":d[6]||(d[6]=f=>V.value.username=f),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"代理用户名",type:"text"},null,512),[[A,V.value.username]])]),e("div",null,[d[21]||(d[21]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"},"密码",-1)),e("div",ea,[y(e("input",{"onUpdate:modelValue":d[7]||(d[7]=f=>V.value.password=f),class:"form-input w-full border-gray-300 pr-10 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"代理密码",type:X.value?"text":"password"},null,8,ta),[[as,V.value.password]]),e("button",{class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400",type:"button",onClick:d[8]||(d[8]=f=>X.value=!X.value)},[e("i",{class:M(X.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])])):k("",!0)]),d[24]||(d[24]=e("div",{class:"rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-900/30"},[e("p",{class:"text-xs text-blue-700 dark:text-blue-300"},[e("i",{class:"fas fa-info-circle mr-1"}),e("strong",null,"提示："),$("代理设置将用于所有与此账户相关的API请求。请确保代理服务器支持HTTPS流量转发。 ")])],-1))])):k("",!0)]))}},sa={class:"space-y-6"},aa={key:0},ra={class:"rounded-lg border border-blue-200 bg-blue-50 p-6 dark:border-blue-700 dark:bg-blue-900/30"},la={class:"flex items-start gap-4"},oa={class:"flex-1"},na={class:"space-y-4"},ia={class:"rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"},da={class:"flex items-start gap-3"},ua={class:"flex-1"},pa=["disabled"],ga={key:0,class:"fas fa-link mr-2"},ma={key:1,class:"loading-spinner mr-2"},ya={key:1,class:"space-y-3"},xa={class:"flex items-center gap-2"},fa=["value"],ba={class:"rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"},ca={class:"flex items-start gap-3"},va={class:"flex-1"},ka={class:"space-y-3"},ha={key:1},wa={class:"rounded-lg border border-green-200 bg-green-50 p-6 dark:border-green-700 dark:bg-green-900/30"},$a={class:"flex items-start gap-4"},Aa={class:"flex-1"},Ca={class:"space-y-4"},Ua={class:"rounded-lg border border-green-300 bg-white/80 p-4 dark:border-green-600 dark:bg-gray-800/80"},Ta={class:"flex items-start gap-3"},Ia={class:"flex-1"},_a=["disabled"],Va={key:0,class:"fas fa-link mr-2"},Sa={key:1,class:"loading-spinner mr-2"},Ma={key:1,class:"space-y-3"},Ra={class:"flex items-center gap-2"},Ka=["value"],za={class:"rounded-lg border border-green-300 bg-white/80 p-4 dark:border-green-600 dark:bg-gray-800/80"},Pa={class:"flex items-start gap-3"},La={class:"flex-1"},ja={class:"space-y-3"},Oa={key:2},Fa={class:"rounded-lg border border-orange-200 bg-orange-50 p-6 dark:border-orange-700 dark:bg-orange-900/30"},Da={class:"flex items-start gap-4"},Na={class:"flex-1"},Ea={class:"space-y-4"},qa={class:"rounded-lg border border-orange-300 bg-white/80 p-4 dark:border-orange-600 dark:bg-gray-800/80"},Wa={class:"flex items-start gap-3"},Ga={class:"flex-1"},Ba=["disabled"],Qa={key:0,class:"fas fa-link mr-2"},Ha={key:1,class:"loading-spinner mr-2"},Ja={key:1,class:"space-y-3"},Ya={class:"flex items-center gap-2"},Za=["value"],Xa={class:"rounded-lg border border-orange-300 bg-white/80 p-4 dark:border-orange-600 dark:bg-gray-800/80"},er={class:"flex items-start gap-3"},tr={class:"flex-1"},sr={class:"space-y-3"},ar={class:"flex gap-3 pt-4"},rr=["disabled"],lr={key:0,class:"loading-spinner mr-2"},or={__name:"OAuthFlow",props:{platform:{type:String,required:!0},proxy:{type:Object,default:null}},emits:["success","back"],setup(be,{emit:Ae}){const v=be,ge=Ae,V=Ss(),G=I(!1),X=I(!1),g=I(""),w=I(""),q=I(!1),j=I(""),H=Ge(()=>g.value&&w.value.trim());le(w,F=>{if(!F||typeof F!="string")return;const d=F.trim();if(!d)return;if(d.startsWith("http://")||d.startsWith("https://"))if(d.startsWith("http://localhost:45462")||d.startsWith("http://localhost:1455"))try{const K=new URL(d).searchParams.get("code");K?(w.value=K,R("成功提取授权码！","success"),console.log("Successfully extracted authorization code from URL")):R("URL 中未找到授权码参数，请检查链接是否正确","error")}catch(P){console.error("Failed to parse URL:",P),R("链接格式错误，请检查是否为完整的 URL","error")}else if(v.platform==="gemini"||v.platform==="openai")try{const K=new URL(d).searchParams.get("code");K&&(w.value=K,R("成功提取授权码！","success"))}catch{}else R("请粘贴以 http://localhost:1455 或 http://localhost:45462 开头的链接","error")});const W=async()=>{var F;G.value=!0;try{const d=(F=v.proxy)!=null&&F.enabled?{proxy:{type:v.proxy.type,host:v.proxy.host,port:parseInt(v.proxy.port),username:v.proxy.username||null,password:v.proxy.password||null}}:{};if(v.platform==="claude"){const f=await V.generateClaudeAuthUrl(d);g.value=f.authUrl,j.value=f.sessionId}else if(v.platform==="gemini"){const f=await V.generateGeminiAuthUrl(d);g.value=f.authUrl,j.value=f.sessionId}else if(v.platform==="openai"){const f=await V.generateOpenAIAuthUrl(d);g.value=f.authUrl,j.value=f.sessionId}}catch(d){R(d.message||"生成授权链接失败","error")}finally{G.value=!1}},B=()=>{g.value="",w.value="",W()},ee=async()=>{try{await navigator.clipboard.writeText(g.value),q.value=!0,R("链接已复制","success"),setTimeout(()=>{q.value=!1},2e3)}catch{const d=document.createElement("input");d.value=g.value,document.body.appendChild(d),d.select(),document.execCommand("copy"),document.body.removeChild(d),q.value=!0,R("链接已复制","success"),setTimeout(()=>{q.value=!1},2e3)}},se=async()=>{var F;if(H.value){X.value=!0;try{let d={};v.platform==="claude"?d={sessionId:j.value,callbackUrl:w.value.trim()}:v.platform==="gemini"?d={code:w.value.trim(),sessionId:j.value}:v.platform==="openai"&&(d={code:w.value.trim(),sessionId:j.value}),(F=v.proxy)!=null&&F.enabled&&(d.proxy={type:v.proxy.type,host:v.proxy.host,port:parseInt(v.proxy.port),username:v.proxy.username||null,password:v.proxy.password||null});let f;v.platform==="claude"?f=await V.exchangeClaudeCode(d):v.platform==="gemini"?f=await V.exchangeGeminiCode(d):v.platform==="openai"&&(f=await V.exchangeOpenAICode(d)),ge("success",f)}catch(d){R(d.message||"授权失败，请检查授权码是否正确","error")}finally{X.value=!1}}};return(F,d)=>(o(),n("div",sa,[be.platform==="claude"?(o(),n("div",aa,[e("div",ra,[e("div",la,[d[15]||(d[15]=e("div",{class:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-blue-500"},[e("i",{class:"fas fa-link text-white"})],-1)),e("div",oa,[d[13]||(d[13]=e("h4",{class:"mb-3 font-semibold text-blue-900 dark:text-blue-200"},"Claude 账户授权",-1)),d[14]||(d[14]=e("p",{class:"mb-4 text-sm text-blue-800 dark:text-blue-300"}," 请按照以下步骤完成 Claude 账户的授权： ",-1)),e("div",na,[e("div",ia,[e("div",da,[d[6]||(d[6]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"}," 1 ",-1)),e("div",ua,[d[5]||(d[5]=e("p",{class:"mb-2 font-medium text-blue-900 dark:text-blue-200"}," 点击下方按钮生成授权链接 ",-1)),g.value?(o(),n("div",ya,[e("div",xa,[e("input",{class:"form-input flex-1 bg-gray-50 font-mono text-xs dark:bg-gray-700",readonly:"",type:"text",value:g.value},null,8,fa),e("button",{class:"rounded-lg bg-gray-100 px-3 py-2 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"复制链接",onClick:ee},[e("i",{class:M(q.value?"fas fa-check text-green-500":"fas fa-copy")},null,2)])]),e("button",{class:"text-xs text-blue-600 hover:text-blue-700",onClick:B},d[4]||(d[4]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$("重新生成 ",-1)]))])):(o(),n("button",{key:0,class:"btn btn-primary px-4 py-2 text-sm",disabled:G.value,onClick:W},[G.value?(o(),n("div",ma)):(o(),n("i",ga)),$(" "+p(G.value?"生成中...":"生成授权链接"),1)],8,pa))])])]),d[12]||(d[12]=Rt('<div class="rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"><div class="flex items-start gap-3"><div class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"> 2 </div><div class="flex-1"><p class="mb-2 font-medium text-blue-900 dark:text-blue-200"> 在浏览器中打开链接并完成授权 </p><p class="mb-2 text-sm text-blue-700 dark:text-blue-300"> 请在新标签页中打开授权链接，登录您的 Claude 账户并授权。 </p><div class="rounded border border-yellow-300 bg-yellow-50 p-3 dark:border-yellow-700 dark:bg-yellow-900/30"><p class="text-xs text-yellow-800 dark:text-yellow-300"><i class="fas fa-exclamation-triangle mr-1"></i><strong>注意：</strong>如果您设置了代理，请确保浏览器也使用相同的代理访问授权页面。 </p></div></div></div></div>',1)),e("div",ba,[e("div",ca,[d[11]||(d[11]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"}," 3 ",-1)),e("div",va,[d[9]||(d[9]=e("p",{class:"mb-2 font-medium text-blue-900 dark:text-blue-200"}," 输入 Authorization Code ",-1)),d[10]||(d[10]=e("p",{class:"mb-3 text-sm text-blue-700 dark:text-blue-300"},[$(" 授权完成后，页面会显示一个 "),e("strong",null,"Authorization Code"),$("，请将其复制并粘贴到下方输入框： ")],-1)),e("div",ka,[e("div",null,[d[7]||(d[7]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2 text-blue-500"}),$("Authorization Code ")],-1)),y(e("textarea",{"onUpdate:modelValue":d[0]||(d[0]=f=>w.value=f),class:"form-input w-full resize-none font-mono text-sm",placeholder:"粘贴从Claude页面获取的Authorization Code...",rows:"3"},null,512),[[A,w.value]])]),d[8]||(d[8]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 请粘贴从Claude页面复制的Authorization Code ")],-1))])])])])])])])])])):be.platform==="gemini"?(o(),n("div",ha,[e("div",wa,[e("div",$a,[d[27]||(d[27]=e("div",{class:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-green-500"},[e("i",{class:"fas fa-robot text-white"})],-1)),e("div",Aa,[d[25]||(d[25]=e("h4",{class:"mb-3 font-semibold text-green-900 dark:text-green-200"},"Gemini 账户授权",-1)),d[26]||(d[26]=e("p",{class:"mb-4 text-sm text-green-800 dark:text-green-300"}," 请按照以下步骤完成 Gemini 账户的授权： ",-1)),e("div",Ca,[e("div",Ua,[e("div",Ta,[d[18]||(d[18]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-green-600 text-xs font-bold text-white"}," 1 ",-1)),e("div",Ia,[d[17]||(d[17]=e("p",{class:"mb-2 font-medium text-green-900 dark:text-green-200"}," 点击下方按钮生成授权链接 ",-1)),g.value?(o(),n("div",Ma,[e("div",Ra,[e("input",{class:"form-input flex-1 bg-gray-50 font-mono text-xs dark:bg-gray-700",readonly:"",type:"text",value:g.value},null,8,Ka),e("button",{class:"rounded-lg bg-gray-100 px-3 py-2 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"复制链接",onClick:ee},[e("i",{class:M(q.value?"fas fa-check text-green-500":"fas fa-copy")},null,2)])]),e("button",{class:"text-xs text-green-600 hover:text-green-700",onClick:B},d[16]||(d[16]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$("重新生成 ",-1)]))])):(o(),n("button",{key:0,class:"btn btn-primary px-4 py-2 text-sm",disabled:G.value,onClick:W},[G.value?(o(),n("div",Sa)):(o(),n("i",Va)),$(" "+p(G.value?"生成中...":"生成授权链接"),1)],8,_a))])])]),d[24]||(d[24]=Rt('<div class="rounded-lg border border-green-300 bg-white/80 p-4 dark:border-green-600 dark:bg-gray-800/80"><div class="flex items-start gap-3"><div class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-green-600 text-xs font-bold text-white"> 2 </div><div class="flex-1"><p class="mb-2 font-medium text-green-900 dark:text-green-200"> 在浏览器中打开链接并完成授权 </p><p class="mb-2 text-sm text-green-700 dark:text-green-300"> 请在新标签页中打开授权链接，登录您的 Gemini 账户并授权。 </p><div class="rounded border border-yellow-300 bg-yellow-50 p-3 dark:border-yellow-700 dark:bg-yellow-900/30"><p class="text-xs text-yellow-800 dark:text-yellow-300"><i class="fas fa-exclamation-triangle mr-1"></i><strong>注意：</strong>如果您设置了代理，请确保浏览器也使用相同的代理访问授权页面。 </p></div></div></div></div>',1)),e("div",za,[e("div",Pa,[d[23]||(d[23]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-green-600 text-xs font-bold text-white"}," 3 ",-1)),e("div",La,[d[21]||(d[21]=e("p",{class:"mb-2 font-medium text-green-900 dark:text-green-200"}," 输入 Authorization Code ",-1)),d[22]||(d[22]=e("p",{class:"mb-3 text-sm text-green-700 dark:text-green-300"}," 授权完成后，页面会显示一个 Authorization Code，请将其复制并粘贴到下方输入框： ",-1)),e("div",ja,[e("div",null,[d[19]||(d[19]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2 text-green-500"}),$("Authorization Code ")],-1)),y(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=f=>w.value=f),class:"form-input w-full resize-none font-mono text-sm",placeholder:"粘贴从Gemini页面获取的Authorization Code...",rows:"3"},null,512),[[A,w.value]])]),d[20]||(d[20]=e("div",{class:"mt-2 space-y-1"},[e("p",{class:"text-xs text-gray-600 dark:text-gray-400"},[e("i",{class:"fas fa-check-circle mr-1 text-green-500"}),$(" 请粘贴从Gemini页面复制的Authorization Code ")])],-1))])])])])])])])])])):be.platform==="openai"?(o(),n("div",Oa,[e("div",Fa,[e("div",Da,[d[39]||(d[39]=e("div",{class:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-orange-500"},[e("i",{class:"fas fa-brain text-white"})],-1)),e("div",Na,[d[37]||(d[37]=e("h4",{class:"mb-3 font-semibold text-orange-900 dark:text-orange-200"},"OpenAI 账户授权",-1)),d[38]||(d[38]=e("p",{class:"mb-4 text-sm text-orange-800 dark:text-orange-300"}," 请按照以下步骤完成 OpenAI 账户的授权： ",-1)),e("div",Ea,[e("div",qa,[e("div",Wa,[d[30]||(d[30]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-orange-600 text-xs font-bold text-white"}," 1 ",-1)),e("div",Ga,[d[29]||(d[29]=e("p",{class:"mb-2 font-medium text-orange-900 dark:text-orange-200"}," 点击下方按钮生成授权链接 ",-1)),g.value?(o(),n("div",Ja,[e("div",Ya,[e("input",{class:"form-input flex-1 bg-gray-50 font-mono text-xs dark:bg-gray-700",readonly:"",type:"text",value:g.value},null,8,Za),e("button",{class:"rounded-lg bg-gray-100 px-3 py-2 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"复制链接",onClick:ee},[e("i",{class:M(q.value?"fas fa-check text-green-500":"fas fa-copy")},null,2)])]),e("button",{class:"text-xs text-orange-600 hover:text-orange-700",onClick:B},d[28]||(d[28]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$("重新生成 ",-1)]))])):(o(),n("button",{key:0,class:"btn btn-primary px-4 py-2 text-sm",disabled:G.value,onClick:W},[G.value?(o(),n("div",Ha)):(o(),n("i",Qa)),$(" "+p(G.value?"生成中...":"生成授权链接"),1)],8,Ba))])])]),d[36]||(d[36]=Rt('<div class="rounded-lg border border-orange-300 bg-white/80 p-4 dark:border-orange-600 dark:bg-gray-800/80"><div class="flex items-start gap-3"><div class="flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-orange-600 text-xs font-bold text-white"> 2 </div><div class="flex-1"><p class="mb-2 font-medium text-orange-900 dark:text-orange-200"> 在浏览器中打开链接并完成授权 </p><p class="mb-2 text-sm text-orange-700 dark:text-orange-300"> 请在新标签页中打开授权链接，登录您的 OpenAI 账户并授权。 </p><div class="mb-3 rounded border border-amber-300 bg-amber-50 p-3 dark:border-amber-700 dark:bg-amber-900/30"><p class="text-xs text-amber-800 dark:text-amber-300"><i class="fas fa-clock mr-1"></i><strong>重要提示：</strong>授权后页面可能会加载较长时间，请耐心等待。 </p><p class="mt-2 text-xs text-amber-700 dark:text-amber-400"> 当浏览器地址栏变为 <strong class="font-mono">http://localhost:1455/...</strong> 开头时，表示授权已完成。 </p></div><div class="rounded border border-yellow-300 bg-yellow-50 p-3 dark:border-yellow-700 dark:bg-yellow-900/30"><p class="text-xs text-yellow-800 dark:text-yellow-300"><i class="fas fa-exclamation-triangle mr-1"></i><strong>注意：</strong>如果您设置了代理，请确保浏览器也使用相同的代理访问授权页面。 </p></div></div></div></div>',1)),e("div",Xa,[e("div",er,[d[35]||(d[35]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-orange-600 text-xs font-bold text-white"}," 3 ",-1)),e("div",tr,[d[33]||(d[33]=e("p",{class:"mb-2 font-medium text-orange-900 dark:text-orange-200"}," 输入授权链接或 Code ",-1)),d[34]||(d[34]=e("p",{class:"mb-3 text-sm text-orange-700 dark:text-orange-300"},[$(" 授权完成后，当页面地址变为 "),e("strong",{class:"font-mono"},"http://localhost:1455/..."),$(" 时： ")],-1)),e("div",sr,[e("div",null,[d[31]||(d[31]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-link mr-2 text-orange-500"}),$("授权链接或 Code ")],-1)),y(e("textarea",{"onUpdate:modelValue":d[2]||(d[2]=f=>w.value=f),class:"form-input w-full resize-none font-mono text-sm",placeholder:`方式1：复制完整的链接（http://localhost:1455/auth/callback?code=...）
方式2：仅复制 code 参数的值
系统会自动识别并提取所需信息`,rows:"3"},null,512),[[A,w.value]])]),d[32]||(d[32]=Rt('<div class="rounded border border-blue-300 bg-blue-50 p-2 dark:border-blue-700 dark:bg-blue-900/30"><p class="text-xs text-blue-700 dark:text-blue-300"><i class="fas fa-lightbulb mr-1"></i><strong>提示：</strong>您可以直接复制整个链接或仅复制 code 参数值，系统会自动识别。 </p><p class="mt-1 text-xs text-blue-600 dark:text-blue-400"> • 完整链接示例：<span class="font-mono">http://localhost:1455/auth/callback?code=ac_4hm8...</span></p><p class="text-xs text-blue-600"> • 仅 Code 示例：<span class="font-mono">ac_4hm8iqmx9A2fzMy_cwye7U3W7...</span></p></div>',1))])])])])])])])])])):k("",!0),e("div",ar,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:d[3]||(d[3]=f=>F.$emit("back"))}," 上一步 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:!H.value||X.value,type:"button",onClick:se},[X.value?(o(),n("div",lr)):k("",!0),$(" "+p(X.value?"验证中...":"完成授权"),1)],8,rr)])]))}},nr={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},ir={class:"modal-content custom-scrollbar mx-auto max-h-[90vh] w-full max-w-4xl overflow-y-auto p-4 sm:p-6 md:p-8"},dr={class:"mb-4 flex items-center justify-between sm:mb-6"},ur={class:"mb-6"},pr={key:0,class:"mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4"},gr={class:"space-y-4"},mr={class:"flex gap-4"},yr={class:"flex cursor-pointer items-center"},xr={class:"flex cursor-pointer items-center"},fr={class:"flex cursor-pointer items-center"},br={class:"flex gap-3"},cr=["disabled"],vr={key:0,class:"loading-spinner mr-2"},kr={class:"space-y-4"},hr={key:0,class:"py-8 text-center"},wr={key:1,class:"rounded-lg bg-gray-50 py-8 text-center"},$r={key:2,class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ar={class:"mb-3 flex items-start justify-between"},Cr={class:"flex-1"},Ur={class:"font-semibold text-gray-900"},Tr={class:"mt-1 text-sm text-gray-500"},Ir={class:"ml-4 flex items-center gap-2"},_r={class:"flex items-center justify-between text-sm text-gray-600"},Vr={class:"flex items-center gap-4"},Sr={class:"flex items-center gap-2"},Mr=["onClick"],Rr=["disabled","onClick"],Kr={key:1,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},zr={class:"modal-content w-full max-w-lg p-4 sm:p-6"},Pr={class:"space-y-4"},Lr={class:"rounded-lg bg-gray-100 px-3 py-2 text-sm text-gray-600"},jr={class:"flex gap-3 pt-4"},Or=["disabled"],Fr={key:0,class:"loading-spinner mr-2"},Dr={__name:"GroupManagementModal",emits:["close","refresh"],setup(be,{emit:Ae}){const v=Ae,ge=I(!0),V=I(!1),G=I([]),X=I(!1),g=I(!1),w=I({name:"",platform:"claude",description:""}),q=I(!1),j=I(!1),H=I(null),W=I({name:"",platform:"",description:""}),B=c=>c?new Date(c).toLocaleDateString("zh-CN"):"-",ee=async()=>{V.value=!0;try{const c=await O.get("/admin/account-groups");G.value=c.data||[]}catch{R("加载分组列表失败","error")}finally{V.value=!1}},se=async()=>{var c,U;if(!w.value.name||!w.value.platform){R("请填写必填项","error");return}g.value=!0;try{await O.post("/admin/account-groups",{name:w.value.name,platform:w.value.platform,description:w.value.description}),R("分组创建成功","success"),F(),await ee(),v("refresh")}catch(E){R(((U=(c=E.response)==null?void 0:c.data)==null?void 0:U.error)||"创建分组失败","error")}finally{g.value=!1}},F=()=>{X.value=!1,w.value={name:"",platform:"claude",description:""}},d=c=>{H.value=c,W.value={name:c.name,platform:c.platform,description:c.description||""},q.value=!0},f=async()=>{var c,U;if(!W.value.name){R("请填写分组名称","error");return}j.value=!0;try{await O.put(`/admin/account-groups/${H.value.id}`,{name:W.value.name,description:W.value.description}),R("分组更新成功","success"),P(),await ee(),v("refresh")}catch(E){R(((U=(c=E.response)==null?void 0:c.data)==null?void 0:U.error)||"更新分组失败","error")}finally{j.value=!1}},P=()=>{q.value=!1,H.value=null,W.value={name:"",platform:"",description:""}},K=async c=>{var U,E;if(c.memberCount>0){R("分组内还有成员，无法删除","error");return}if(confirm(`确定要删除分组 "${c.name}" 吗？`))try{await O.delete(`/admin/account-groups/${c.id}`),R("分组删除成功","success"),await ee(),v("refresh")}catch(ze){R(((E=(U=ze.response)==null?void 0:U.data)==null?void 0:E.error)||"删除分组失败","error")}};return Yt(()=>{ee()}),(c,U)=>(o(),Ne(ls,{to:"body"},[ge.value?(o(),n("div",nr,[e("div",ir,[e("div",dr,[U[10]||(U[10]=e("div",{class:"flex items-center gap-2 sm:gap-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-purple-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-layer-group text-sm text-white sm:text-base"})]),e("h3",{class:"text-lg font-bold text-gray-900 sm:text-xl"},"账户分组管理")],-1)),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600",onClick:U[0]||(U[0]=E=>c.$emit("close"))},U[9]||(U[9]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)]))]),e("div",ur,[e("button",{class:"btn btn-primary px-4 py-2",onClick:U[1]||(U[1]=E=>X.value=!0)},U[11]||(U[11]=[e("i",{class:"fas fa-plus mr-2"},null,-1),$(" 创建新分组 ",-1)]))]),X.value?(o(),n("div",pr,[U[18]||(U[18]=e("h4",{class:"mb-4 text-lg font-semibold text-gray-900"},"创建新分组",-1)),e("div",gr,[e("div",null,[U[12]||(U[12]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"分组名称 *",-1)),y(e("input",{"onUpdate:modelValue":U[2]||(U[2]=E=>w.value.name=E),class:"form-input w-full",placeholder:"输入分组名称",type:"text"},null,512),[[A,w.value.name]])]),e("div",null,[U[16]||(U[16]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"平台类型 *",-1)),e("div",mr,[e("label",yr,[y(e("input",{"onUpdate:modelValue":U[3]||(U[3]=E=>w.value.platform=E),class:"mr-2",type:"radio",value:"claude"},null,512),[[oe,w.value.platform]]),U[13]||(U[13]=e("span",{class:"text-sm text-gray-700"},"Claude",-1))]),e("label",xr,[y(e("input",{"onUpdate:modelValue":U[4]||(U[4]=E=>w.value.platform=E),class:"mr-2",type:"radio",value:"gemini"},null,512),[[oe,w.value.platform]]),U[14]||(U[14]=e("span",{class:"text-sm text-gray-700"},"Gemini",-1))]),e("label",fr,[y(e("input",{"onUpdate:modelValue":U[5]||(U[5]=E=>w.value.platform=E),class:"mr-2",type:"radio",value:"openai"},null,512),[[oe,w.value.platform]]),U[15]||(U[15]=e("span",{class:"text-sm text-gray-700"},"OpenAI",-1))])])]),e("div",null,[U[17]||(U[17]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"描述 (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":U[6]||(U[6]=E=>w.value.description=E),class:"form-input w-full resize-none",placeholder:"分组描述...",rows:"2"},null,512),[[A,w.value.description]])]),e("div",br,[e("button",{class:"btn btn-primary px-4 py-2",disabled:!w.value.name||!w.value.platform||g.value,onClick:se},[g.value?(o(),n("div",vr)):k("",!0),$(" "+p(g.value?"创建中...":"创建"),1)],8,cr),e("button",{class:"btn btn-secondary px-4 py-2",onClick:F},"取消")])])])):k("",!0),e("div",kr,[V.value?(o(),n("div",hr,U[19]||(U[19]=[e("div",{class:"loading-spinner-lg mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500"},"加载中...",-1)]))):G.value.length===0?(o(),n("div",wr,U[20]||(U[20]=[e("i",{class:"fas fa-layer-group mb-4 text-4xl text-gray-300"},null,-1),e("p",{class:"text-gray-500"},"暂无分组",-1)]))):(o(),n("div",$r,[(o(!0),n(ae,null,ue(G.value,E=>(o(),n("div",{key:E.id,class:"rounded-lg border bg-white p-4 transition-shadow hover:shadow-md"},[e("div",Ar,[e("div",Cr,[e("h4",Ur,p(E.name),1),e("p",Tr,p(E.description||"暂无描述"),1)]),e("div",Ir,[e("span",{class:M(["rounded-full px-2 py-1 text-xs font-medium",E.platform==="claude"?"bg-purple-100 text-purple-700":E.platform==="gemini"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"])},p(E.platform==="claude"?"Claude":E.platform==="gemini"?"Gemini":"OpenAI"),3)])]),e("div",_r,[e("div",Vr,[e("span",null,[U[21]||(U[21]=e("i",{class:"fas fa-users mr-1"},null,-1)),$(" "+p(E.memberCount||0)+" 个成员 ",1)]),e("span",null,[U[22]||(U[22]=e("i",{class:"fas fa-clock mr-1"},null,-1)),$(" "+p(B(E.createdAt)),1)])]),e("div",Sr,[e("button",{class:"text-blue-600 transition-colors hover:text-blue-800",title:"编辑",onClick:ze=>d(E)},U[23]||(U[23]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Mr),e("button",{class:"text-red-600 transition-colors hover:text-red-800",disabled:E.memberCount>0,title:"删除",onClick:ze=>K(E)},U[24]||(U[24]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Rr)])])]))),128))]))])])])):k("",!0),q.value?(o(),n("div",Kr,[e("div",zr,[e("div",{class:"mb-4 flex items-center justify-between"},[U[26]||(U[26]=e("h3",{class:"text-lg font-bold text-gray-900"},"编辑分组",-1)),e("button",{class:"text-gray-400 transition-colors hover:text-gray-600",onClick:P},U[25]||(U[25]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",Pr,[e("div",null,[U[27]||(U[27]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"分组名称 *",-1)),y(e("input",{"onUpdate:modelValue":U[7]||(U[7]=E=>W.value.name=E),class:"form-input w-full",placeholder:"输入分组名称",type:"text"},null,512),[[A,W.value.name]])]),e("div",null,[U[29]||(U[29]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"平台类型",-1)),e("div",Lr,[$(p(W.value.platform==="claude"?"Claude":W.value.platform==="gemini"?"Gemini":"OpenAI")+" ",1),U[28]||(U[28]=e("span",{class:"ml-2 text-xs text-gray-500"},"(不可修改)",-1))])]),e("div",null,[U[30]||(U[30]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700"},"描述 (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":U[8]||(U[8]=E=>W.value.description=E),class:"form-input w-full resize-none",placeholder:"分组描述...",rows:"2"},null,512),[[A,W.value.description]])]),e("div",jr,[e("button",{class:"btn btn-primary flex-1 px-4 py-2",disabled:!W.value.name||j.value,onClick:f},[j.value?(o(),n("div",Fr)):k("",!0),$(" "+p(j.value?"更新中...":"更新"),1)],8,Or),e("button",{class:"btn btn-secondary flex-1 px-4 py-2",onClick:P},"取消")])])])])):k("",!0)]))}},Nr={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},Er={class:"modal-content custom-scrollbar mx-auto max-h-[90vh] w-full max-w-2xl overflow-y-auto p-4 sm:p-6 md:p-8"},qr={class:"mb-4 flex items-center justify-between sm:mb-6"},Wr={class:"flex items-center gap-2 sm:gap-3"},Gr={class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"},Br={key:0,class:"mb-4 flex items-center justify-center sm:mb-8"},Qr={class:"flex items-center space-x-2 sm:space-x-4"},Hr={class:"flex items-center"},Jr={class:"flex items-center"},Yr={key:1},Zr={class:"space-y-6"},Xr={key:0},el={class:"space-y-3"},tl={class:"grid grid-cols-3 gap-2"},sl={class:"p-3"},al={class:"flex items-center justify-between"},rl={key:0,class:"flex h-5 w-5 items-center justify-center rounded-full bg-indigo-500"},ll={class:"p-3"},ol={class:"flex items-center justify-between"},nl={key:0,class:"flex h-5 w-5 items-center justify-center rounded-full bg-emerald-500"},il={class:"p-3"},dl={class:"flex items-center justify-between"},ul={key:0,class:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-500"},pl={key:0,class:"animate-fadeIn rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},gl={class:"grid grid-cols-2 gap-2 sm:grid-cols-3"},ml={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-indigo-500"},yl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-purple-500"},xl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-orange-500"},fl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-cyan-500"},bl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-emerald-500"},cl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-teal-500"},vl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-blue-500"},kl={key:0,class:"absolute right-1 top-1 flex h-4 w-4 items-center justify-center rounded-full bg-blue-500"},hl={key:1},wl={class:"flex flex-wrap gap-4"},$l={key:0,class:"flex cursor-pointer items-center"},Al={class:"flex cursor-pointer items-center"},Cl={class:"flex cursor-pointer items-center"},Ul={key:0,class:"mt-1 text-xs text-red-500"},Tl={class:"flex gap-4"},Il={class:"flex cursor-pointer items-center"},_l={class:"flex cursor-pointer items-center"},Vl={class:"flex cursor-pointer items-center"},Sl={key:2},Ml={class:"flex gap-2"},Rl={class:"flex-1"},Kl={class:"max-h-48 space-y-2 overflow-y-auto rounded-md border p-3 dark:border-gray-600 dark:bg-gray-700"},zl={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Pl=["value"],Ll={class:"text-sm text-gray-700 dark:text-gray-200"},jl={key:3},Ol={key:4,class:"space-y-4"},Fl={key:0,class:"mt-1 text-xs text-red-500"},Dl={key:0,class:"mt-1 text-xs text-red-500"},Nl={key:0,class:"mt-1 text-xs text-red-500"},El={key:5,class:"space-y-4"},ql={key:0,class:"mt-1 text-xs text-red-500"},Wl={key:0,class:"mt-1 text-xs text-red-500"},Gl={key:0,class:"mt-1 text-xs text-red-500"},Bl={class:"flex flex-wrap gap-2"},Ql=["value"],Hl={class:"text-sm text-gray-700 dark:text-gray-300"},Jl={key:6},Yl={class:"mb-3"},Zl={class:"inline-flex cursor-pointer items-center"},Xl={key:0},eo={key:7,class:"space-y-4"},to={key:0,class:"mt-1 text-xs text-red-500"},so={key:0,class:"mt-1 text-xs text-red-500"},ao={class:"grid grid-cols-2 gap-4"},ro={class:"mb-3 space-y-2"},lo=["onUpdate:modelValue"],oo=["onUpdate:modelValue"],no=["onClick"],io={class:"mt-3 flex flex-wrap gap-2"},uo={class:"mb-3"},po={class:"inline-flex cursor-pointer items-center"},go={key:0},mo={key:8,class:"space-y-4"},yo={class:"relative"},xo=["type"],fo={key:9},bo={class:"flex gap-4"},co={class:"flex cursor-pointer items-center"},vo={class:"flex cursor-pointer items-center"},ko={key:10,class:"mt-4"},ho={class:"flex items-start"},wo={key:11,class:"mt-4"},$o={class:"flex items-start"},Ao={class:"ml-3"},Co={key:0,class:"mt-1"},Uo={class:"flex items-center justify-between"},To={class:"text-xs text-green-600 dark:text-green-400"},Io=["disabled"],_o={key:0,class:"fas fa-trash-alt mr-1"},Vo={key:1,class:"loading-spinner mr-1"},So={key:1,class:"mt-1"},Mo={key:12,class:"mt-4"},Ro={class:"flex items-start"},Ko={class:"ml-3 flex-1"},zo={key:0,class:"mt-3"},Po={class:"rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},Lo={class:"flex items-center gap-2"},jo={class:"block w-full select-all break-all rounded bg-gray-100 px-3 py-2 font-mono text-xs text-gray-700 dark:bg-gray-900 dark:text-gray-300"},Oo={class:"text-blue-600 dark:text-blue-400"},Fo={class:"text-gray-500 dark:text-gray-500"},Do={class:"text-blue-600 dark:text-blue-400"},No={key:13,class:"space-y-4 rounded-lg border border-blue-200 bg-blue-50 p-4"},Eo={class:"mb-4 flex items-start gap-3"},qo={key:0,class:"mb-2 text-sm text-blue-800 dark:text-blue-300"},Wo={key:1,class:"mb-2 text-sm text-blue-800 dark:text-blue-300"},Go={key:2,class:"mb-2 text-sm text-blue-800 dark:text-blue-300"},Bo={class:"mb-2 mt-2 rounded-lg border border-blue-300 bg-white/80 p-3 dark:border-blue-600 dark:bg-gray-800/80"},Qo={key:0,class:"text-xs text-blue-800 dark:text-blue-300"},Ho={key:1,class:"text-xs text-blue-800 dark:text-blue-300"},Jo={key:2,class:"text-xs text-blue-800 dark:text-blue-300"},Yo={key:0},Zo={key:1},Xo={key:0,class:"mt-1 text-xs text-red-500"},en={key:2},tn={key:0,class:"mt-1 text-xs text-red-500"},sn={key:3},an={class:"flex gap-3 pt-4"},rn=["disabled"],ln=["disabled"],on={key:0,class:"loading-spinner mr-2"},nn={key:3,class:"space-y-6"},dn={key:0},un={class:"rounded-lg border border-blue-200 bg-blue-50 p-6 dark:border-blue-700 dark:bg-blue-900/30"},pn={class:"flex items-start gap-4"},gn={class:"flex-1"},mn={class:"space-y-4"},yn={class:"rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"},xn={class:"flex items-start gap-3"},fn={class:"flex-1"},bn=["disabled"],cn={key:0,class:"fas fa-link mr-2"},vn={key:1,class:"loading-spinner mr-2"},kn={key:1,class:"space-y-3"},hn={class:"flex items-center gap-2"},wn=["value"],$n={class:"rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"},An={class:"flex items-start gap-3"},Cn={class:"flex-1"},Un={class:"space-y-3"},Tn={class:"flex gap-3 pt-4"},In=["disabled"],_n={key:0,class:"loading-spinner mr-2"},Vn={key:4,class:"space-y-6"},Sn={class:"flex gap-4"},Mn={class:"flex cursor-pointer items-center"},Rn={class:"flex cursor-pointer items-center"},Kn={class:"flex cursor-pointer items-center"},zn={key:0},Pn={class:"flex gap-2"},Ln={class:"flex-1"},jn={class:"max-h-48 space-y-2 overflow-y-auto rounded-md border p-3 dark:border-gray-600 dark:bg-gray-700"},On={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Fn=["value"],Dn={class:"text-sm text-gray-700 dark:text-gray-200"},Nn={key:1},En={key:2},qn={class:"flex gap-4"},Wn={class:"flex cursor-pointer items-center"},Gn={class:"flex cursor-pointer items-center"},Bn={key:3,class:"mt-4"},Qn={class:"flex items-start"},Hn={key:4,class:"mt-4"},Jn={class:"flex items-start"},Yn={class:"ml-3"},Zn={key:0,class:"mt-1"},Xn={class:"flex items-center justify-between"},ei={class:"text-xs text-green-600 dark:text-green-400"},ti=["disabled"],si={key:0,class:"fas fa-trash-alt mr-1"},ai={key:1,class:"loading-spinner mr-1"},ri={key:1,class:"mt-1"},li={key:5,class:"mt-4"},oi={class:"flex items-start"},ni={class:"ml-3 flex-1"},ii={key:0,class:"mt-3"},di={class:"rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},ui={class:"flex items-center gap-2"},pi={class:"block w-full select-all break-all rounded bg-gray-100 px-3 py-2 font-mono text-xs text-gray-700 dark:bg-gray-900 dark:text-gray-300"},gi={class:"text-blue-600 dark:text-blue-400"},mi={class:"text-gray-500 dark:text-gray-500"},yi={class:"text-blue-600 dark:text-blue-400"},xi={key:6,class:"space-y-4"},fi={class:"grid grid-cols-2 gap-4"},bi={key:0,class:"rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},ci={class:"mb-2 flex items-center justify-between"},vi={class:"text-sm text-gray-500 dark:text-gray-400"},ki={class:"relative h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"},hi={class:"mt-2 flex items-center justify-between text-xs"},wi={class:"text-gray-500 dark:text-gray-400"},$i={class:"text-gray-500 dark:text-gray-400"},Ai={class:"mb-3 space-y-2"},Ci=["onUpdate:modelValue"],Ui=["onUpdate:modelValue"],Ti=["onClick"],Ii={class:"mt-3 flex flex-wrap gap-2"},_i={class:"mb-3"},Vi={class:"inline-flex cursor-pointer items-center"},Si={key:0},Mi={key:7,class:"space-y-4"},Ri={class:"relative"},Ki=["type"],zi={class:"grid grid-cols-2 gap-4"},Pi={key:8,class:"space-y-4"},Li={class:"mb-3"},ji={class:"inline-flex cursor-pointer items-center"},Oi={key:0},Fi={key:9,class:"space-y-4"},Di={key:0,class:"mt-1 text-xs text-red-500"},Ni={key:0,class:"mt-1 text-xs text-red-500"},Ei={key:0,class:"mt-1 text-xs text-red-500"},qi={class:"flex flex-wrap gap-2"},Wi=["value"],Gi={class:"text-sm text-gray-700 dark:text-gray-300"},Bi={key:10,class:"rounded-lg border border-amber-200 bg-amber-50 p-4 dark:border-amber-700 dark:bg-amber-900/30"},Qi={class:"space-y-4"},Hi={class:"flex gap-3 pt-4"},Ji=["disabled"],Yi={key:0,class:"loading-spinner mr-2"},Zi={__name:"AccountForm",props:{account:{type:Object,default:null}},emits:["close","success","platform-changed"],setup(be,{emit:Ae}){var Ye,et,Ve,We,ce,tt,Ot,Ft,ft,je,bt,ct,vt,Dt,Nt,kt,ht,wt,Et,qt,Wt,Gt,Bt,ut,$t,At,Qt;const v=be,ge=Ae,V=Ss(),{showConfirmModal:G,confirmOptions:X,showConfirm:g,handleConfirm:w,handleCancel:q}=Vs(),j=Ge(()=>!!v.account),H=I(!0),W=I(1),B=I(!1),ee=I(!1),se=I(!1),F=I(!1),d=I(""),f=I(""),P=I(!1),K=I(""),c=I(""),U=I(!1),E=I(""),ze=u=>["claude","claude-console","ccr","bedrock"].includes(u)?"claude":["openai","openai-responses","azure_openai"].includes(u)?"openai":u==="gemini"?"gemini":"",Pe=()=>{var u;return(u=v.account)!=null&&u.proxy&&v.account.proxy.host&&v.account.proxy.port?{enabled:!0,type:v.account.proxy.type||"socks5",host:v.account.proxy.host,port:v.account.proxy.port,username:v.account.proxy.username||"",password:v.account.proxy.password||""}:{enabled:!1,type:"socks5",host:"",port:"",username:"",password:""}},s=I({platform:((Ye=v.account)==null?void 0:Ye.platform)||"claude",addType:(()=>{var t;const u=((t=v.account)==null?void 0:t.platform)||"claude";return u==="gemini"||u==="openai"?"oauth":u==="claude"?"setup-token":"manual"})(),name:((et=v.account)==null?void 0:et.name)||"",description:((Ve=v.account)==null?void 0:Ve.description)||"",accountType:((We=v.account)==null?void 0:We.accountType)||"shared",subscriptionType:"claude_max",autoStopOnWarning:((ce=v.account)==null?void 0:ce.autoStopOnWarning)||!1,useUnifiedUserAgent:((tt=v.account)==null?void 0:tt.useUnifiedUserAgent)||!1,useUnifiedClientId:((Ot=v.account)==null?void 0:Ot.useUnifiedClientId)||!1,unifiedClientId:((Ft=v.account)==null?void 0:Ft.unifiedClientId)||"",groupId:"",groupIds:[],projectId:((ft=v.account)==null?void 0:ft.projectId)||"",accessToken:"",refreshToken:"",proxy:Pe(),apiUrl:((je=v.account)==null?void 0:je.apiUrl)||"",apiKey:((bt=v.account)==null?void 0:bt.apiKey)||"",priority:((ct=v.account)==null?void 0:ct.priority)||50,baseApi:((vt=v.account)==null?void 0:vt.baseApi)||"",rateLimitDuration:((Dt=v.account)==null?void 0:Dt.rateLimitDuration)||60,supportedModels:(()=>{var t;const u=(t=v.account)==null?void 0:t.supportedModels;return u?typeof u=="object"&&!Array.isArray(u)?Object.keys(u):Array.isArray(u)?u:[]:[]})(),userAgent:((Nt=v.account)==null?void 0:Nt.userAgent)||"",enableRateLimit:v.account?v.account.rateLimitDuration>0:!0,dailyQuota:((kt=v.account)==null?void 0:kt.dailyQuota)||0,dailyUsage:((ht=v.account)==null?void 0:ht.dailyUsage)||0,quotaResetTime:((wt=v.account)==null?void 0:wt.quotaResetTime)||"00:00",accessKeyId:((Et=v.account)==null?void 0:Et.accessKeyId)||"",secretAccessKey:((qt=v.account)==null?void 0:qt.secretAccessKey)||"",region:((Wt=v.account)==null?void 0:Wt.region)||"",sessionToken:((Gt=v.account)==null?void 0:Gt.sessionToken)||"",defaultModel:((Bt=v.account)==null?void 0:Bt.defaultModel)||"",smallFastModel:((ut=v.account)==null?void 0:ut.smallFastModel)||"",azureEndpoint:(($t=v.account)==null?void 0:$t.azureEndpoint)||"",apiVersion:((At=v.account)==null?void 0:At.apiVersion)||"",deploymentName:((Qt=v.account)==null?void 0:Qt.deploymentName)||""}),Te=I([]),pt=()=>{var u;(u=v.account)!=null&&u.supportedModels&&(typeof v.account.supportedModels=="object"&&!Array.isArray(v.account.supportedModels)?Te.value=Object.entries(v.account.supportedModels).map(([t,i])=>({from:t,to:i})):Array.isArray(v.account.supportedModels)&&(Te.value=v.account.supportedModels.map(t=>({from:t,to:t}))))},T=I({name:"",refreshToken:"",accessToken:"",apiUrl:"",apiKey:"",accessKeyId:"",secretAccessKey:"",region:"",azureEndpoint:"",deploymentName:""}),Re=Ge(()=>{var u;return((u=s.value.name)==null?void 0:u.trim())&&s.value.platform}),Be=Ge(()=>d.value&&f.value.trim()),ot=()=>{var u;return!j.value||!((u=v.account)!=null&&u.id)?0:typeof s.value.dailyUsage=="number"?s.value.dailyUsage:0},Le=Ge(()=>!s.value.dailyQuota||s.value.dailyQuota<=0?0:ot()/s.value.dailyQuota*100),Ze=async()=>{var u;if(!(!j.value||!((u=v.account)!=null&&u.id)))try{const t=await O.get(`/admin/claude-console-accounts/${v.account.id}/usage`);t&&(s.value.dailyUsage=t.dailyUsage||0)}catch{}},Qe=u=>{E.value=u,u==="claude"?s.value.platform="claude":u==="openai"?s.value.platform="openai":u==="gemini"&&(s.value.platform="gemini")},Ce=async()=>{if(T.value.name="",!Re.value){(!s.value.name||s.value.name.trim()==="")&&(T.value.name="请填写账户名称");return}if(s.value.accountType==="group"&&(!s.value.groupIds||s.value.groupIds.length===0)){R("请选择一个分组","error");return}s.value.accountType==="group"&&(s.value.groupIds&&s.value.groupIds.length>0?s.value.groupId=s.value.groupIds[0]:s.value.groupId=""),!(s.value.platform==="gemini"&&W.value===1&&s.value.addType==="oauth"&&(!s.value.projectId||s.value.projectId.trim()==="")&&!await g("项目 ID 未填写",`您尚未填写项目 ID。

如果您的Google账号绑定了Google Cloud或被识别为Workspace账号，需要提供项目 ID。
如果您使用的是普通个人账号，可以继续不填写。`,"继续","返回填写"))&&(W.value=2)},nt=async()=>{var u;se.value=!0;try{const t=(u=s.value.proxy)!=null&&u.enabled?{proxy:{type:s.value.proxy.type,host:s.value.proxy.host,port:parseInt(s.value.proxy.port),username:s.value.proxy.username||null,password:s.value.proxy.password||null}}:{},i=await V.generateClaudeSetupTokenUrl(t);d.value=i.authUrl,K.value=i.sessionId}catch(t){R(t.message||"生成Setup Token授权链接失败","error")}finally{se.value=!1}},gt=()=>{d.value="",f.value="",nt()},Kt=async()=>{try{await navigator.clipboard.writeText(d.value),P.value=!0,R("链接已复制","success"),setTimeout(()=>{P.value=!1},2e3)}catch{const t=document.createElement("textarea");t.value=d.value,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{document.execCommand("copy")?(P.value=!0,R("链接已复制","success")):R("复制失败，请手动复制","error")}catch{R("复制失败，请手动复制","error")}document.body.removeChild(t),setTimeout(()=>{P.value=!1},2e3)}},mt=async()=>{var u;if(Be.value){F.value=!0;try{const t={sessionId:K.value,callbackUrl:f.value.trim()};(u=s.value.proxy)!=null&&u.enabled&&(t.proxy={type:s.value.proxy.type,host:s.value.proxy.host,port:parseInt(s.value.proxy.port),username:s.value.proxy.username||null,password:s.value.proxy.password||null});const i=await V.exchangeClaudeSetupTokenCode(t);s.value.useUnifiedClientId&&!s.value.unifiedClientId&&(s.value.unifiedClientId=Ke()),await it(i)}catch(t){R(t.message||"Setup Token授权失败，请检查授权码是否正确","error")}finally{F.value=!1}}},it=async u=>{var t,i,Y,Q,Se,S;B.value=!0;try{s.value.platform==="claude"&&s.value.useUnifiedClientId&&!s.value.unifiedClientId&&(s.value.unifiedClientId=Ke());const C={name:s.value.name,description:s.value.description,accountType:s.value.accountType,groupId:s.value.accountType==="group"?s.value.groupId:void 0,groupIds:s.value.accountType==="group"?s.value.groupIds:void 0,proxy:s.value.proxy.enabled?{type:s.value.proxy.type,host:s.value.proxy.host,port:parseInt(s.value.proxy.port),username:s.value.proxy.username||null,password:s.value.proxy.password||null}:null};s.value.platform==="claude"?(C.claudeAiOauth=u.claudeAiOauth||u,C.priority=s.value.priority||50,C.autoStopOnWarning=s.value.autoStopOnWarning||!1,C.useUnifiedUserAgent=s.value.useUnifiedUserAgent||!1,C.useUnifiedClientId=s.value.useUnifiedClientId||!1,C.unifiedClientId=s.value.unifiedClientId||"",C.subscriptionInfo={accountType:s.value.subscriptionType||"claude_max",hasClaudeMax:s.value.subscriptionType==="claude_max",hasClaudePro:s.value.subscriptionType==="claude_pro",manuallySet:!0}):s.value.platform==="gemini"?(C.geminiOauth=u.tokens||u,s.value.projectId&&(C.projectId=s.value.projectId),C.priority=s.value.priority||50):s.value.platform==="openai"&&(C.openaiOauth=u.tokens||u,C.accountInfo=u.accountInfo,C.priority=s.value.priority||50);let ne;s.value.platform==="claude"?ne=await V.createClaudeAccount(C):s.value.platform==="openai"?ne=await V.createOpenAIAccount(C):ne=await V.createGeminiAccount(C),ge("success",ne)}catch(C){const ne=((i=(t=C.response)==null?void 0:t.data)==null?void 0:i.error)||C.message||"账户创建失败",ie=((Q=(Y=C.response)==null?void 0:Y.data)==null?void 0:Q.suggestion)||"",pe=((S=(Se=C.response)==null?void 0:Se.data)==null?void 0:S.errorDetails)||null;let Oe=ne;ie&&(Oe+=`
${ie}`),pe&&pe.error_description?Oe+=`
详细信息: ${pe.error_description}`:pe&&pe.error&&pe.error.message&&(Oe+=`
详细信息: ${pe.error.message}`),R(Oe,"error","",8e3)}finally{B.value=!1}},yt=async()=>{var t,i,Y,Q,Se,S;T.value.name="",T.value.accessToken="",T.value.apiUrl="",T.value.apiKey="";let u=!1;if((!s.value.name||s.value.name.trim()==="")&&(T.value.name="请填写账户名称",u=!0),s.value.platform==="claude-console"&&((!s.value.apiUrl||s.value.apiUrl.trim()==="")&&(T.value.apiUrl="请填写 API URL",u=!0),(!s.value.apiKey||s.value.apiKey.trim()==="")&&(T.value.apiKey="请填写 API Key",u=!0)),s.value.platform==="ccr"&&((!s.value.apiUrl||s.value.apiUrl.trim()==="")&&(T.value.apiUrl="请填写 API URL",u=!0),(!s.value.apiKey||s.value.apiKey.trim()==="")&&(T.value.apiKey="请填写 API Key",u=!0)),s.value.platform==="openai-responses"?((!s.value.baseApi||s.value.baseApi.trim()==="")&&(T.value.baseApi="请填写 API 基础地址",u=!0),(!s.value.apiKey||s.value.apiKey.trim()==="")&&(T.value.apiKey="请填写 API 密钥",u=!0)):s.value.platform==="bedrock"?((!s.value.accessKeyId||s.value.accessKeyId.trim()==="")&&(T.value.accessKeyId="请填写 AWS 访问密钥 ID",u=!0),(!s.value.secretAccessKey||s.value.secretAccessKey.trim()==="")&&(T.value.secretAccessKey="请填写 AWS 秘密访问密钥",u=!0),(!s.value.region||s.value.region.trim()==="")&&(T.value.region="请选择 AWS 区域",u=!0)):s.value.platform==="azure_openai"?((!s.value.azureEndpoint||s.value.azureEndpoint.trim()==="")&&(T.value.azureEndpoint="请填写 Azure Endpoint",u=!0),(!s.value.deploymentName||s.value.deploymentName.trim()==="")&&(T.value.deploymentName="请填写部署名称",u=!0),(!s.value.apiKey||s.value.apiKey.trim()==="")&&(T.value.apiKey="请填写 API Key",u=!0)):s.value.addType==="manual"&&(s.value.platform==="openai"?(!s.value.refreshToken||s.value.refreshToken.trim()==="")&&(T.value.refreshToken="请填写 Refresh Token",u=!0):s.value.platform==="gemini"?(!s.value.accessToken||s.value.accessToken.trim()==="")&&(T.value.accessToken="请填写 Access Token",u=!0):s.value.platform==="claude"&&(!s.value.accessToken||s.value.accessToken.trim()==="")&&(T.value.accessToken="请填写 Access Token",u=!0)),s.value.accountType==="group"&&(!s.value.groupIds||s.value.groupIds.length===0)&&(R("请选择一个分组","error"),u=!0),s.value.accountType==="group"&&(s.value.groupIds&&s.value.groupIds.length>0?s.value.groupId=s.value.groupIds[0]:s.value.groupId=""),!u){B.value=!0;try{const C={name:s.value.name,description:s.value.description,accountType:s.value.accountType,groupId:s.value.accountType==="group"?s.value.groupId:void 0,groupIds:s.value.accountType==="group"?s.value.groupIds:void 0,proxy:s.value.proxy.enabled?{type:s.value.proxy.type,host:s.value.proxy.host,port:parseInt(s.value.proxy.port),username:s.value.proxy.username||null,password:s.value.proxy.password||null}:null};if(s.value.platform==="claude"){const ie=s.value.refreshToken?6e5:31536e6;s.value.useUnifiedClientId&&!s.value.unifiedClientId&&(s.value.unifiedClientId=Ke()),C.claudeAiOauth={accessToken:s.value.accessToken,refreshToken:s.value.refreshToken||"",expiresAt:Date.now()+ie,scopes:[]},C.priority=s.value.priority||50,C.autoStopOnWarning=s.value.autoStopOnWarning||!1,C.useUnifiedUserAgent=s.value.useUnifiedUserAgent||!1,C.useUnifiedClientId=s.value.useUnifiedClientId||!1,C.unifiedClientId=s.value.unifiedClientId||"",C.subscriptionInfo={accountType:s.value.subscriptionType||"claude_max",hasClaudeMax:s.value.subscriptionType==="claude_max",hasClaudePro:s.value.subscriptionType==="claude_pro",manuallySet:!0}}else if(s.value.platform==="gemini"){const ie=s.value.refreshToken?6e5:31536e6;C.geminiOauth={access_token:s.value.accessToken,refresh_token:s.value.refreshToken||"",scope:"https://www.googleapis.com/auth/cloud-platform",token_type:"Bearer",expiry_date:Date.now()+ie},s.value.projectId&&(C.projectId=s.value.projectId),C.priority=s.value.priority||50}else if(s.value.platform==="openai"){const ie=s.value.refreshToken?6e5:31536e6;C.openaiOauth={idToken:"",accessToken:s.value.accessToken||"",refreshToken:s.value.refreshToken,expires_in:Math.floor(ie/1e3)},C.accountInfo={accountId:"",chatgptUserId:"",organizationId:"",organizationRole:"",organizationTitle:"",planType:"",email:"",emailVerified:!1},C.needsImmediateRefresh=!0,C.requireRefreshSuccess=!0,C.priority=s.value.priority||50}else s.value.platform==="claude-console"||s.value.platform==="ccr"?(C.apiUrl=s.value.apiUrl,C.apiKey=s.value.apiKey,C.priority=s.value.priority||50,C.supportedModels=dt()||{},C.userAgent=s.value.userAgent||null,C.rateLimitDuration=s.value.enableRateLimit?s.value.rateLimitDuration||60:0,C.dailyQuota=s.value.dailyQuota||0,C.quotaResetTime=s.value.quotaResetTime||"00:00"):s.value.platform==="openai-responses"?(C.baseApi=s.value.baseApi,C.apiKey=s.value.apiKey,C.userAgent=s.value.userAgent||"",C.priority=s.value.priority||50,C.rateLimitDuration=60,C.dailyQuota=s.value.dailyQuota||0,C.quotaResetTime=s.value.quotaResetTime||"00:00"):s.value.platform==="bedrock"?(C.awsCredentials={accessKeyId:s.value.accessKeyId,secretAccessKey:s.value.secretAccessKey,sessionToken:s.value.sessionToken||null},C.region=s.value.region,C.defaultModel=s.value.defaultModel||null,C.smallFastModel=s.value.smallFastModel||null,C.priority=s.value.priority||50,C.rateLimitDuration=s.value.enableRateLimit?s.value.rateLimitDuration||60:0):s.value.platform==="azure_openai"&&(C.azureEndpoint=s.value.azureEndpoint,C.apiKey=s.value.apiKey,C.apiVersion=s.value.apiVersion||"2024-02-01",C.deploymentName=s.value.deploymentName,C.supportedModels=Array.isArray(s.value.supportedModels)?s.value.supportedModels:[],C.priority=s.value.priority||50,C.isActive=s.value.isActive!==!1,C.schedulable=s.value.schedulable!==!1);let ne;if(s.value.platform==="claude")ne=await V.createClaudeAccount(C);else if(s.value.platform==="claude-console"||s.value.platform==="ccr")ne=await V.createClaudeConsoleAccount(C);else if(s.value.platform==="openai-responses")ne=await V.createOpenAIResponsesAccount(C);else if(s.value.platform==="bedrock")ne=await V.createBedrockAccount(C);else if(s.value.platform==="openai")ne=await V.createOpenAIAccount(C);else if(s.value.platform==="azure_openai")ne=await V.createAzureOpenAIAccount(C);else if(s.value.platform==="gemini")ne=await V.createGeminiAccount(C);else throw new Error(`不支持的平台: ${s.value.platform}`);ge("success",ne)}catch(C){const ne=((i=(t=C.response)==null?void 0:t.data)==null?void 0:i.error)||C.message||"账户创建失败",ie=((Q=(Y=C.response)==null?void 0:Y.data)==null?void 0:Q.suggestion)||"",pe=((S=(Se=C.response)==null?void 0:Se.data)==null?void 0:S.errorDetails)||null;let Oe=ne;ie&&(Oe+=`
${ie}`),pe&&pe.error_description?Oe+=`
详细信息: ${pe.error_description}`:pe&&pe.error&&pe.error.message&&(Oe+=`
详细信息: ${pe.error.message}`),R(Oe,"error","",8e3)}finally{B.value=!1}}},xt=async()=>{var u,t,i,Y,Q,Se;if(T.value.name="",!s.value.name||s.value.name.trim()===""){T.value.name="请填写账户名称";return}if(s.value.accountType==="group"&&(!s.value.groupIds||s.value.groupIds.length===0)){R("请选择一个分组","error");return}if(s.value.accountType==="group"&&(s.value.groupIds&&s.value.groupIds.length>0?s.value.groupId=s.value.groupIds[0]:s.value.groupId=""),!(s.value.platform==="gemini"&&(!s.value.projectId||s.value.projectId.trim()==="")&&!await g("项目 ID 未填写",`您尚未填写项目 ID。

如果您的Google账号绑定了Google Cloud或被识别为Workspace账号，需要提供项目 ID。
如果您使用的是普通个人账号，可以继续不填写。`,"继续保存","返回填写"))){B.value=!0;try{const S={name:s.value.name,description:s.value.description,accountType:s.value.accountType,groupId:s.value.accountType==="group"?s.value.groupId:void 0,groupIds:s.value.accountType==="group"?s.value.groupIds:void 0,proxy:s.value.proxy.enabled?{type:s.value.proxy.type,host:s.value.proxy.host,port:parseInt(s.value.proxy.port),username:s.value.proxy.username||null,password:s.value.proxy.password||null}:null};if(s.value.accessToken||s.value.refreshToken){if(v.account.platform==="claude"){const C=s.value.refreshToken?6e5:31536e6;S.claudeAiOauth={accessToken:s.value.accessToken||"",refreshToken:s.value.refreshToken||"",expiresAt:Date.now()+C,scopes:v.account.scopes||[]}}else if(v.account.platform==="gemini"){const C=s.value.refreshToken?6e5:31536e6;S.geminiOauth={access_token:s.value.accessToken||"",refresh_token:s.value.refreshToken||"",scope:"https://www.googleapis.com/auth/cloud-platform",token_type:"Bearer",expiry_date:Date.now()+C}}else if(v.account.platform==="openai"){const C=s.value.refreshToken?6e5:31536e6;S.openaiOauth={idToken:"",accessToken:s.value.accessToken||"",refreshToken:s.value.refreshToken||"",expires_in:Math.floor(C/1e3)},s.value.refreshToken&&s.value.refreshToken!==v.account.refreshToken&&(S.needsImmediateRefresh=!0,S.requireRefreshSuccess=!0)}}if(v.account.platform==="gemini"&&(S.projectId=s.value.projectId||""),v.account.platform==="claude"&&(s.value.useUnifiedClientId&&!s.value.unifiedClientId&&(s.value.unifiedClientId=Ke()),S.priority=s.value.priority||50,S.autoStopOnWarning=s.value.autoStopOnWarning||!1,S.useUnifiedUserAgent=s.value.useUnifiedUserAgent||!1,S.useUnifiedClientId=s.value.useUnifiedClientId||!1,S.unifiedClientId=s.value.unifiedClientId||"",S.subscriptionInfo={accountType:s.value.subscriptionType||"claude_max",hasClaudeMax:s.value.subscriptionType==="claude_max",hasClaudePro:s.value.subscriptionType==="claude_pro",manuallySet:!0}),v.account.platform==="openai"&&(S.priority=s.value.priority||50),v.account.platform==="gemini"&&(S.priority=s.value.priority||50),v.account.platform==="claude-console"&&(S.apiUrl=s.value.apiUrl,s.value.apiKey&&(S.apiKey=s.value.apiKey),S.priority=s.value.priority||50,S.supportedModels=dt()||{},S.userAgent=s.value.userAgent||null,S.rateLimitDuration=s.value.enableRateLimit?s.value.rateLimitDuration||60:0,S.dailyQuota=s.value.dailyQuota||0,S.quotaResetTime=s.value.quotaResetTime||"00:00"),v.account.platform==="openai-responses"&&(S.baseApi=s.value.baseApi,s.value.apiKey&&(S.apiKey=s.value.apiKey),S.userAgent=s.value.userAgent||"",S.priority=s.value.priority||50,S.dailyQuota=s.value.dailyQuota||0,S.quotaResetTime=s.value.quotaResetTime||"00:00"),v.account.platform==="bedrock"&&((s.value.accessKeyId||s.value.secretAccessKey||s.value.sessionToken)&&(S.awsCredentials={},s.value.accessKeyId&&(S.awsCredentials.accessKeyId=s.value.accessKeyId),s.value.secretAccessKey&&(S.awsCredentials.secretAccessKey=s.value.secretAccessKey),s.value.sessionToken!==void 0&&(S.awsCredentials.sessionToken=s.value.sessionToken||null)),s.value.region&&(S.region=s.value.region),S.defaultModel=s.value.defaultModel||null,S.smallFastModel=s.value.smallFastModel||null,S.priority=s.value.priority||50,S.rateLimitDuration=s.value.enableRateLimit?s.value.rateLimitDuration||60:0),v.account.platform==="azure_openai"&&(S.azureEndpoint=s.value.azureEndpoint,S.apiVersion=s.value.apiVersion||"2024-02-01",S.deploymentName=s.value.deploymentName,S.supportedModels=Array.isArray(s.value.supportedModels)?s.value.supportedModels:[],S.priority=s.value.priority||50,s.value.apiKey&&s.value.apiKey.trim()&&(S.apiKey=s.value.apiKey)),v.account.platform==="claude")await V.updateClaudeAccount(v.account.id,S);else if(v.account.platform==="claude-console")await V.updateClaudeConsoleAccount(v.account.id,S);else if(v.account.platform==="openai-responses")await V.updateOpenAIResponsesAccount(v.account.id,S);else if(v.account.platform==="bedrock")await V.updateBedrockAccount(v.account.id,S);else if(v.account.platform==="openai")await V.updateOpenAIAccount(v.account.id,S);else if(v.account.platform==="azure_openai")await V.updateAzureOpenAIAccount(v.account.id,S);else if(v.account.platform==="gemini")await V.updateGeminiAccount(v.account.id,S);else throw new Error(`不支持的平台: ${v.account.platform}`);ge("success")}catch(S){const C=((t=(u=S.response)==null?void 0:u.data)==null?void 0:t.error)||S.message||"账户更新失败",ne=((Y=(i=S.response)==null?void 0:i.data)==null?void 0:Y.suggestion)||"",ie=((Se=(Q=S.response)==null?void 0:Q.data)==null?void 0:Se.errorDetails)||null;let pe=C;ne&&(pe+=`
${ne}`),ie&&ie.error_description?pe+=`
详细信息: ${ie.error_description}`:ie&&ie.error&&ie.error.message&&(pe+=`
详细信息: ${ie.error.message}`),R(pe,"error","",8e3)}finally{B.value=!1}}};le(()=>s.value.name,()=>{var u;T.value.name&&((u=s.value.name)!=null&&u.trim())&&(T.value.name="")}),le(()=>s.value.accessToken,()=>{var u;T.value.accessToken&&((u=s.value.accessToken)!=null&&u.trim())&&(T.value.accessToken="")}),le(()=>s.value.apiUrl,()=>{var u;T.value.apiUrl&&((u=s.value.apiUrl)!=null&&u.trim())&&(T.value.apiUrl="")}),le(()=>s.value.apiKey,()=>{var u;T.value.apiKey&&((u=s.value.apiKey)!=null&&u.trim())&&(T.value.apiKey="")}),le(()=>s.value.azureEndpoint,()=>{var u;T.value.azureEndpoint&&((u=s.value.azureEndpoint)!=null&&u.trim())&&(T.value.azureEndpoint="")}),le(()=>s.value.deploymentName,()=>{var u;T.value.deploymentName&&((u=s.value.deploymentName)!=null&&u.trim())&&(T.value.deploymentName="")});const He=I([]),Je=I(!1),b=I(!1),m=Ge(()=>{let u=s.value.platform;return s.value.platform==="claude-console"||s.value.platform==="ccr"?u="claude":s.value.platform==="openai-responses"&&(u="openai"),He.value.filter(t=>t.platform===u)}),_=async()=>{Je.value=!0;try{const u=await O.get("/admin/account-groups");He.value=u.data||[]}catch{R("加载分组列表失败","error"),He.value=[]}finally{Je.value=!1}},Ie=async()=>{await _(),R("分组列表已刷新","success")},zt=()=>{b.value=!0},Zt=async()=>{await _()};le(()=>s.value.platform,u=>{u==="claude-console"||u==="ccr"||u==="bedrock"||u==="openai-responses"?s.value.addType="manual":u==="claude"?s.value.addType="setup-token":(u==="gemini"||u==="openai")&&(s.value.addType="oauth"),s.value.accountType==="group"&&(s.value.groupId="",s.value.groupIds=[])}),le(()=>s.value.groupIds,u=>{s.value.accountType==="group"&&(u&&u.length>0?s.value.groupId=u[0]:s.value.groupId="")},{deep:!0}),le(f,u=>{if(!u||typeof u!="string")return;const t=u.trim();if(!t)return;if(t.startsWith("http://")||t.startsWith("https://"))if(t.startsWith("http://localhost:45462"))try{const Q=new URL(t).searchParams.get("code");Q?(f.value=Q,R("成功提取授权码！","success")):R("URL 中未找到授权码参数，请检查链接是否正确","error")}catch{R("链接格式错误，请检查是否为完整的 URL","error")}else R("请粘贴以 http://localhost:45462 开头的链接","error")}),le(()=>s.value.platform,u=>{j.value||ge("platform-changed",u)}),le(()=>s.value.accountType,u=>{u==="group"&&He.value.length===0&&_()}),le(()=>s.value.groupId,u=>{u==="__new__"&&(s.value.groupId="",b.value=!0)});const Pt=()=>{Te.value.push({from:"",to:""})},Xe=u=>{Te.value.splice(u,1)},_e=(u,t)=>{if(Te.value.some(Y=>Y.from===u)){R(`模型 ${u} 的映射已存在`,"info");return}Te.value.push({from:u,to:t}),R(`已添加映射: ${u} → ${t}`,"success")},dt=()=>{const u={};return Te.value.forEach(t=>{t.from&&t.to&&(u[t.from]=t.to)}),Object.keys(u).length>0?u:null};le(()=>v.account,u=>{if(u){pt();const t=u.proxy&&u.proxy.host&&u.proxy.port?{enabled:!0,type:u.proxy.type||"socks5",host:u.proxy.host,port:u.proxy.port,username:u.proxy.username||"",password:u.proxy.password||""}:{enabled:!1,type:"socks5",host:"",port:"",username:"",password:""};let i="";u.accountType==="group"&&(i=u.groupId||u.groupInfo&&u.groupInfo.id||"");let Y="claude_max";if(u.subscriptionInfo){const Q=typeof u.subscriptionInfo=="string"?JSON.parse(u.subscriptionInfo):u.subscriptionInfo;Q.accountType?Y=Q.accountType:Q.hasClaudeMax?Y="claude_max":Q.hasClaudePro?Y="claude_pro":Y="claude_free"}s.value={platform:u.platform,addType:"oauth",name:u.name,description:u.description||"",accountType:u.accountType||"shared",subscriptionType:Y,autoStopOnWarning:u.autoStopOnWarning||!1,useUnifiedUserAgent:u.useUnifiedUserAgent||!1,useUnifiedClientId:u.useUnifiedClientId||!1,unifiedClientId:u.unifiedClientId||"",groupId:i,groupIds:[],projectId:u.projectId||"",accessToken:"",refreshToken:"",proxy:t,apiUrl:u.apiUrl||"",apiKey:"",priority:u.priority||50,supportedModels:(()=>{const Q=u.supportedModels;return Q?typeof Q=="object"&&!Array.isArray(Q)?Object.keys(Q):Array.isArray(Q)?Q:[]:[]})(),userAgent:u.userAgent||"",enableRateLimit:!!(u.rateLimitDuration&&u.rateLimitDuration>0),rateLimitDuration:u.rateLimitDuration||60,accessKeyId:"",secretAccessKey:"",region:u.region||"",sessionToken:"",defaultModel:u.defaultModel||"",smallFastModel:u.smallFastModel||"",azureEndpoint:u.azureEndpoint||"",apiVersion:u.apiVersion||"",deploymentName:u.deploymentName||"",baseApi:u.baseApi||"",dailyQuota:u.dailyQuota||0,dailyUsage:u.dailyUsage||0,quotaResetTime:u.quotaResetTime||"00:00"},u.platform==="claude-console"&&Ze(),u.accountType==="group"&&_().then(async()=>{const Q=[];if(u.groupInfo&&u.groupInfo.id)s.value.groupId=u.groupInfo.id,Q.push(u.groupInfo.id);else if(u.groupId)s.value.groupId=u.groupId,Q.push(u.groupId);else if(u.groupIds&&Array.isArray(u.groupIds)&&u.groupIds.length>0)s.value.groupId=u.groupIds[0],Q.push(...u.groupIds);else{const Se=He.value.map(async S=>{try{((await O.get(`/admin/account-groups/${S.id}/members`)).data||[]).some(ie=>ie.id===u.id)&&(Q.push(S.id),s.value.groupId||(s.value.groupId=S.id))}catch{}});await Promise.all(Se)}s.value.groupIds=Q})}},{immediate:!0});const Lt=async()=>{try{const u=await O.get("/admin/claude-code-version");u.success&&u.userAgent?c.value=u.userAgent:c.value=""}catch{c.value=""}},jt=async()=>{U.value=!0;try{(await O.post("/admin/claude-code-version/clear")).success?(c.value="",R("统一User-Agent缓存已清除","success")):R("清除缓存失败","error")}catch(u){R("清除缓存失败："+(u.message||"未知错误"),"error")}finally{U.value=!1}},Ke=()=>{const u=new Uint8Array(32);return crypto.getRandomValues(u),Array.from(u,t=>t.toString(16).padStart(2,"0")).join("")},Ee=()=>{s.value.unifiedClientId=Ke(),R("已生成新的客户端标识","success")},qe=()=>{s.value.useUnifiedClientId&&(s.value.useUnifiedUserAgent=!0,s.value.unifiedClientId||(s.value.unifiedClientId=Ke()))};return Yt(()=>{var u;E.value=ze(s.value.platform),Lt(),j.value&&((u=v.account)==null?void 0:u.platform)==="claude-console"&&Ze()}),le(()=>s.value.platform,u=>{u==="claude"&&Lt()}),(u,t)=>(o(),Ne(ls,{to:"body"},[H.value?(o(),n("div",Nr,[e("div",Er,[e("div",qr,[e("div",Wr,[t[115]||(t[115]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-green-500 to-green-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-user-circle text-sm text-white sm:text-base"})],-1)),e("h3",Gr,p(j.value?"编辑账户":"添加账户"),1)]),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600",onClick:t[0]||(t[0]=i=>u.$emit("close"))},t[116]||(t[116]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)]))]),!j.value&&(s.value.addType==="oauth"||s.value.addType==="setup-token")?(o(),n("div",Br,[e("div",Qr,[e("div",Hr,[e("div",{class:M(["flex h-6 w-6 items-center justify-center rounded-full text-xs font-semibold sm:h-8 sm:w-8 sm:text-sm",W.value>=1?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"])}," 1 ",2),t[117]||(t[117]=e("span",{class:"ml-1.5 text-xs font-medium text-gray-700 dark:text-gray-300 sm:ml-2 sm:text-sm"},"基本信息",-1))]),t[119]||(t[119]=e("div",{class:"h-0.5 w-4 bg-gray-300 sm:w-8"},null,-1)),e("div",Jr,[e("div",{class:M(["flex h-6 w-6 items-center justify-center rounded-full text-xs font-semibold sm:h-8 sm:w-8 sm:text-sm",W.value>=2?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"])}," 2 ",2),t[118]||(t[118]=e("span",{class:"ml-1.5 text-xs font-medium text-gray-700 dark:text-gray-300 sm:ml-2 sm:text-sm"},"授权认证",-1))])])])):k("",!0),W.value===1&&!j.value?(o(),n("div",Yr,[e("div",Zr,[j.value?k("",!0):(o(),n("div",Xr,[t[149]||(t[149]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"选择平台",-1)),e("div",el,[e("div",tl,[e("div",{class:M(["group relative cursor-pointer overflow-hidden rounded-lg border-2 transition-all duration-200",[E.value==="claude"?"border-indigo-500 bg-gradient-to-br from-indigo-50 to-purple-50 shadow-md dark:from-indigo-900/20 dark:to-purple-900/20":"border-gray-200 bg-white hover:border-indigo-300 hover:shadow dark:border-gray-700 dark:bg-gray-800 dark:hover:border-indigo-600"]]),onClick:t[1]||(t[1]=i=>Qe("claude"))},[e("div",sl,[e("div",al,[t[121]||(t[121]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-md bg-gradient-to-br from-indigo-500 to-purple-600"},[e("i",{class:"fas fa-brain text-sm text-white"})],-1)),E.value==="claude"?(o(),n("div",rl,t[120]||(t[120]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)]),t[122]||(t[122]=e("h4",{class:"mt-2 text-sm font-semibold text-gray-900 dark:text-gray-100"}," Claude ",-1)),t[123]||(t[123]=e("p",{class:"text-xs text-gray-600 dark:text-gray-400"},"Anthropic",-1))])],2),e("div",{class:M(["group relative cursor-pointer overflow-hidden rounded-lg border-2 transition-all duration-200",[E.value==="openai"?"border-emerald-500 bg-gradient-to-br from-emerald-50 to-teal-50 shadow-md dark:from-emerald-900/20 dark:to-teal-900/20":"border-gray-200 bg-white hover:border-emerald-300 hover:shadow dark:border-gray-700 dark:bg-gray-800 dark:hover:border-emerald-600"]]),onClick:t[2]||(t[2]=i=>Qe("openai"))},[e("div",ll,[e("div",ol,[t[125]||(t[125]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-md bg-gradient-to-br from-emerald-500 to-teal-600"},[e("svg",{class:"h-5 w-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.4069-.6813zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"})])],-1)),E.value==="openai"?(o(),n("div",nl,t[124]||(t[124]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)]),t[126]||(t[126]=e("h4",{class:"mt-2 text-sm font-semibold text-gray-900 dark:text-gray-100"}," OpenAI ",-1)),t[127]||(t[127]=e("p",{class:"text-xs text-gray-600 dark:text-gray-400"},"GPT 系列",-1))])],2),e("div",{class:M(["group relative cursor-pointer overflow-hidden rounded-lg border-2 transition-all duration-200",[E.value==="gemini"?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-md dark:from-blue-900/20 dark:to-indigo-900/20":"border-gray-200 bg-white hover:border-blue-300 hover:shadow dark:border-gray-700 dark:bg-gray-800 dark:hover:border-blue-600"]]),onClick:t[3]||(t[3]=i=>Qe("gemini"))},[e("div",il,[e("div",dl,[t[129]||(t[129]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-md bg-gradient-to-br from-blue-500 to-indigo-600"},[e("i",{class:"fab fa-google text-sm text-white"})],-1)),E.value==="gemini"?(o(),n("div",ul,t[128]||(t[128]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)]),t[130]||(t[130]=e("h4",{class:"mt-2 text-sm font-semibold text-gray-900 dark:text-gray-100"}," Gemini ",-1)),t[131]||(t[131]=e("p",{class:"text-xs text-gray-600 dark:text-gray-400"},"Google AI",-1))])],2)]),E.value?(o(),n("div",pl,[t[148]||(t[148]=e("p",{class:"mb-2 text-xs font-medium text-gray-700 dark:text-gray-300"}," 选择具体平台类型： ",-1)),e("div",gl,[E.value==="claude"?(o(),n(ae,{key:0},[e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="claude"?"border-indigo-500 bg-indigo-50 dark:border-indigo-400 dark:bg-indigo-900/30":"border-gray-300 bg-white hover:border-indigo-400 hover:bg-indigo-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-indigo-500 dark:hover:bg-indigo-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"claude"},null,512),[[oe,s.value.platform]]),t[133]||(t[133]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-brain text-sm text-indigo-600 dark:text-indigo-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Claude Code"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"官方")])],-1)),s.value.platform==="claude"?(o(),n("div",ml,t[132]||(t[132]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2),e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="claude-console"?"border-purple-500 bg-purple-50 dark:border-purple-400 dark:bg-purple-900/30":"border-gray-300 bg-white hover:border-purple-400 hover:bg-purple-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-purple-500 dark:hover:bg-purple-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"claude-console"},null,512),[[oe,s.value.platform]]),t[135]||(t[135]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-terminal text-sm text-purple-600 dark:text-purple-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Claude Console"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"标准API")])],-1)),s.value.platform==="claude-console"?(o(),n("div",yl,t[134]||(t[134]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2),e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="bedrock"?"border-orange-500 bg-orange-50 dark:border-orange-400 dark:bg-orange-900/30":"border-gray-300 bg-white hover:border-orange-400 hover:bg-orange-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-orange-500 dark:hover:bg-orange-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"bedrock"},null,512),[[oe,s.value.platform]]),t[137]||(t[137]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fab fa-aws text-sm text-orange-600 dark:text-orange-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Bedrock"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"AWS")])],-1)),s.value.platform==="bedrock"?(o(),n("div",xl,t[136]||(t[136]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2),e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="ccr"?"border-cyan-500 bg-cyan-50 dark:border-cyan-400 dark:bg-cyan-900/30":"border-gray-300 bg-white hover:border-cyan-400 hover:bg-cyan-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-cyan-500 dark:hover:bg-cyan-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[7]||(t[7]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"ccr"},null,512),[[oe,s.value.platform]]),t[139]||(t[139]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-code-branch text-sm text-cyan-600 dark:text-cyan-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"CCR"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Claude Code Router")])],-1)),s.value.platform==="ccr"?(o(),n("div",fl,t[138]||(t[138]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2)],64)):k("",!0),E.value==="openai"?(o(),n(ae,{key:1},[e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="openai"?"border-emerald-500 bg-emerald-50 dark:border-emerald-400 dark:bg-emerald-900/30":"border-gray-300 bg-white hover:border-emerald-400 hover:bg-emerald-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-emerald-500 dark:hover:bg-emerald-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[8]||(t[8]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"openai"},null,512),[[oe,s.value.platform]]),t[141]||(t[141]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-robot text-sm text-emerald-600 dark:text-emerald-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Codex Cli"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"官方")])],-1)),s.value.platform==="openai"?(o(),n("div",bl,t[140]||(t[140]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2),e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="openai-responses"?"border-teal-500 bg-teal-50 dark:border-teal-400 dark:bg-teal-900/30":"border-gray-300 bg-white hover:border-teal-400 hover:bg-teal-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-teal-500 dark:hover:bg-teal-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[9]||(t[9]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"openai-responses"},null,512),[[oe,s.value.platform]]),t[143]||(t[143]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-server text-sm text-teal-600 dark:text-teal-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Responses"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Openai-Responses")])],-1)),s.value.platform==="openai-responses"?(o(),n("div",cl,t[142]||(t[142]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2),e("label",{class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="azure_openai"?"border-blue-500 bg-blue-50 dark:border-blue-400 dark:bg-blue-900/30":"border-gray-300 bg-white hover:border-blue-400 hover:bg-blue-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-blue-500 dark:hover:bg-blue-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[10]||(t[10]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"azure_openai"},null,512),[[oe,s.value.platform]]),t[145]||(t[145]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fab fa-microsoft text-sm text-blue-600 dark:text-blue-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Azure"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Azure Openai")])],-1)),s.value.platform==="azure_openai"?(o(),n("div",vl,t[144]||(t[144]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2)],64)):k("",!0),E.value==="gemini"?(o(),n("label",{key:2,class:M(["group relative flex cursor-pointer items-center rounded-md border p-2 transition-all",[s.value.platform==="gemini"?"border-blue-500 bg-blue-50 dark:border-blue-400 dark:bg-blue-900/30":"border-gray-300 bg-white hover:border-blue-400 hover:bg-blue-50/50 dark:border-gray-600 dark:bg-gray-700 dark:hover:border-blue-500 dark:hover:bg-blue-900/20"]])},[y(e("input",{"onUpdate:modelValue":t[11]||(t[11]=i=>s.value.platform=i),class:"sr-only",type:"radio",value:"gemini"},null,512),[[oe,s.value.platform]]),t[147]||(t[147]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fab fa-google text-sm text-blue-600 dark:text-blue-400"}),e("div",null,[e("span",{class:"block text-xs font-medium text-gray-900 dark:text-gray-100"},"Gemini Cli"),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"官方")])],-1)),s.value.platform==="gemini"?(o(),n("div",kl,t[146]||(t[146]=[e("i",{class:"fas fa-check text-xs text-white"},null,-1)]))):k("",!0)],2)):k("",!0)])])):k("",!0)])])),!j.value&&s.value.platform!=="claude-console"&&s.value.platform!=="ccr"&&s.value.platform!=="bedrock"&&s.value.platform!=="azure_openai"&&s.value.platform!=="openai-responses"?(o(),n("div",hl,[t[153]||(t[153]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"添加方式",-1)),e("div",wl,[s.value.platform==="claude"?(o(),n("label",$l,[y(e("input",{"onUpdate:modelValue":t[12]||(t[12]=i=>s.value.addType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"setup-token"},null,512),[[oe,s.value.addType]]),t[150]||(t[150]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Setup Token (推荐)",-1))])):k("",!0),e("label",Al,[y(e("input",{"onUpdate:modelValue":t[13]||(t[13]=i=>s.value.addType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"oauth"},null,512),[[oe,s.value.addType]]),t[151]||(t[151]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"OAuth 授权",-1))]),e("label",Cl,[y(e("input",{"onUpdate:modelValue":t[14]||(t[14]=i=>s.value.addType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"manual"},null,512),[[oe,s.value.addType]]),t[152]||(t[152]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"手动输入 Access Token",-1))])])])):k("",!0),e("div",null,[t[154]||(t[154]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"账户名称",-1)),y(e("input",{"onUpdate:modelValue":t[15]||(t[15]=i=>s.value.name=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.name}]),placeholder:"为账户设置一个易识别的名称",required:"",type:"text"},null,2),[[A,s.value.name]]),T.value.name?(o(),n("p",Ul,p(T.value.name),1)):k("",!0)]),e("div",null,[t[155]||(t[155]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"描述 (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":t[16]||(t[16]=i=>s.value.description=i),class:"form-input w-full resize-none border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"账户用途说明...",rows:"3"},null,512),[[A,s.value.description]])]),e("div",null,[t[159]||(t[159]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"账户类型",-1)),e("div",Tl,[e("label",Il,[y(e("input",{"onUpdate:modelValue":t[17]||(t[17]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"shared"},null,512),[[oe,s.value.accountType]]),t[156]||(t[156]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"共享账户",-1))]),e("label",_l,[y(e("input",{"onUpdate:modelValue":t[18]||(t[18]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"dedicated"},null,512),[[oe,s.value.accountType]]),t[157]||(t[157]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"专属账户",-1))]),e("label",Vl,[y(e("input",{"onUpdate:modelValue":t[19]||(t[19]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"group"},null,512),[[oe,s.value.accountType]]),t[158]||(t[158]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"分组调度",-1))])]),t[160]||(t[160]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 共享账户：供所有API Key使用；专属账户：仅供特定API Key使用；分组调度：加入分组供分组内调度 ",-1))]),s.value.accountType==="group"?(o(),n("div",Sl,[t[162]||(t[162]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"选择分组 *",-1)),e("div",Ml,[e("div",Rl,[e("div",Kl,[m.value.length===0?(o(),n("div",zl," 暂无可用分组 ")):k("",!0),(o(!0),n(ae,null,ue(m.value,i=>(o(),n("label",{key:i.id,class:"flex cursor-pointer items-center gap-2 rounded-md p-2 hover:bg-gray-50 dark:hover:bg-gray-600"},[y(e("input",{"onUpdate:modelValue":t[20]||(t[20]=Y=>s.value.groupIds=Y),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",value:i.id},null,8,Pl),[[$e,s.value.groupIds]]),e("span",Ll,p(i.name)+" ("+p(i.memberCount||0)+" 个成员) ",1)]))),128)),e("div",{class:"border-t pt-2 dark:border-gray-600"},[e("button",{class:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",type:"button",onClick:zt},t[161]||(t[161]=[e("i",{class:"fas fa-plus"},null,-1),$(" 新建分组 ",-1)]))])])]),e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",type:"button",onClick:Ie},[e("i",{class:M(["fas fa-sync-alt",{"animate-spin":Je.value}])},null,2)])])])):k("",!0),s.value.platform==="gemini"?(o(),n("div",jl,[t[163]||(t[163]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"项目 ID (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[21]||(t[21]=i=>s.value.projectId=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如：verdant-wares-464411-k9",type:"text"},null,512),[[A,s.value.projectId]]),t[164]||(t[164]=e("div",{class:"mt-2 rounded-lg border border-yellow-200 bg-yellow-50 p-3"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-info-circle mt-0.5 text-yellow-600"}),e("div",{class:"text-xs text-yellow-700"},[e("p",{class:"mb-1 font-medium"},"Google Cloud/Workspace 账号需要提供项目 ID"),e("p",null," 某些 Google 账号（特别是绑定了 Google Cloud 的账号）会被识别为 Workspace 账号，需要提供额外的项目 ID。 "),e("div",{class:"mt-2 rounded border border-yellow-300 bg-white p-2"},[e("p",{class:"mb-1 font-medium"},"如何获取项目 ID："),e("ol",{class:"ml-2 list-inside list-decimal space-y-1"},[e("li",null,[$(" 访问 "),e("a",{class:"font-medium text-blue-600 hover:underline",href:"https://console.cloud.google.com/welcome",target:"_blank"},"Google Cloud Console")]),e("li",null,[$(" 复制"),e("span",{class:"font-semibold text-red-600"},"项目 ID（Project ID）"),$("，通常是字符串格式 ")]),e("li",{class:"text-red-600"}," ⚠️ 注意：要复制项目 ID（Project ID），不要复制项目编号（Project Number）！ ")])]),e("p",{class:"mt-2"},[e("strong",null,"提示："),$("如果您的账号是普通个人账号（未绑定 Google Cloud），请留空此字段。 ")])])])],-1))])):k("",!0),s.value.platform==="bedrock"&&!j.value?(o(),n("div",Ol,[e("div",null,[t[165]||(t[165]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"AWS 访问密钥 ID *",-1)),y(e("input",{"onUpdate:modelValue":t[22]||(t[22]=i=>s.value.accessKeyId=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.accessKeyId}]),placeholder:"请输入 AWS Access Key ID",required:"",type:"text"},null,2),[[A,s.value.accessKeyId]]),T.value.accessKeyId?(o(),n("p",Fl,p(T.value.accessKeyId),1)):k("",!0)]),e("div",null,[t[166]||(t[166]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"AWS 秘密访问密钥 *",-1)),y(e("input",{"onUpdate:modelValue":t[23]||(t[23]=i=>s.value.secretAccessKey=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.secretAccessKey}]),placeholder:"请输入 AWS Secret Access Key",required:"",type:"password"},null,2),[[A,s.value.secretAccessKey]]),T.value.secretAccessKey?(o(),n("p",Dl,p(T.value.secretAccessKey),1)):k("",!0)]),e("div",null,[t[167]||(t[167]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"AWS 区域 *",-1)),y(e("input",{"onUpdate:modelValue":t[24]||(t[24]=i=>s.value.region=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.region}]),placeholder:"例如：us-east-1",required:"",type:"text"},null,2),[[A,s.value.region]]),T.value.region?(o(),n("p",Nl,p(T.value.region),1)):k("",!0),t[168]||(t[168]=e("div",{class:"mt-2 rounded-lg border border-blue-200 bg-blue-50 p-3"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-info-circle mt-0.5 text-blue-600"}),e("div",{class:"text-xs text-blue-700"},[e("p",{class:"mb-1 font-medium"},"常用 AWS 区域参考："),e("div",{class:"grid grid-cols-2 gap-1 text-xs"},[e("span",null,"• us-east-1 (美国东部)"),e("span",null,"• us-west-2 (美国西部)"),e("span",null,"• eu-west-1 (欧洲爱尔兰)"),e("span",null,"• ap-southeast-1 (新加坡)"),e("span",null,"• ap-northeast-1 (东京)"),e("span",null,"• eu-central-1 (法兰克福)")]),e("p",{class:"mt-2 text-blue-600"},"💡 请输入完整的区域代码，如 us-east-1")])])],-1))]),e("div",null,[t[169]||(t[169]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"会话令牌 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[25]||(t[25]=i=>s.value.sessionToken=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"如果使用临时凭证，请输入会话令牌",type:"password"},null,512),[[A,s.value.sessionToken]]),t[170]||(t[170]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 仅在使用临时 AWS 凭证时需要填写 ",-1))]),e("div",null,[t[171]||(t[171]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"默认主模型 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[26]||(t[26]=i=>s.value.defaultModel=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如：us.anthropic.claude-sonnet-4-20250514-v1:0",type:"text"},null,512),[[A,s.value.defaultModel]]),t[172]||(t[172]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 留空将使用系统默认模型。支持 inference profile ID 或 ARN ",-1)),t[173]||(t[173]=e("div",{class:"mt-2 rounded-lg border border-amber-200 bg-amber-50 p-3"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-info-circle mt-0.5 text-amber-600"}),e("div",{class:"text-xs text-amber-700"},[e("p",{class:"mb-1 font-medium"},"Bedrock 模型配置说明："),e("ul",{class:"list-inside list-disc space-y-1 text-xs"},[e("li",null,"支持 Inference Profile ID（推荐）"),e("li",null,"支持 Application Inference Profile ARN"),e("li",null,"常用模型：us.anthropic.claude-sonnet-4-20250514-v1:0"),e("li",null,"留空将使用系统配置的默认模型")])])])],-1))]),e("div",null,[t[174]||(t[174]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"小快速模型 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[27]||(t[27]=i=>s.value.smallFastModel=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如：us.anthropic.claude-3-5-haiku-20241022-v1:0",type:"text"},null,512),[[A,s.value.smallFastModel]]),t[175]||(t[175]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 用于快速响应的轻量级模型，留空将使用系统默认 ",-1))])])):k("",!0),s.value.platform==="azure_openai"&&!j.value?(o(),n("div",El,[e("div",null,[t[176]||(t[176]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Azure Endpoint *",-1)),y(e("input",{"onUpdate:modelValue":t[28]||(t[28]=i=>s.value.azureEndpoint=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.azureEndpoint}]),placeholder:"https://your-resource.openai.azure.com",required:"",type:"url"},null,2),[[A,s.value.azureEndpoint]]),T.value.azureEndpoint?(o(),n("p",ql,p(T.value.azureEndpoint),1)):k("",!0),t[177]||(t[177]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Azure OpenAI 资源的终结点 URL，格式：https://your-resource.openai.azure.com ",-1))]),e("div",null,[t[178]||(t[178]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API 版本",-1)),y(e("input",{"onUpdate:modelValue":t[29]||(t[29]=i=>s.value.apiVersion=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"2024-02-01",type:"text"},null,512),[[A,s.value.apiVersion]]),t[179]||(t[179]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Azure OpenAI API 版本，默认使用最新稳定版本 2024-02-01 ",-1))]),e("div",null,[t[180]||(t[180]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"部署名称 *",-1)),y(e("input",{"onUpdate:modelValue":t[30]||(t[30]=i=>s.value.deploymentName=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.deploymentName}]),placeholder:"gpt-4",required:"",type:"text"},null,2),[[A,s.value.deploymentName]]),T.value.deploymentName?(o(),n("p",Wl,p(T.value.deploymentName),1)):k("",!0),t[181]||(t[181]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 在 Azure OpenAI Studio 中创建的部署名称 ",-1))]),e("div",null,[t[182]||(t[182]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API Key *",-1)),y(e("input",{"onUpdate:modelValue":t[31]||(t[31]=i=>s.value.apiKey=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.apiKey}]),placeholder:"请输入 Azure OpenAI API Key",required:"",type:"password"},null,2),[[A,s.value.apiKey]]),T.value.apiKey?(o(),n("p",Gl,p(T.value.apiKey),1)):k("",!0),t[183]||(t[183]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 从 Azure 门户获取的 API 密钥 ",-1))]),e("div",null,[t[184]||(t[184]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"支持的模型",-1)),e("div",Bl,[(o(),n(ae,null,ue(["gpt-4","gpt-4-turbo","gpt-4o","gpt-4o-mini","gpt-5","gpt-5-mini","gpt-35-turbo","gpt-35-turbo-16k","codex-mini"],i=>e("label",{key:i,class:"flex cursor-pointer items-center"},[y(e("input",{"onUpdate:modelValue":t[32]||(t[32]=Y=>s.value.supportedModels=Y),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",value:i},null,8,Ql),[[$e,s.value.supportedModels]]),e("span",Hl,p(i),1)])),64))]),t[185]||(t[185]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 选择此部署支持的模型类型 ",-1))])])):k("",!0),s.value.platform==="bedrock"&&!j.value?(o(),n("div",Jl,[e("div",null,[t[190]||(t[190]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流机制",-1)),e("div",Yl,[e("label",Zl,[y(e("input",{"onUpdate:modelValue":t[33]||(t[33]=i=>s.value.enableRateLimit=i),class:"mr-2 rounded border-gray-300 text-blue-600 focus:border-blue-500 focus:ring focus:ring-blue-200 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.enableRateLimit]]),t[186]||(t[186]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"启用限流机制",-1))]),t[187]||(t[187]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 启用后，当账号返回429错误时将暂停调度一段时间 ",-1))]),s.value.enableRateLimit?(o(),n("div",Xl,[t[188]||(t[188]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流时间 (分钟)",-1)),y(e("input",{"onUpdate:modelValue":t[34]||(t[34]=i=>s.value.rateLimitDuration=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"默认60分钟",type:"number"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]]),t[189]||(t[189]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 账号被限流后暂停调度的时间（分钟） ",-1))])):k("",!0)])])):k("",!0),(s.value.platform==="claude-console"||s.value.platform==="ccr")&&!j.value?(o(),n("div",eo,[e("div",null,[t[191]||(t[191]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API URL *",-1)),y(e("input",{"onUpdate:modelValue":t[35]||(t[35]=i=>s.value.apiUrl=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.apiUrl}]),placeholder:"例如：https://api.example.com",required:"",type:"text"},null,2),[[A,s.value.apiUrl]]),T.value.apiUrl?(o(),n("p",to,p(T.value.apiUrl),1)):k("",!0)]),e("div",null,[t[192]||(t[192]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API Key *",-1)),y(e("input",{"onUpdate:modelValue":t[36]||(t[36]=i=>s.value.apiKey=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.apiKey}]),placeholder:"请输入API Key",required:"",type:"password"},null,2),[[A,s.value.apiKey]]),T.value.apiKey?(o(),n("p",so,p(T.value.apiKey),1)):k("",!0)]),e("div",ao,[e("div",null,[t[193]||(t[193]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 每日额度限制 ($) ",-1)),y(e("input",{"onUpdate:modelValue":t[37]||(t[37]=i=>s.value.dailyQuota=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:"0",placeholder:"0 表示不限制",step:"0.01",type:"number"},null,512),[[A,s.value.dailyQuota,void 0,{number:!0}]]),t[194]||(t[194]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 设置每日使用额度，0 表示不限制 ",-1))]),e("div",null,[t[195]||(t[195]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 额度重置时间 ",-1)),y(e("input",{"onUpdate:modelValue":t[38]||(t[38]=i=>s.value.quotaResetTime=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"00:00",type:"time"},null,512),[[A,s.value.quotaResetTime]]),t[196]||(t[196]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 每日自动重置额度的时间 ",-1))])]),e("div",null,[t[200]||(t[200]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"模型映射表 (可选)",-1)),t[201]||(t[201]=e("div",{class:"mb-3 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/30"},[e("p",{class:"text-xs text-blue-700 dark:text-blue-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 留空表示支持所有模型且不修改请求。配置映射后，左侧模型会被识别为支持的模型，右侧是实际发送的模型。 ")])],-1)),e("div",ro,[(o(!0),n(ae,null,ue(Te.value,(i,Y)=>(o(),n("div",{key:Y,class:"flex items-center gap-2"},[y(e("input",{"onUpdate:modelValue":Q=>i.from=Q,class:"form-input flex-1 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"原始模型名称",type:"text"},null,8,lo),[[A,i.from]]),t[198]||(t[198]=e("i",{class:"fas fa-arrow-right text-gray-400 dark:text-gray-500"},null,-1)),y(e("input",{"onUpdate:modelValue":Q=>i.to=Q,class:"form-input flex-1 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"映射后的模型名称",type:"text"},null,8,oo),[[A,i.to]]),e("button",{class:"rounded-lg p-2 text-red-500 transition-colors hover:bg-red-50 dark:hover:bg-red-900/20",type:"button",onClick:Q=>Xe(Y)},t[197]||(t[197]=[e("i",{class:"fas fa-trash"},null,-1)]),8,no)]))),128))]),e("button",{class:"w-full rounded-lg border-2 border-dashed border-gray-300 px-4 py-2 text-gray-600 transition-colors hover:border-gray-400 hover:text-gray-700 dark:border-gray-600 dark:text-gray-400 dark:hover:border-gray-500 dark:hover:text-gray-300",type:"button",onClick:Pt},t[199]||(t[199]=[e("i",{class:"fas fa-plus mr-2"},null,-1),$(" 添加模型映射 ",-1)])),e("div",io,[e("button",{class:"rounded-lg bg-blue-100 px-3 py-1 text-xs text-blue-700 transition-colors hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",type:"button",onClick:t[39]||(t[39]=i=>_e("claude-sonnet-4-20250514","claude-sonnet-4-20250514"))}," + Sonnet 4 "),e("button",{class:"rounded-lg bg-purple-100 px-3 py-1 text-xs text-purple-700 transition-colors hover:bg-purple-200 dark:bg-purple-900/30 dark:text-purple-400 dark:hover:bg-purple-900/50",type:"button",onClick:t[40]||(t[40]=i=>_e("claude-opus-4-1-20250805","claude-opus-4-1-20250805"))}," + Opus 4.1 "),e("button",{class:"rounded-lg bg-green-100 px-3 py-1 text-xs text-green-700 transition-colors hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:hover:bg-green-900/50",type:"button",onClick:t[41]||(t[41]=i=>_e("claude-3-5-haiku-20241022","claude-3-5-haiku-20241022"))}," + Haiku 3.5 "),e("button",{class:"rounded-lg bg-orange-100 px-3 py-1 text-xs text-orange-700 transition-colors hover:bg-orange-200 dark:bg-orange-900/30 dark:text-orange-400 dark:hover:bg-orange-900/50",type:"button",onClick:t[42]||(t[42]=i=>_e("claude-opus-4-1-20250805","claude-sonnet-4-20250514"))}," + Opus 4.1 → Sonnet 4 ")]),t[202]||(t[202]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 留空表示支持所有模型。如果指定模型，请求中的模型不在列表内将不会调度到此账号 ",-1))]),e("div",null,[t[203]||(t[203]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"自定义 User-Agent (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[43]||(t[43]=i=>s.value.userAgent=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"留空则透传客户端 User-Agent",type:"text"},null,512),[[A,s.value.userAgent]]),t[204]||(t[204]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 留空时将自动使用客户端的 User-Agent，仅在需要固定特定 UA 时填写 ",-1))]),e("div",null,[t[209]||(t[209]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流机制",-1)),e("div",uo,[e("label",po,[y(e("input",{"onUpdate:modelValue":t[44]||(t[44]=i=>s.value.enableRateLimit=i),class:"mr-2 rounded border-gray-300 text-blue-600 focus:border-blue-500 focus:ring focus:ring-blue-200 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.enableRateLimit]]),t[205]||(t[205]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"启用限流机制",-1))]),t[206]||(t[206]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 启用后，当账号返回429错误时将暂停调度一段时间 ",-1))]),s.value.enableRateLimit?(o(),n("div",go,[t[207]||(t[207]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流时间 (分钟)",-1)),y(e("input",{"onUpdate:modelValue":t[45]||(t[45]=i=>s.value.rateLimitDuration=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",min:"1",placeholder:"默认60分钟",type:"number"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]]),t[208]||(t[208]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 账号被限流后暂停调度的时间（分钟） ",-1))])):k("",!0)])])):k("",!0),s.value.platform==="openai-responses"&&!j.value?(o(),n("div",mo,[e("div",null,[t[210]||(t[210]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API 基础地址 *",-1)),y(e("input",{"onUpdate:modelValue":t[46]||(t[46]=i=>s.value.baseApi=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"https://api.example.com/v1",required:"",type:"url"},null,512),[[A,s.value.baseApi]]),t[211]||(t[211]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 第三方 OpenAI 兼容 API 的基础地址，不要包含具体路径 ",-1))]),e("div",null,[t[212]||(t[212]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API 密钥 *",-1)),e("div",yo,[y(e("input",{"onUpdate:modelValue":t[47]||(t[47]=i=>s.value.apiKey=i),class:"form-input w-full border-gray-300 pr-10 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"sk-xxxxxxxxxxxx",required:"",type:ee.value?"text":"password"},null,8,xo),[[as,s.value.apiKey]]),e("button",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400",type:"button",onClick:t[48]||(t[48]=i=>ee.value=!ee.value)},[e("i",{class:M(ee.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),t[213]||(t[213]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 第三方服务提供的 API 密钥 ",-1))]),e("div",null,[t[214]||(t[214]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"自定义 User-Agent (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[49]||(t[49]=i=>s.value.userAgent=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"留空则透传原始请求的 User-Agent",type:"text"},null,512),[[A,s.value.userAgent]]),t[215]||(t[215]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 可选项。如果设置，所有请求将使用此 User-Agent；否则透传客户端的 User-Agent ",-1))]),y(e("input",{"onUpdate:modelValue":t[50]||(t[50]=i=>s.value.rateLimitDuration=i),type:"hidden",value:"60"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]])])):k("",!0),s.value.platform==="claude"?(o(),n("div",fo,[t[218]||(t[218]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"订阅类型",-1)),e("div",bo,[e("label",co,[y(e("input",{"onUpdate:modelValue":t[51]||(t[51]=i=>s.value.subscriptionType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude_max"},null,512),[[oe,s.value.subscriptionType]]),t[216]||(t[216]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Claude Max",-1))]),e("label",vo,[y(e("input",{"onUpdate:modelValue":t[52]||(t[52]=i=>s.value.subscriptionType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude_pro"},null,512),[[oe,s.value.subscriptionType]]),t[217]||(t[217]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Claude Pro",-1))])]),t[219]||(t[219]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" Pro 账号不支持 Claude Opus 4 模型 ")],-1))])):k("",!0),s.value.platform==="claude"?(o(),n("div",ko,[e("label",ho,[y(e("input",{"onUpdate:modelValue":t[53]||(t[53]=i=>s.value.autoStopOnWarning=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.autoStopOnWarning]]),t[220]||(t[220]=e("div",{class:"ml-3"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 5小时使用量接近限制时自动停止调度 "),e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 当系统检测到账户接近5小时使用限制时，自动暂停调度该账户。进入新的时间窗口后会自动恢复调度。 ")],-1))])])):k("",!0),s.value.platform==="claude"?(o(),n("div",wo,[e("label",$o,[y(e("input",{"onUpdate:modelValue":t[54]||(t[54]=i=>s.value.useUnifiedUserAgent=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.useUnifiedUserAgent]]),e("div",Ao,[t[222]||(t[222]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 使用统一 Claude Code 版本 ",-1)),t[223]||(t[223]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 开启后将使用从真实 Claude Code 客户端捕获的统一 User-Agent，提高兼容性 ",-1)),c.value?(o(),n("div",Co,[e("div",Uo,[e("p",To," 💡 当前统一版本："+p(c.value),1),e("button",{class:"ml-2 text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",disabled:U.value,type:"button",onClick:jt},[U.value?(o(),n("div",Vo)):(o(),n("i",_o)),$(" "+p(U.value?"清除中...":"清除缓存"),1)],8,Io)])])):(o(),n("div",So,t[221]||(t[221]=[e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," ⏳ 等待从 Claude Code 客户端捕获 User-Agent ",-1),e("p",{class:"mt-1 text-xs text-gray-400 dark:text-gray-500"}," 💡 提示：如果长时间未能捕获，请确认有 Claude Code 客户端正在使用此账户， 或联系开发者检查 User-Agent 格式是否发生变化 ",-1)])))])])])):k("",!0),s.value.platform==="claude"?(o(),n("div",Mo,[e("label",Ro,[y(e("input",{"onUpdate:modelValue":t[55]||(t[55]=i=>s.value.useUnifiedClientId=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",onChange:qe},null,544),[[$e,s.value.useUnifiedClientId]]),e("div",Ko,[t[227]||(t[227]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 使用统一的客户端标识 ",-1)),t[228]||(t[228]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 开启后将使用固定的客户端标识，使所有请求看起来来自同一个客户端，减少特征 ",-1)),s.value.useUnifiedClientId?(o(),n("div",zo,[e("div",Po,[e("div",{class:"mb-2 flex items-center justify-between"},[t[225]||(t[225]=e("span",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"},"客户端标识 ID",-1)),e("button",{class:"rounded-md bg-blue-100 px-2.5 py-1 text-xs font-medium text-blue-700 transition-colors hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",type:"button",onClick:Ee},t[224]||(t[224]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$(" 重新生成 ",-1)]))]),e("div",Lo,[e("code",jo,[e("span",Oo,p(s.value.unifiedClientId.substring(0,8)),1),e("span",Fo,p(s.value.unifiedClientId.substring(8,56)),1),e("span",Do,p(s.value.unifiedClientId.substring(56)),1)])]),t[226]||(t[226]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1 text-blue-500"}),$(" 此ID将替换请求中的user_id客户端部分，保留session部分用于粘性会话 ")],-1))])])):k("",!0)])])])):k("",!0),e("div",null,[t[229]||(t[229]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"调度优先级 (1-100)",-1)),y(e("input",{"onUpdate:modelValue":t[56]||(t[56]=i=>s.value.priority=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",max:"100",min:"1",placeholder:"数字越小优先级越高，默认50",type:"number"},null,512),[[A,s.value.priority,void 0,{number:!0}]]),t[230]||(t[230]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 数字越小优先级越高，建议范围：1-100 ",-1))]),s.value.addType==="manual"&&s.value.platform!=="claude-console"&&s.value.platform!=="ccr"&&s.value.platform!=="bedrock"&&s.value.platform!=="azure_openai"&&s.value.platform!=="openai-responses"?(o(),n("div",No,[e("div",Eo,[t[236]||(t[236]=e("div",{class:"mt-1 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-blue-500"},[e("i",{class:"fas fa-info text-sm text-white"})],-1)),e("div",null,[t[234]||(t[234]=e("h5",{class:"mb-2 font-semibold text-blue-900 dark:text-blue-300"}," 手动输入 Token ",-1)),s.value.platform==="claude"?(o(),n("p",qo," 请输入有效的 Claude Access Token。如果您有 Refresh Token，建议也一并填写以支持自动刷新。 ")):s.value.platform==="gemini"?(o(),n("p",Wo," 请输入有效的 Gemini Access Token。如果您有 Refresh Token，建议也一并填写以支持自动刷新。 ")):s.value.platform==="openai"?(o(),n("p",Go," 请输入有效的 OpenAI Access Token。如果您有 Refresh Token，建议也一并填写以支持自动刷新。 ")):k("",!0),e("div",Bo,[t[233]||(t[233]=e("p",{class:"mb-1 text-sm font-medium text-blue-900 dark:text-blue-300"},[e("i",{class:"fas fa-folder-open mr-1"}),$(" 获取 Access Token 的方法： ")],-1)),s.value.platform==="claude"?(o(),n("p",Qo,t[231]||(t[231]=[$(" 请从已登录 Claude Code 的机器上获取 ",-1),e("code",{class:"rounded bg-blue-100 px-1 py-0.5 font-mono dark:bg-blue-900/50"},"~/.claude/.credentials.json",-1),$(" 文件中的凭证， 请勿使用 Claude 官网 API Keys 页面的密钥。 ",-1)]))):s.value.platform==="gemini"?(o(),n("p",Ho,t[232]||(t[232]=[$(" 请从已登录 Gemini CLI 的机器上获取 ",-1),e("code",{class:"rounded bg-blue-100 px-1 py-0.5 font-mono dark:bg-blue-900/50"},"~/.config/gemini/credentials.json",-1),$(" 文件中的凭证。 ",-1)]))):s.value.platform==="openai"?(o(),n("p",Jo," 请从已登录 OpenAI 账户的机器上获取认证凭证， 或通过 OAuth 授权流程获取 Access Token。 ")):k("",!0)]),t[235]||(t[235]=e("p",{class:"text-xs text-blue-600 dark:text-blue-400"}," 💡 如果未填写 Refresh Token，Token 过期后需要手动更新。 ",-1))])]),s.value.platform==="openai"?(o(),n("div",Yo,[t[237]||(t[237]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Access Token (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":t[57]||(t[57]=i=>s.value.accessToken=i),class:"form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"可选：如果不填写，系统会自动通过 Refresh Token 获取...",rows:"4"},null,512),[[A,s.value.accessToken]]),t[238]||(t[238]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" Access Token 可选填。如果不提供，系统会通过 Refresh Token 自动获取。 ")],-1))])):(o(),n("div",Zo,[t[239]||(t[239]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Access Token *",-1)),y(e("textarea",{"onUpdate:modelValue":t[58]||(t[58]=i=>s.value.accessToken=i),class:M(["form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.accessToken}]),placeholder:"请输入 Access Token...",required:"",rows:"4"},null,2),[[A,s.value.accessToken]]),T.value.accessToken?(o(),n("p",Xo,p(T.value.accessToken),1)):k("",!0)])),s.value.platform==="openai"?(o(),n("div",en,[t[240]||(t[240]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Refresh Token *",-1)),y(e("textarea",{"onUpdate:modelValue":t[59]||(t[59]=i=>s.value.refreshToken=i),class:M(["form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.refreshToken}]),placeholder:"请输入 Refresh Token（必填）...",required:"",rows:"4"},null,2),[[A,s.value.refreshToken]]),T.value.refreshToken?(o(),n("p",tn,p(T.value.refreshToken),1)):k("",!0),t[241]||(t[241]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 系统将使用 Refresh Token 自动获取 Access Token 和用户信息 ")],-1))])):(o(),n("div",sn,[t[242]||(t[242]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Refresh Token (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":t[60]||(t[60]=i=>s.value.refreshToken=i),class:"form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"请输入 Refresh Token...",rows:"4"},null,512),[[A,s.value.refreshToken]])]))])):k("",!0),Fe(rs,{modelValue:s.value.proxy,"onUpdate:modelValue":t[61]||(t[61]=i=>s.value.proxy=i)},null,8,["modelValue"]),e("div",an,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:t[62]||(t[62]=i=>u.$emit("close"))}," 取消 "),(s.value.addType==="oauth"||s.value.addType==="setup-token")&&s.value.platform!=="claude-console"&&s.value.platform!=="ccr"&&s.value.platform!=="bedrock"&&s.value.platform!=="azure_openai"&&s.value.platform!=="openai-responses"?(o(),n("button",{key:0,class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:B.value,type:"button",onClick:Ce}," 下一步 ",8,rn)):(o(),n("button",{key:1,class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:B.value,type:"button",onClick:yt},[B.value?(o(),n("div",on)):k("",!0),$(" "+p(B.value?"创建中...":"创建"),1)],8,ln))])])])):k("",!0),W.value===2&&s.value.addType==="oauth"?(o(),Ne(or,{key:2,platform:s.value.platform,proxy:s.value.proxy,onBack:t[63]||(t[63]=i=>W.value=1),onSuccess:it},null,8,["platform","proxy"])):k("",!0),W.value===2&&s.value.addType==="setup-token"?(o(),n("div",nn,[s.value.platform==="claude"?(o(),n("div",dn,[e("div",un,[e("div",pn,[t[254]||(t[254]=e("div",{class:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-blue-500"},[e("i",{class:"fas fa-key text-white"})],-1)),e("div",gn,[t[252]||(t[252]=e("h4",{class:"mb-3 font-semibold text-blue-900 dark:text-blue-200"}," Claude Setup Token 授权 ",-1)),t[253]||(t[253]=e("p",{class:"mb-4 text-sm text-blue-800 dark:text-blue-300"}," 请按照以下步骤通过 Setup Token 完成 Claude 账户的授权： ",-1)),e("div",mn,[e("div",yn,[e("div",xn,[t[245]||(t[245]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"}," 1 ",-1)),e("div",fn,[t[244]||(t[244]=e("p",{class:"mb-2 font-medium text-blue-900 dark:text-blue-200"}," 点击下方按钮生成授权链接 ",-1)),d.value?(o(),n("div",kn,[e("div",hn,[e("input",{class:"form-input flex-1 bg-gray-50 font-mono text-xs dark:bg-gray-700",readonly:"",type:"text",value:d.value},null,8,wn),e("button",{class:"rounded-lg bg-gray-100 px-3 py-2 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600",title:"复制链接",onClick:Kt},[e("i",{class:M(P.value?"fas fa-check text-green-500":"fas fa-copy")},null,2)])]),e("button",{class:"text-xs text-blue-600 hover:text-blue-700",onClick:gt},t[243]||(t[243]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$("重新生成 ",-1)]))])):(o(),n("button",{key:0,class:"btn btn-primary px-4 py-2 text-sm",disabled:se.value,onClick:nt},[se.value?(o(),n("div",vn)):(o(),n("i",cn)),$(" "+p(se.value?"生成中...":"生成 Setup Token 授权链接"),1)],8,bn))])])]),t[251]||(t[251]=e("div",{class:"rounded-lg border border-blue-300 bg-white/80 p-4 dark:border-blue-600 dark:bg-gray-800/80"},[e("div",{class:"flex items-start gap-3"},[e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"}," 2 "),e("div",{class:"flex-1"},[e("p",{class:"mb-2 font-medium text-blue-900 dark:text-blue-200"}," 在浏览器中打开链接并完成授权 "),e("p",{class:"mb-2 text-sm text-blue-700 dark:text-blue-300"}," 请在新标签页中打开授权链接，登录您的 Claude 账户并授权 Claude Code。 "),e("div",{class:"rounded border border-yellow-300 bg-yellow-50 p-3 dark:border-yellow-700 dark:bg-yellow-900/30"},[e("p",{class:"text-xs text-yellow-800 dark:text-yellow-300"},[e("i",{class:"fas fa-exclamation-triangle mr-1"}),e("strong",null,"注意："),$("如果您设置了代理，请确保浏览器也使用相同的代理访问授权页面。 ")])])])])],-1)),e("div",$n,[e("div",An,[t[250]||(t[250]=e("div",{class:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-600 text-xs font-bold text-white"}," 3 ",-1)),e("div",Cn,[t[248]||(t[248]=e("p",{class:"mb-2 font-medium text-blue-900 dark:text-blue-200"}," 输入 Authorization Code ",-1)),t[249]||(t[249]=e("p",{class:"mb-3 text-sm text-blue-700 dark:text-blue-300"}," 授权完成后，从返回页面复制 Authorization Code，并粘贴到下方输入框： ",-1)),e("div",Un,[e("div",null,[t[246]||(t[246]=e("label",{class:"mb-2 block text-sm font-semibold text-gray-700 dark:text-gray-300"},[e("i",{class:"fas fa-key mr-2 text-blue-500"}),$("Authorization Code ")],-1)),y(e("textarea",{"onUpdate:modelValue":t[64]||(t[64]=i=>f.value=i),class:"form-input w-full resize-none border-gray-300 font-mono text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"粘贴从Claude Code授权页面获取的Authorization Code...",rows:"3"},null,512),[[A,f.value]])]),t[247]||(t[247]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 请粘贴从Claude Code授权页面复制的Authorization Code ")],-1))])])])])])])])])])):k("",!0),e("div",Tn,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:t[65]||(t[65]=i=>W.value=1)}," 上一步 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:!Be.value||F.value,type:"button",onClick:mt},[F.value?(o(),n("div",_n)):k("",!0),$(" "+p(F.value?"验证中...":"完成授权"),1)],8,In)])])):k("",!0),j.value?(o(),n("div",Vn,[e("div",null,[t[255]||(t[255]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"账户名称",-1)),y(e("input",{"onUpdate:modelValue":t[66]||(t[66]=i=>s.value.name=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"为账户设置一个易识别的名称",required:"",type:"text"},null,512),[[A,s.value.name]])]),e("div",null,[t[256]||(t[256]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"描述 (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":t[67]||(t[67]=i=>s.value.description=i),class:"form-input w-full resize-none border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"账户用途说明...",rows:"3"},null,512),[[A,s.value.description]])]),e("div",null,[t[260]||(t[260]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"账户类型",-1)),e("div",Sn,[e("label",Mn,[y(e("input",{"onUpdate:modelValue":t[68]||(t[68]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"shared"},null,512),[[oe,s.value.accountType]]),t[257]||(t[257]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"共享账户",-1))]),e("label",Rn,[y(e("input",{"onUpdate:modelValue":t[69]||(t[69]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"dedicated"},null,512),[[oe,s.value.accountType]]),t[258]||(t[258]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"专属账户",-1))]),e("label",Kn,[y(e("input",{"onUpdate:modelValue":t[70]||(t[70]=i=>s.value.accountType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"group"},null,512),[[oe,s.value.accountType]]),t[259]||(t[259]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"分组调度",-1))])]),t[261]||(t[261]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 共享账户：供所有API Key使用；专属账户：仅供特定API Key使用；分组调度：加入分组供分组内调度 ",-1))]),s.value.accountType==="group"?(o(),n("div",zn,[t[263]||(t[263]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"选择分组 *",-1)),e("div",Pn,[e("div",Ln,[e("div",jn,[m.value.length===0?(o(),n("div",On," 暂无可用分组 ")):k("",!0),(o(!0),n(ae,null,ue(m.value,i=>(o(),n("label",{key:i.id,class:"flex cursor-pointer items-center gap-2 rounded-md p-2 hover:bg-gray-50 dark:hover:bg-gray-600"},[y(e("input",{"onUpdate:modelValue":t[71]||(t[71]=Y=>s.value.groupIds=Y),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",value:i.id},null,8,Fn),[[$e,s.value.groupIds]]),e("span",Dn,p(i.name)+" ("+p(i.memberCount||0)+" 个成员) ",1)]))),128)),e("div",{class:"border-t pt-2 dark:border-gray-600"},[e("button",{class:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",type:"button",onClick:zt},t[262]||(t[262]=[e("i",{class:"fas fa-plus"},null,-1),$(" 新建分组 ",-1)]))])])]),e("button",{class:"rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",type:"button",onClick:Ie},[e("i",{class:M(["fas fa-sync-alt",{"animate-spin":Je.value}])},null,2)])])])):k("",!0),s.value.platform==="gemini"?(o(),n("div",Nn,[t[264]||(t[264]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"项目 ID (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[72]||(t[72]=i=>s.value.projectId=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"例如：verdant-wares-464411-k9",type:"text"},null,512),[[A,s.value.projectId]]),t[265]||(t[265]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," Google Cloud/Workspace 账号可能需要提供项目 ID ",-1))])):k("",!0),s.value.platform==="claude"?(o(),n("div",En,[t[268]||(t[268]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"订阅类型",-1)),e("div",qn,[e("label",Wn,[y(e("input",{"onUpdate:modelValue":t[73]||(t[73]=i=>s.value.subscriptionType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude_max"},null,512),[[oe,s.value.subscriptionType]]),t[266]||(t[266]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Claude Max",-1))]),e("label",Gn,[y(e("input",{"onUpdate:modelValue":t[74]||(t[74]=i=>s.value.subscriptionType=i),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"radio",value:"claude_pro"},null,512),[[oe,s.value.subscriptionType]]),t[267]||(t[267]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"Claude Pro",-1))])]),t[269]||(t[269]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" Pro 账号不支持 Claude Opus 4 模型 ")],-1))])):k("",!0),s.value.platform==="claude"?(o(),n("div",Bn,[e("label",Qn,[y(e("input",{"onUpdate:modelValue":t[75]||(t[75]=i=>s.value.autoStopOnWarning=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.autoStopOnWarning]]),t[270]||(t[270]=e("div",{class:"ml-3"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 5小时使用量接近限制时自动停止调度 "),e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 当系统检测到账户接近5小时使用限制时，自动暂停调度该账户。进入新的时间窗口后会自动恢复调度。 ")],-1))])])):k("",!0),s.value.platform==="claude"?(o(),n("div",Hn,[e("label",Jn,[y(e("input",{"onUpdate:modelValue":t[76]||(t[76]=i=>s.value.useUnifiedUserAgent=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,s.value.useUnifiedUserAgent]]),e("div",Yn,[t[272]||(t[272]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 使用统一 Claude Code 版本 ",-1)),t[273]||(t[273]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 开启后将使用从真实 Claude Code 客户端捕获的统一 User-Agent，提高兼容性 ",-1)),c.value?(o(),n("div",Zn,[e("div",Xn,[e("p",ei," 💡 当前统一版本："+p(c.value),1),e("button",{class:"ml-2 text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",disabled:U.value,type:"button",onClick:jt},[U.value?(o(),n("div",ai)):(o(),n("i",si)),$(" "+p(U.value?"清除中...":"清除缓存"),1)],8,ti)])])):(o(),n("div",ri,t[271]||(t[271]=[e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," ⏳ 等待从 Claude Code 客户端捕获 User-Agent ",-1),e("p",{class:"mt-1 text-xs text-gray-400 dark:text-gray-500"}," 💡 提示：如果长时间未能捕获，请确认有 Claude Code 客户端正在使用此账户， 或联系开发者检查 User-Agent 格式是否发生变化 ",-1)])))])])])):k("",!0),s.value.platform==="claude"?(o(),n("div",li,[e("label",oi,[y(e("input",{"onUpdate:modelValue":t[77]||(t[77]=i=>s.value.useUnifiedClientId=i),class:"mt-1 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",onChange:qe},null,544),[[$e,s.value.useUnifiedClientId]]),e("div",ni,[t[277]||(t[277]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 使用统一的客户端标识 ",-1)),t[278]||(t[278]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 开启后将使用固定的客户端标识，使所有请求看起来来自同一个客户端，减少特征 ",-1)),s.value.useUnifiedClientId?(o(),n("div",ii,[e("div",di,[e("div",{class:"mb-2 flex items-center justify-between"},[t[275]||(t[275]=e("span",{class:"text-xs font-medium text-gray-600 dark:text-gray-400"},"客户端标识 ID",-1)),e("button",{class:"rounded-md bg-blue-100 px-2.5 py-1 text-xs font-medium text-blue-700 transition-colors hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",type:"button",onClick:Ee},t[274]||(t[274]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),$(" 重新生成 ",-1)]))]),e("div",ui,[e("code",pi,[e("span",gi,p(s.value.unifiedClientId.substring(0,8)),1),e("span",mi,p(s.value.unifiedClientId.substring(8,56)),1),e("span",yi,p(s.value.unifiedClientId.substring(56)),1)])]),t[276]||(t[276]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},[e("i",{class:"fas fa-info-circle mr-1 text-blue-500"}),$(" 此ID将替换请求中的user_id客户端部分，保留session部分用于粘性会话 ")],-1))])])):k("",!0)])])])):k("",!0),e("div",null,[t[279]||(t[279]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"调度优先级 (1-100)",-1)),y(e("input",{"onUpdate:modelValue":t[78]||(t[78]=i=>s.value.priority=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",max:"100",min:"1",placeholder:"数字越小优先级越高",type:"number"},null,512),[[A,s.value.priority,void 0,{number:!0}]]),t[280]||(t[280]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 数字越小优先级越高，建议范围：1-100 ",-1))]),s.value.platform==="claude-console"||s.value.platform==="ccr"?(o(),n("div",xi,[e("div",null,[t[281]||(t[281]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"API URL",-1)),y(e("input",{"onUpdate:modelValue":t[79]||(t[79]=i=>s.value.apiUrl=i),class:"form-input w-full",placeholder:"例如：https://api.example.com",required:"",type:"text"},null,512),[[A,s.value.apiUrl]])]),e("div",null,[t[282]||(t[282]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"API Key",-1)),y(e("input",{"onUpdate:modelValue":t[80]||(t[80]=i=>s.value.apiKey=i),class:"form-input w-full",placeholder:"留空表示不更新",type:"password"},null,512),[[A,s.value.apiKey]]),t[283]||(t[283]=e("p",{class:"mt-1 text-xs text-gray-500"},"留空表示不更新 API Key",-1))]),e("div",fi,[e("div",null,[t[284]||(t[284]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 每日额度限制 ($) ",-1)),y(e("input",{"onUpdate:modelValue":t[81]||(t[81]=i=>s.value.dailyQuota=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:"0",placeholder:"0 表示不限制",step:"0.01",type:"number"},null,512),[[A,s.value.dailyQuota,void 0,{number:!0}]]),t[285]||(t[285]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 设置每日使用额度，0 表示不限制 ",-1))]),e("div",null,[t[286]||(t[286]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 额度重置时间 ",-1)),y(e("input",{"onUpdate:modelValue":t[82]||(t[82]=i=>s.value.quotaResetTime=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"00:00",type:"time"},null,512),[[A,s.value.quotaResetTime]]),t[287]||(t[287]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"每日自动重置额度的时间",-1))])]),j.value&&s.value.dailyQuota>0?(o(),n("div",bi,[e("div",ci,[t[288]||(t[288]=e("span",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300"}," 今日使用情况 ",-1)),e("span",vi," $"+p(ot().toFixed(4))+" / $"+p(s.value.dailyQuota.toFixed(2)),1)]),e("div",ki,[e("div",{class:M(["absolute left-0 top-0 h-full rounded-full transition-all",Le.value>=90?"bg-red-500":Le.value>=70?"bg-yellow-500":"bg-green-500"]),style:lt({width:`${Math.min(Le.value,100)}%`})},null,6)]),e("div",hi,[e("span",wi," 剩余: $"+p(Math.max(0,s.value.dailyQuota-ot()).toFixed(2)),1),e("span",$i,p(Le.value.toFixed(1))+"% 已使用 ",1)])])):k("",!0),e("div",null,[t[292]||(t[292]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"模型映射表 (可选)",-1)),t[293]||(t[293]=e("div",{class:"mb-3 rounded-lg bg-blue-50 p-3"},[e("p",{class:"text-xs text-blue-700"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 留空表示支持所有模型且不修改请求。配置映射后，左侧模型会被识别为支持的模型，右侧是实际发送的模型。 ")])],-1)),e("div",Ai,[(o(!0),n(ae,null,ue(Te.value,(i,Y)=>(o(),n("div",{key:Y,class:"flex items-center gap-2"},[y(e("input",{"onUpdate:modelValue":Q=>i.from=Q,class:"form-input flex-1",placeholder:"原始模型名称",type:"text"},null,8,Ci),[[A,i.from]]),t[290]||(t[290]=e("i",{class:"fas fa-arrow-right text-gray-400"},null,-1)),y(e("input",{"onUpdate:modelValue":Q=>i.to=Q,class:"form-input flex-1",placeholder:"映射后的模型名称",type:"text"},null,8,Ui),[[A,i.to]]),e("button",{class:"rounded-lg p-2 text-red-500 transition-colors hover:bg-red-50",type:"button",onClick:Q=>Xe(Y)},t[289]||(t[289]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ti)]))),128))]),e("button",{class:"w-full rounded-lg border-2 border-dashed border-gray-300 px-4 py-2 text-gray-600 transition-colors hover:border-gray-400 hover:text-gray-700",type:"button",onClick:Pt},t[291]||(t[291]=[e("i",{class:"fas fa-plus mr-2"},null,-1),$(" 添加模型映射 ",-1)])),e("div",Ii,[e("button",{class:"rounded-lg bg-blue-100 px-3 py-1 text-xs text-blue-700 transition-colors hover:bg-blue-200",type:"button",onClick:t[83]||(t[83]=i=>_e("claude-sonnet-4-20250514","claude-sonnet-4-20250514"))}," + Sonnet 4 "),e("button",{class:"rounded-lg bg-purple-100 px-3 py-1 text-xs text-purple-700 transition-colors hover:bg-purple-200",type:"button",onClick:t[84]||(t[84]=i=>_e("claude-opus-4-1-20250805","claude-opus-4-1-20250805"))}," + Opus 4.1 "),e("button",{class:"rounded-lg bg-green-100 px-3 py-1 text-xs text-green-700 transition-colors hover:bg-green-200",type:"button",onClick:t[85]||(t[85]=i=>_e("claude-3-5-haiku-20241022","claude-3-5-haiku-20241022"))}," + Haiku 3.5 "),e("button",{class:"rounded-lg bg-orange-100 px-3 py-1 text-xs text-orange-700 transition-colors hover:bg-orange-200",type:"button",onClick:t[86]||(t[86]=i=>_e("claude-opus-4-1-20250805","claude-sonnet-4-20250514"))}," + Opus 4.1 → Sonnet 4 ")]),t[294]||(t[294]=e("p",{class:"mt-1 text-xs text-gray-500"}," 留空表示支持所有模型。如果指定模型，请求中的模型不在列表内将不会调度到此账号 ",-1))]),e("div",null,[t[295]||(t[295]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"自定义 User-Agent (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[87]||(t[87]=i=>s.value.userAgent=i),class:"form-input w-full",placeholder:"留空则透传客户端 User-Agent",type:"text"},null,512),[[A,s.value.userAgent]]),t[296]||(t[296]=e("p",{class:"mt-1 text-xs text-gray-500"}," 留空时将自动使用客户端的 User-Agent，仅在需要固定特定 UA 时填写 ",-1))]),e("div",null,[t[301]||(t[301]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"限流机制",-1)),e("div",_i,[e("label",Vi,[y(e("input",{"onUpdate:modelValue":t[88]||(t[88]=i=>s.value.enableRateLimit=i),class:"mr-2 rounded border-gray-300 text-blue-600 focus:border-blue-500 focus:ring focus:ring-blue-200",type:"checkbox"},null,512),[[$e,s.value.enableRateLimit]]),t[297]||(t[297]=e("span",{class:"text-sm text-gray-700"},"启用限流机制",-1))]),t[298]||(t[298]=e("p",{class:"mt-1 text-xs text-gray-500"}," 启用后，当账号返回429错误时将暂停调度一段时间 ",-1))]),s.value.enableRateLimit?(o(),n("div",Si,[t[299]||(t[299]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"限流时间 (分钟)",-1)),y(e("input",{"onUpdate:modelValue":t[89]||(t[89]=i=>s.value.rateLimitDuration=i),class:"form-input w-full",min:"1",type:"number"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]]),t[300]||(t[300]=e("p",{class:"mt-1 text-xs text-gray-500"},"账号被限流后暂停调度的时间（分钟）",-1))])):k("",!0)])])):k("",!0),s.value.platform==="openai-responses"?(o(),n("div",Mi,[e("div",null,[t[302]||(t[302]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"API 基础地址",-1)),y(e("input",{"onUpdate:modelValue":t[90]||(t[90]=i=>s.value.baseApi=i),class:"form-input w-full",placeholder:"https://api.example.com/v1",type:"url"},null,512),[[A,s.value.baseApi]])]),e("div",null,[t[303]||(t[303]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"API 密钥",-1)),e("div",Ri,[y(e("input",{"onUpdate:modelValue":t[91]||(t[91]=i=>s.value.apiKey=i),class:"form-input w-full pr-10",placeholder:"留空表示不更新",type:ee.value?"text":"password"},null,8,Ki),[[as,s.value.apiKey]]),e("button",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",type:"button",onClick:t[92]||(t[92]=i=>ee.value=!ee.value)},[e("i",{class:M(ee.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),t[304]||(t[304]=e("p",{class:"mt-1 text-xs text-gray-500"},"留空表示不更新 API Key",-1))]),e("div",null,[t[305]||(t[305]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"自定义 User-Agent",-1)),y(e("input",{"onUpdate:modelValue":t[93]||(t[93]=i=>s.value.userAgent=i),class:"form-input w-full",placeholder:"留空则透传客户端 User-Agent",type:"text"},null,512),[[A,s.value.userAgent]]),t[306]||(t[306]=e("p",{class:"mt-1 text-xs text-gray-500"}," 留空时将自动使用客户端的 User-Agent，仅在需要固定特定 UA 时填写 ",-1))]),y(e("input",{"onUpdate:modelValue":t[94]||(t[94]=i=>s.value.rateLimitDuration=i),type:"hidden"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]]),e("div",zi,[e("div",null,[t[307]||(t[307]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 每日额度限制 ($) ",-1)),y(e("input",{"onUpdate:modelValue":t[95]||(t[95]=i=>s.value.dailyQuota=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:"0",placeholder:"0 表示不限制",step:"0.01",type:"number"},null,512),[[A,s.value.dailyQuota,void 0,{number:!0}]])]),e("div",null,[t[308]||(t[308]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"}," 额度重置时间 ",-1)),y(e("input",{"onUpdate:modelValue":t[96]||(t[96]=i=>s.value.quotaResetTime=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",type:"time"},null,512),[[A,s.value.quotaResetTime]])])])])):k("",!0),s.value.platform==="bedrock"?(o(),n("div",Pi,[e("div",null,[t[309]||(t[309]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"AWS 访问密钥 ID",-1)),y(e("input",{"onUpdate:modelValue":t[97]||(t[97]=i=>s.value.accessKeyId=i),class:"form-input w-full",placeholder:"留空表示不更新",type:"text"},null,512),[[A,s.value.accessKeyId]]),t[310]||(t[310]=e("p",{class:"mt-1 text-xs text-gray-500"},"留空表示不更新 AWS Access Key ID",-1))]),e("div",null,[t[311]||(t[311]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"AWS 秘密访问密钥",-1)),y(e("input",{"onUpdate:modelValue":t[98]||(t[98]=i=>s.value.secretAccessKey=i),class:"form-input w-full",placeholder:"留空表示不更新",type:"password"},null,512),[[A,s.value.secretAccessKey]]),t[312]||(t[312]=e("p",{class:"mt-1 text-xs text-gray-500"},"留空表示不更新 AWS Secret Access Key",-1))]),e("div",null,[t[313]||(t[313]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"AWS 区域",-1)),y(e("input",{"onUpdate:modelValue":t[99]||(t[99]=i=>s.value.region=i),class:"form-input w-full",placeholder:"例如：us-east-1",type:"text"},null,512),[[A,s.value.region]]),t[314]||(t[314]=e("div",{class:"mt-2 rounded-lg border border-blue-200 bg-blue-50 p-3"},[e("div",{class:"flex items-start gap-2"},[e("i",{class:"fas fa-info-circle mt-0.5 text-blue-600"}),e("div",{class:"text-xs text-blue-700"},[e("p",{class:"mb-1 font-medium"},"常用 AWS 区域参考："),e("div",{class:"grid grid-cols-2 gap-1 text-xs"},[e("span",null,"• us-east-1 (美国东部)"),e("span",null,"• us-west-2 (美国西部)"),e("span",null,"• eu-west-1 (欧洲爱尔兰)"),e("span",null,"• ap-southeast-1 (新加坡)"),e("span",null,"• ap-northeast-1 (东京)"),e("span",null,"• eu-central-1 (法兰克福)")])])])],-1))]),e("div",null,[t[315]||(t[315]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"会话令牌 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[100]||(t[100]=i=>s.value.sessionToken=i),class:"form-input w-full",placeholder:"留空表示不更新",type:"password"},null,512),[[A,s.value.sessionToken]])]),e("div",null,[t[316]||(t[316]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"默认主模型 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[101]||(t[101]=i=>s.value.defaultModel=i),class:"form-input w-full",placeholder:"例如：us.anthropic.claude-sonnet-4-20250514-v1:0",type:"text"},null,512),[[A,s.value.defaultModel]]),t[317]||(t[317]=e("p",{class:"mt-1 text-xs text-gray-500"}," 留空将使用系统默认模型。支持 inference profile ID 或 ARN ",-1))]),e("div",null,[t[318]||(t[318]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"小快速模型 (可选)",-1)),y(e("input",{"onUpdate:modelValue":t[102]||(t[102]=i=>s.value.smallFastModel=i),class:"form-input w-full",placeholder:"例如：us.anthropic.claude-3-5-haiku-20241022-v1:0",type:"text"},null,512),[[A,s.value.smallFastModel]]),t[319]||(t[319]=e("p",{class:"mt-1 text-xs text-gray-500"},"用于快速响应的轻量级模型，留空将使用系统默认",-1))]),e("div",null,[t[324]||(t[324]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"限流机制",-1)),e("div",Li,[e("label",ji,[y(e("input",{"onUpdate:modelValue":t[103]||(t[103]=i=>s.value.enableRateLimit=i),class:"mr-2 rounded border-gray-300 text-blue-600 focus:border-blue-500 focus:ring focus:ring-blue-200",type:"checkbox"},null,512),[[$e,s.value.enableRateLimit]]),t[320]||(t[320]=e("span",{class:"text-sm text-gray-700"},"启用限流机制",-1))]),t[321]||(t[321]=e("p",{class:"mt-1 text-xs text-gray-500"}," 启用后，当账号返回429错误时将暂停调度一段时间 ",-1))]),s.value.enableRateLimit?(o(),n("div",Oi,[t[322]||(t[322]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700"},"限流时间 (分钟)",-1)),y(e("input",{"onUpdate:modelValue":t[104]||(t[104]=i=>s.value.rateLimitDuration=i),class:"form-input w-full",min:"1",type:"number"},null,512),[[A,s.value.rateLimitDuration,void 0,{number:!0}]]),t[323]||(t[323]=e("p",{class:"mt-1 text-xs text-gray-500"},"账号被限流后暂停调度的时间（分钟）",-1))])):k("",!0)])])):k("",!0),s.value.platform==="azure_openai"?(o(),n("div",Fi,[e("div",null,[t[325]||(t[325]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"Azure Endpoint",-1)),y(e("input",{"onUpdate:modelValue":t[105]||(t[105]=i=>s.value.azureEndpoint=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.azureEndpoint}]),placeholder:"https://your-resource.openai.azure.com",type:"url"},null,2),[[A,s.value.azureEndpoint]]),T.value.azureEndpoint?(o(),n("p",Di,p(T.value.azureEndpoint),1)):k("",!0)]),e("div",null,[t[326]||(t[326]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API 版本",-1)),y(e("input",{"onUpdate:modelValue":t[106]||(t[106]=i=>s.value.apiVersion=i),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"2024-02-01",type:"text"},null,512),[[A,s.value.apiVersion]]),t[327]||(t[327]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Azure OpenAI API 版本，默认使用最新稳定版本 2024-02-01 ",-1))]),e("div",null,[t[328]||(t[328]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"部署名称",-1)),y(e("input",{"onUpdate:modelValue":t[107]||(t[107]=i=>s.value.deploymentName=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.deploymentName}]),placeholder:"gpt-4",type:"text"},null,2),[[A,s.value.deploymentName]]),T.value.deploymentName?(o(),n("p",Ni,p(T.value.deploymentName),1)):k("",!0)]),e("div",null,[t[329]||(t[329]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API Key",-1)),y(e("input",{"onUpdate:modelValue":t[108]||(t[108]=i=>s.value.apiKey=i),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",{"border-red-500":T.value.apiKey}]),placeholder:"留空表示不更新",type:"password"},null,2),[[A,s.value.apiKey]]),T.value.apiKey?(o(),n("p",Ei,p(T.value.apiKey),1)):k("",!0),t[330]||(t[330]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"留空表示不更新 API Key",-1))]),e("div",null,[t[331]||(t[331]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"支持的模型",-1)),e("div",qi,[(o(),n(ae,null,ue(["gpt-4","gpt-4-turbo","gpt-4o","gpt-4o-mini","gpt-5","gpt-5-mini","gpt-35-turbo","gpt-35-turbo-16k","codex-mini"],i=>e("label",{key:i,class:"flex cursor-pointer items-center"},[y(e("input",{"onUpdate:modelValue":t[109]||(t[109]=Y=>s.value.supportedModels=Y),class:"mr-2 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox",value:i},null,8,Wi),[[$e,s.value.supportedModels]]),e("span",Gi,p(i),1)])),64))]),t[332]||(t[332]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"选择此部署支持的模型类型",-1))])])):k("",!0),s.value.platform!=="claude-console"&&s.value.platform!=="ccr"&&s.value.platform!=="bedrock"&&s.value.platform!=="azure_openai"&&s.value.platform!=="openai-responses"?(o(),n("div",Bi,[t[335]||(t[335]=e("div",{class:"mb-4 flex items-start gap-3"},[e("div",{class:"mt-1 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-amber-500"},[e("i",{class:"fas fa-key text-sm text-white"})]),e("div",null,[e("h5",{class:"mb-2 font-semibold text-amber-900 dark:text-amber-300"},"更新 Token"),e("p",{class:"mb-2 text-sm text-amber-800 dark:text-amber-300"}," 可以更新 Access Token 和 Refresh Token。为了安全起见，不会显示当前的 Token 值。 "),e("p",{class:"text-xs text-amber-600 dark:text-amber-400"},"💡 留空表示不更新该字段。")])],-1)),e("div",Qi,[e("div",null,[t[333]||(t[333]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"新的 Access Token",-1)),y(e("textarea",{"onUpdate:modelValue":t[110]||(t[110]=i=>s.value.accessToken=i),class:"form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"留空表示不更新...",rows:"4"},null,512),[[A,s.value.accessToken]])]),e("div",null,[t[334]||(t[334]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"新的 Refresh Token",-1)),y(e("textarea",{"onUpdate:modelValue":t[111]||(t[111]=i=>s.value.refreshToken=i),class:"form-input w-full resize-none border-gray-300 font-mono text-xs dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"留空表示不更新...",rows:"4"},null,512),[[A,s.value.refreshToken]])])])])):k("",!0),Fe(rs,{modelValue:s.value.proxy,"onUpdate:modelValue":t[112]||(t[112]=i=>s.value.proxy=i)},null,8,["modelValue"]),e("div",Hi,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:t[113]||(t[113]=i=>u.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:B.value,type:"button",onClick:xt},[B.value?(o(),n("div",Yi)):k("",!0),$(" "+p(B.value?"更新中...":"更新"),1)],8,Ji)])])):k("",!0)])])):k("",!0),Fe(_s,{"cancel-text":Ue(X).cancelText,"confirm-text":Ue(X).confirmText,message:Ue(X).message,show:Ue(G),title:Ue(X).title,onCancel:Ue(q),onConfirm:Ue(w)},null,8,["cancel-text","confirm-text","message","show","title","onCancel","onConfirm"]),b.value?(o(),Ne(Dr,{key:1,onClose:t[114]||(t[114]=i=>b.value=!1),onRefresh:Zt})):k("",!0)]))}},Ts=os(Zi,[["__scopeId","data-v-a78f0d26"]]),Xi={key:0,class:"modal fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4"},ed={class:"modal-content custom-scrollbar mx-auto max-h-[90vh] w-full max-w-2xl overflow-y-auto p-4 sm:p-6 md:p-8"},td={class:"mb-4 flex items-center justify-between sm:mb-6"},sd={class:"flex items-center gap-2 sm:gap-3"},ad={class:"text-lg font-bold text-gray-900 dark:text-gray-100 sm:text-xl"},rd={class:"space-y-6"},ld={key:0,class:"mt-1 text-xs text-red-500"},od={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},nd={key:0,class:"mt-1 text-xs text-red-500"},id={class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},dd=["placeholder","required"],ud={key:0,class:"mt-1 text-xs text-red-500"},pd={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},gd={class:"mb-3"},md={class:"inline-flex cursor-pointer items-center"},yd={key:0},xd={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},fd={class:"mb-3 space-y-2"},bd=["onUpdate:modelValue"],cd=["onUpdate:modelValue"],vd=["onClick"],kd={class:"mt-2 flex gap-3"},hd=["disabled"],wd={key:0,class:"loading-spinner mr-2"},$d={__name:"CcrAccountForm",props:{account:{type:Object,default:null}},emits:["close","success"],setup(be,{emit:Ae}){const v=be,ge=Ae,V=I(!0),G=Ge(()=>!!v.account),X=I(!1),g=I({name:"",description:"",apiUrl:"",apiKey:"",priority:50,userAgent:"",rateLimitDuration:60,dailyQuota:0,quotaResetTime:"00:00",proxy:null,supportedModels:{}}),w=I(!0),q=I({}),j=I([]),H=()=>{const d={};for(const f of j.value){const P=(f.from||"").trim(),K=(f.to||"").trim();P&&K&&(d[P]=K)}return d},W=()=>{j.value.push({from:"",to:""})},B=d=>{j.value.splice(d,1)},ee=()=>{const d={};return(!g.value.name||g.value.name.trim().length===0)&&(d.name="名称不能为空"),(!g.value.apiUrl||g.value.apiUrl.trim().length===0)&&(d.apiUrl="API URL 不能为空"),!G.value&&(!g.value.apiKey||g.value.apiKey.trim().length===0)&&(d.apiKey="API Key 不能为空"),q.value=d,Object.keys(d).length===0},se=async()=>{if(ee()){X.value=!0;try{if(G.value){const d={name:g.value.name,description:g.value.description,apiUrl:g.value.apiUrl,priority:g.value.priority,userAgent:g.value.userAgent,rateLimitDuration:w.value?Number(g.value.rateLimitDuration||60):0,dailyQuota:Number(g.value.dailyQuota||0),quotaResetTime:g.value.quotaResetTime||"00:00",proxy:g.value.proxy||null,supportedModels:H()};g.value.apiKey&&g.value.apiKey.trim().length>0&&(d.apiKey=g.value.apiKey);const f=await O.put(`/admin/ccr-accounts/${v.account.id}`,d);f.success?ge("success"):R(f.message||"保存失败","error")}else{const d={name:g.value.name,description:g.value.description,apiUrl:g.value.apiUrl,apiKey:g.value.apiKey,priority:Number(g.value.priority||50),supportedModels:H(),userAgent:g.value.userAgent,rateLimitDuration:w.value?Number(g.value.rateLimitDuration||60):0,proxy:g.value.proxy,accountType:"shared",dailyQuota:Number(g.value.dailyQuota||0),quotaResetTime:g.value.quotaResetTime||"00:00"},f=await O.post("/admin/ccr-accounts",d);f.success?ge("success"):R(f.message||"创建失败","error")}}catch(d){R(d.message||"请求失败","error")}finally{X.value=!1}}},F=()=>{if(!v.account)return;const d=v.account;g.value.name=d.name||"",g.value.description=d.description||"",g.value.apiUrl=d.apiUrl||"",g.value.priority=Number(d.priority||50),g.value.userAgent=d.userAgent||"",g.value.rateLimitDuration=Number(d.rateLimitDuration||60),g.value.dailyQuota=Number(d.dailyQuota||0),g.value.quotaResetTime=d.quotaResetTime||"00:00",g.value.proxy=d.proxy||null,w.value=g.value.rateLimitDuration>0,j.value=[];const f=d.supportedModels||{};if(f&&typeof f=="object")for(const P of Object.keys(f))j.value.push({from:P,to:f[P]})};return Yt(()=>{G.value&&F()}),le(()=>v.account,()=>{G.value&&F()}),(d,f)=>(o(),Ne(ls,{to:"body"},[V.value?(o(),n("div",Xi,[e("div",ed,[e("div",td,[e("div",sd,[f[13]||(f[13]=e("div",{class:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-teal-500 to-emerald-600 sm:h-10 sm:w-10 sm:rounded-xl"},[e("i",{class:"fas fa-code-branch text-sm text-white sm:text-base"})],-1)),e("h3",ad,p(G.value?"编辑 CCR 账户":"添加 CCR 账户"),1)]),e("button",{class:"p-1 text-gray-400 transition-colors hover:text-gray-600",onClick:f[0]||(f[0]=P=>d.$emit("close"))},f[14]||(f[14]=[e("i",{class:"fas fa-times text-lg sm:text-xl"},null,-1)]))]),e("div",rd,[e("div",null,[f[15]||(f[15]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"账户名称 *",-1)),y(e("input",{"onUpdate:modelValue":f[1]||(f[1]=P=>g.value.name=P),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",{"border-red-500":q.value.name}]),placeholder:"为账户设置一个易识别的名称",required:"",type:"text"},null,2),[[A,g.value.name]]),q.value.name?(o(),n("p",ld,p(q.value.name),1)):k("",!0)]),e("div",null,[f[16]||(f[16]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"描述 (可选)",-1)),y(e("textarea",{"onUpdate:modelValue":f[2]||(f[2]=P=>g.value.description=P),class:"form-input w-full resize-none border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"账户用途说明...",rows:"3"},null,512),[[A,g.value.description]])]),e("div",od,[e("div",null,[f[17]||(f[17]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"API URL *",-1)),y(e("input",{"onUpdate:modelValue":f[3]||(f[3]=P=>g.value.apiUrl=P),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",{"border-red-500":q.value.apiUrl}]),placeholder:"例如：https://api.example.com/v1/messages",required:"",type:"text"},null,2),[[A,g.value.apiUrl]]),q.value.apiUrl?(o(),n("p",nd,p(q.value.apiUrl),1)):k("",!0)]),e("div",null,[e("label",id,"API Key "+p(G.value?"(留空不更新)":"*"),1),y(e("input",{"onUpdate:modelValue":f[4]||(f[4]=P=>g.value.apiKey=P),class:M(["form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",{"border-red-500":q.value.apiKey}]),placeholder:G.value?"留空表示不更新":"必填",required:!G.value,type:"password"},null,10,dd),[[A,g.value.apiKey]]),q.value.apiKey?(o(),n("p",ud,p(q.value.apiKey),1)):k("",!0)])]),e("div",pd,[e("div",null,[f[18]||(f[18]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"优先级",-1)),y(e("input",{"onUpdate:modelValue":f[5]||(f[5]=P=>g.value.priority=P),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",max:"100",min:"1",placeholder:"默认50，数字越小优先级越高",type:"number"},null,512),[[A,g.value.priority,void 0,{number:!0}]]),f[19]||(f[19]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 建议范围：1-100，数字越小优先级越高 ",-1))]),e("div",null,[f[20]||(f[20]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"自定义 User-Agent (可选)",-1)),y(e("input",{"onUpdate:modelValue":f[6]||(f[6]=P=>g.value.userAgent=P),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"留空则透传客户端 User-Agent",type:"text"},null,512),[[A,g.value.userAgent]])])]),e("div",null,[f[24]||(f[24]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流机制",-1)),e("div",gd,[e("label",md,[y(e("input",{"onUpdate:modelValue":f[7]||(f[7]=P=>w.value=P),class:"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700",type:"checkbox"},null,512),[[$e,w.value]]),f[21]||(f[21]=e("span",{class:"text-sm text-gray-700 dark:text-gray-300"},"启用限流机制（429 时暂停调度）",-1))])]),w.value?(o(),n("div",yd,[f[22]||(f[22]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"限流时间 (分钟)",-1)),y(e("input",{"onUpdate:modelValue":f[8]||(f[8]=P=>g.value.rateLimitDuration=P),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:"1",placeholder:"默认60分钟",type:"number"},null,512),[[A,g.value.rateLimitDuration,void 0,{number:!0}]]),f[23]||(f[23]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 账号被限流后暂停调度的时间（分钟） ",-1))])):k("",!0)]),e("div",xd,[e("div",null,[f[25]||(f[25]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"每日额度限制 ($)",-1)),y(e("input",{"onUpdate:modelValue":f[9]||(f[9]=P=>g.value.dailyQuota=P),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",min:"0",placeholder:"0 表示不限制",step:"0.01",type:"number"},null,512),[[A,g.value.dailyQuota,void 0,{number:!0}]]),f[26]||(f[26]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 设置每日使用额度，0 表示不限制 ",-1))]),e("div",null,[f[27]||(f[27]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"额度重置时间",-1)),y(e("input",{"onUpdate:modelValue":f[10]||(f[10]=P=>g.value.quotaResetTime=P),class:"form-input w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",placeholder:"00:00",type:"time"},null,512),[[A,g.value.quotaResetTime]]),f[28]||(f[28]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"每日自动重置额度的时间",-1))])]),e("div",null,[f[32]||(f[32]=e("label",{class:"mb-3 block text-sm font-semibold text-gray-700 dark:text-gray-300"},"模型映射表 (可选)",-1)),f[33]||(f[33]=e("div",{class:"mb-3 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/30"},[e("p",{class:"text-xs text-blue-700 dark:text-blue-400"},[e("i",{class:"fas fa-info-circle mr-1"}),$(" 留空表示支持所有模型且不修改请求。配置映射后，左侧模型会被识别为支持的模型，右侧是实际发送的模型。 ")])],-1)),e("div",fd,[(o(!0),n(ae,null,ue(j.value,(P,K)=>(o(),n("div",{key:K,class:"flex items-center gap-2"},[y(e("input",{"onUpdate:modelValue":c=>P.from=c,class:"form-input flex-1 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"原始模型名称",type:"text"},null,8,bd),[[A,P.from]]),f[30]||(f[30]=e("i",{class:"fas fa-arrow-right text-gray-400 dark:text-gray-500"},null,-1)),y(e("input",{"onUpdate:modelValue":c=>P.to=c,class:"form-input flex-1 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 dark:placeholder-gray-400",placeholder:"映射后的模型名称",type:"text"},null,8,cd),[[A,P.to]]),e("button",{class:"rounded-lg p-2 text-red-500 transition-colors hover:bg-red-50 dark:hover:bg-red-900/20",type:"button",onClick:c=>B(K)},f[29]||(f[29]=[e("i",{class:"fas fa-trash"},null,-1)]),8,vd)]))),128))]),e("button",{class:"w-full rounded-lg border-2 border-dashed border-gray-300 px-4 py-2 text-gray-600 transition-colors hover:border-gray-400 hover:text-gray-700 dark:border-gray-600 dark:text-gray-400 dark:hover:border-gray-500 dark:hover:text-gray-300",type:"button",onClick:W},f[31]||(f[31]=[e("i",{class:"fas fa-plus mr-2"},null,-1),$(" 添加模型映射 ",-1)]))]),e("div",null,[Fe(rs,{modelValue:g.value.proxy,"onUpdate:modelValue":f[11]||(f[11]=P=>g.value.proxy=P)},null,8,["modelValue"])]),e("div",kd,[e("button",{class:"flex-1 rounded-xl bg-gray-100 px-6 py-3 font-semibold text-gray-700 transition-colors hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:f[12]||(f[12]=P=>d.$emit("close"))}," 取消 "),e("button",{class:"btn btn-primary flex-1 px-6 py-3 font-semibold",disabled:X.value,type:"button",onClick:se},[X.value?(o(),n("div",wd)):k("",!0),$(" "+p(X.value?G.value?"保存中...":"创建中...":G.value?"保存":"创建"),1)],8,hd)])])])])):k("",!0)]))}},Is=os($d,[["__scopeId","data-v-8652672a"]]),Ad={class:"accounts-container"},Cd={class:"card p-4 sm:p-6"},Ud={class:"mb-4 flex flex-col gap-4 sm:mb-6"},Td={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Id={class:"flex flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-center sm:gap-3"},_d={class:"group relative min-w-[160px]"},Vd={class:"group relative min-w-[140px]"},Sd={class:"group relative min-w-[160px]"},Md={class:"relative"},Rd=["disabled"],Kd={key:0,class:"py-12 text-center"},zd={key:1,class:"py-12 text-center"},Pd={key:2,class:"table-container hidden md:block"},Ld={class:"w-full table-fixed"},jd={class:"bg-gray-50/80 backdrop-blur-sm dark:bg-gray-700/80"},Od={key:1,class:"fas fa-sort ml-1 text-gray-400"},Fd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Dd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Nd={key:1,class:"fas fa-sort ml-1 text-gray-400"},Ed={class:"w-[10%] min-w-[100px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"},qd={class:"flex items-center gap-2"},Wd={class:"divide-y divide-gray-200/50 dark:divide-gray-600/50"},Gd={class:"table-row"},Bd={class:"px-3 py-4"},Qd={class:"flex items-center"},Hd={class:"min-w-0"},Jd={class:"flex items-center gap-2"},Yd=["title"],Zd={key:0,class:"inline-flex items-center rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-800"},Xd={key:1,class:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-800"},e0={key:2,class:"inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800"},t0=["title"],s0={class:"px-3 py-4"},a0={class:"flex flex-wrap items-center gap-2"},r0=["title"],l0={key:1,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-500 dark:bg-gray-700 dark:text-gray-400"},o0={class:"px-3 py-4"},n0={class:"flex items-center gap-1"},i0={key:0,class:"flex items-center gap-1.5 rounded-lg border border-yellow-200 bg-gradient-to-r from-yellow-100 to-amber-100 px-2.5 py-1"},d0={class:"text-xs font-medium text-yellow-700"},u0={key:1,class:"flex items-center gap-1.5 rounded-lg border border-purple-200 bg-gradient-to-r from-purple-100 to-pink-100 px-2.5 py-1"},p0={key:2,class:"flex items-center gap-1.5 rounded-lg border border-orange-200 bg-gradient-to-r from-orange-100 to-red-100 px-2.5 py-1"},g0={key:3,class:"flex items-center gap-1.5 rounded-lg border border-gray-700 bg-gray-100 bg-gradient-to-r from-gray-100 to-gray-100 px-2.5 py-1"},m0={class:"text-xs font-medium text-gray-950"},y0={key:4,class:"flex items-center gap-1.5 rounded-lg border border-blue-200 bg-gradient-to-r from-blue-100 to-cyan-100 px-2.5 py-1 dark:border-blue-700 dark:from-blue-900/20 dark:to-cyan-900/20"},x0={key:5,class:"flex items-center gap-1.5 rounded-lg border border-teal-200 bg-gradient-to-r from-teal-100 to-green-100 px-2.5 py-1 dark:border-teal-700 dark:from-teal-900/20 dark:to-green-900/20"},f0={key:6,class:"flex items-center gap-1.5 rounded-lg border border-indigo-200 bg-gradient-to-r from-indigo-100 to-blue-100 px-2.5 py-1"},b0={class:"text-xs font-semibold text-indigo-800"},c0={class:"text-xs font-medium text-indigo-700"},v0={key:7,class:"flex items-center gap-1.5 rounded-lg border border-teal-200 bg-gradient-to-r from-teal-100 to-emerald-100 px-2.5 py-1 dark:border-teal-700 dark:from-teal-900/20 dark:to-emerald-900/20"},k0={key:8,class:"flex items-center gap-1.5 rounded-lg border border-gray-200 bg-gradient-to-r from-gray-100 to-gray-200 px-2.5 py-1"},h0={class:"whitespace-nowrap px-3 py-4"},w0={class:"flex flex-col gap-1"},$0={key:0,class:"inline-flex items-center rounded-full bg-yellow-100 px-3 py-1 text-xs font-semibold text-yellow-800"},A0={key:0},C0={key:1,class:"inline-flex items-center rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700"},U0=["title"],T0={key:3,class:"text-xs text-gray-500 dark:text-gray-400"},I0={class:"whitespace-nowrap px-3 py-4"},_0={key:0,class:"flex items-center gap-2"},V0={class:"h-2 w-16 rounded-full bg-gray-200"},S0={class:"min-w-[20px] text-xs font-medium text-gray-700 dark:text-gray-200"},M0={key:1,class:"text-sm text-gray-400"},R0={class:"px-3 py-4 text-sm text-gray-600"},K0=["title"],z0={key:1,class:"text-gray-400"},P0={class:"whitespace-nowrap px-3 py-4 text-sm"},L0={key:0,class:"space-y-1"},j0={class:"flex items-center gap-2"},O0={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},F0={class:"flex items-center gap-2"},D0={class:"text-xs text-gray-600 dark:text-gray-300"},N0={class:"flex items-center gap-2"},E0={class:"text-xs text-gray-600 dark:text-gray-300"},q0={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},W0={key:1,class:"text-xs text-gray-400"},G0={class:"whitespace-nowrap px-3 py-4 text-sm"},B0={key:0,class:"space-y-1"},Q0={class:"flex items-center gap-2"},H0={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},J0={class:"flex items-center gap-2"},Y0={class:"text-xs text-gray-600 dark:text-gray-300"},Z0={class:"flex items-center gap-2"},X0={class:"text-xs text-gray-600 dark:text-gray-300"},eu={key:1,class:"text-xs text-gray-400"},tu={class:"whitespace-nowrap px-3 py-4"},su={key:0,class:"space-y-2"},au={key:0,class:"flex items-center gap-3 text-xs"},ru={class:"flex items-center gap-1"},lu={class:"font-medium text-gray-900 dark:text-gray-100"},ou={class:"flex items-center gap-1"},nu={class:"font-medium text-gray-900 dark:text-gray-100"},iu={class:"flex items-center gap-2"},du={class:"h-2 w-24 rounded-full bg-gray-200 dark:bg-gray-700"},uu={class:"min-w-[32px] text-xs font-medium text-gray-700 dark:text-gray-200"},pu={class:"text-xs text-gray-600 dark:text-gray-400"},gu={key:0,class:"font-medium text-indigo-600 dark:text-indigo-400"},mu={key:1,class:"space-y-2"},yu={key:0},xu={class:"flex items-center justify-between text-xs"},fu={class:"font-medium text-gray-700 dark:text-gray-200"},bu={class:"flex items-center gap-2"},cu={class:"h-2 w-24 rounded-full bg-gray-200 dark:bg-gray-700"},vu={class:"min-w-[32px] text-xs font-medium text-gray-700 dark:text-gray-200"},ku={class:"text-xs text-gray-600 dark:text-gray-400"},hu={class:"ml-2 text-gray-400"},wu={key:1,class:"text-sm text-gray-400"},$u={key:2,class:"text-sm text-gray-400"},Au={key:3,class:"space-y-2"},Cu={key:0,class:"space-y-2"},Uu={class:"rounded-lg bg-gray-50 p-2 dark:bg-gray-700/70"},Tu={class:"flex items-center gap-2"},Iu={class:"inline-flex min-w-[32px] justify-center rounded-full bg-indigo-100 px-2 py-0.5 text-[11px] font-medium text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-300"},_u={class:"flex-1"},Vu={class:"flex items-center gap-2"},Su={class:"h-2 flex-1 rounded-full bg-gray-200 dark:bg-gray-600"},Mu={class:"w-12 text-right text-xs font-semibold text-gray-800 dark:text-gray-100"},Ru={class:"mt-1 text-[11px] text-gray-500 dark:text-gray-400"},Ku={class:"rounded-lg bg-gray-50 p-2 dark:bg-gray-700/70"},zu={class:"flex items-center gap-2"},Pu={class:"inline-flex min-w-[32px] justify-center rounded-full bg-blue-100 px-2 py-0.5 text-[11px] font-medium text-blue-600 dark:bg-blue-500/20 dark:text-blue-300"},Lu={class:"flex-1"},ju={class:"flex items-center gap-2"},Ou={class:"h-2 flex-1 rounded-full bg-gray-200 dark:bg-gray-600"},Fu={class:"w-12 text-right text-xs font-semibold text-gray-800 dark:text-gray-100"},Du={class:"mt-1 text-[11px] text-gray-500 dark:text-gray-400"},Nu={key:1,class:"text-sm text-gray-400"},Eu={key:4,class:"text-sm text-gray-400"},qu={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-600 dark:text-gray-300"},Wu={class:"whitespace-nowrap px-3 py-4 text-sm font-medium"},Gu={class:"flex flex-wrap items-center gap-1"},Bu=["title","onClick"],Qu={class:"ml-1"},Hu=["disabled","title","onClick"],Ju=["disabled","title","onClick"],Yu={class:"ml-1"},Zu=["onClick"],Xu=["onClick"],ep={key:0,class:"bg-gray-50/60 dark:bg-gray-800/50"},tp={class:"px-6 pb-6 pt-2",colspan:"11"},sp={class:"grid gap-4 lg:grid-cols-3"},ap={class:"flex items-center justify-between"},rp={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},lp={class:"text-xs text-gray-500 dark:text-gray-400"},op={class:"mt-3 space-y-2 text-xs text-gray-500 dark:text-gray-400"},np={class:"flex items-center justify-between"},ip={class:"font-semibold text-gray-900 dark:text-gray-100"},dp={class:"flex items-center justify-between"},up={class:"font-semibold text-gray-900 dark:text-gray-100"},pp={class:"flex items-center justify-between"},gp={class:"font-semibold text-gray-900 dark:text-gray-100"},mp={class:"flex items-center justify-between"},yp={class:"font-semibold text-gray-900 dark:text-gray-100"},xp={class:"flex items-center justify-between"},fp={class:"font-semibold text-gray-900 dark:text-gray-100"},bp={class:"mt-4 flex flex-wrap gap-4 text-xs text-gray-500 dark:text-gray-400"},cp={key:0,class:"mt-6 grid gap-4 lg:grid-cols-3"},vp={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-900/80"},kp={class:"flex items-center justify-between"},hp={key:0,class:"ml-2 text-xs text-gray-500 dark:text-gray-400"},wp={class:"flex items-center gap-2"},$p=["onClick"],Ap=["onClick"],Cp={key:0,class:"mt-3 text-xs text-gray-500 dark:text-gray-400"},Up={key:1,class:"mt-3 space-y-3 text-xs text-gray-600 dark:text-gray-300"},Tp={key:0,class:"flex items-center justify-between rounded border border-yellow-200 bg-yellow-50 px-3 py-2 text-yellow-700 dark:border-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-200"},Ip=["onClick"],_p=["onSubmit"],Vp={class:"grid grid-cols-2 gap-2"},Sp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Mp=["onUpdate:modelValue"],Rp=["value"],Kp={class:"text-[11px] text-gray-500 dark:text-gray-400"},zp=["onUpdate:modelValue"],Pp=["value"],Lp={class:"grid grid-cols-2 gap-2"},jp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Op=["onUpdate:modelValue"],Fp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Dp=["onUpdate:modelValue"],Np=["value"],Ep={class:"grid grid-cols-2 gap-2"},qp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Wp=["onUpdate:modelValue"],Gp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Bp=["onUpdate:modelValue"],Qp={class:"grid grid-cols-2 gap-2"},Hp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Jp=["onUpdate:modelValue"],Yp={class:"text-[11px] text-gray-500 dark:text-gray-400"},Zp=["onUpdate:modelValue"],Xp={class:"block text-[11px] text-gray-500 dark:text-gray-400"},eg=["onUpdate:modelValue"],tg={class:"flex justify-end gap-2"},sg=["onClick"],ag=["disabled"],rg={key:2,class:"space-y-2"},lg={class:"text-[11px] text-gray-400"},og={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-900/80"},ng={class:"mb-2 flex items-center justify-between"},ig=["onClick"],dg={key:0,class:"text-xs text-gray-500"},ug={key:1,class:"rounded border border-yellow-200 bg-yellow-50 px-3 py-2 text-xs text-yellow-700 dark:border-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-200"},pg={key:2,class:"space-y-3 text-xs text-gray-600 dark:text-gray-300"},gg=["onSubmit"],mg={class:"grid grid-cols-2 gap-2"},yg={class:"text-[11px] text-gray-500"},xg=["onUpdate:modelValue"],fg={class:"text-[11px] text-gray-500"},bg=["onUpdate:modelValue"],cg={class:"grid grid-cols-2 gap-2"},vg={class:"text-[11px] text-gray-500"},kg=["onUpdate:modelValue"],hg={class:"text-[11px] text-gray-500"},wg=["onUpdate:modelValue"],$g={class:"grid grid-cols-2 gap-2"},Ag={class:"text-[11px] text-gray-500"},Cg=["onUpdate:modelValue"],Ug={class:"text-[11px] text-gray-500"},Tg=["onUpdate:modelValue"],Ig={class:"text-[11px] text-gray-500"},_g=["onUpdate:modelValue"],Vg={class:"flex justify-end gap-2"},Sg=["onClick"],Mg=["disabled"],Rg={key:1},Kg={key:0,class:"text-gray-400"},zg={key:1,class:"space-y-2"},Pg={class:"flex items-center justify-between"},Lg={class:"font-medium text-gray-900 dark:text-gray-100"},jg={class:"text-[11px] text-gray-500 dark:text-gray-400"},Og={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-900/80"},Fg={class:"mb-2 flex items-center justify-between"},Dg=["onClick"],Ng={key:0,class:"text-xs text-gray-500"},Eg={key:1,class:"rounded border border-yellow-200 bg-yellow-50 px-3 py-2 text-xs text-yellow-700 dark:border-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-200"},qg={key:2,class:"space-y-3 text-xs text-gray-600 dark:text-gray-300"},Wg=["onSubmit"],Gg={class:"text-[11px] text-gray-500"},Bg=["onUpdate:modelValue"],Qg={class:"grid grid-cols-2 gap-2"},Hg={class:"text-[11px] text-gray-500"},Jg=["onUpdate:modelValue"],Yg={class:"text-[11px] text-gray-500"},Zg=["onUpdate:modelValue"],Xg={class:"text-[11px] text-gray-500"},em=["onUpdate:modelValue"],tm={class:"flex justify-end gap-2"},sm=["onClick"],am=["disabled"],rm={key:1},lm={key:0,class:"text-gray-400"},om={key:1,class:"space-y-2"},nm={class:"flex items-center justify-between"},im={class:"font-medium text-gray-900 dark:text-gray-100"},dm={class:"text-[11px] text-gray-500 dark:text-gray-400"},um={class:"mt-6 rounded-lg border border-gray-200 bg-white p-4 dark:border-gray-700 dark:bg-gray-900/70"},pm={class:"mb-3 flex flex-wrap items-center justify-between gap-3"},gm={class:"flex items-center gap-2"},mm={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},ym={class:"flex items-center gap-1"},xm=["disabled","onClick"],fm={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},bm={key:1,class:"flex items-center justify-between rounded border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-600 dark:border-red-700 dark:bg-red-900/20 dark:text-red-300"},cm=["onClick"],vm={key:2,class:"text-xs text-gray-400"},km={key:3,class:"overflow-x-auto"},hm={class:"min-w-full text-left text-xs text-gray-600 dark:text-gray-300"},wm={class:"py-2 pr-4 font-mono text-[11px] text-indigo-600 dark:text-indigo-300"},$m={class:"py-2 pr-4"},Am={class:"truncate text-[11px] text-gray-600 dark:text-gray-300"},Cm={class:"py-2 pr-4"},Um={class:"py-2 pr-4"},Tm={class:"py-2 pr-4"},Im={class:"py-2 pr-4"},_m={class:"rounded bg-gray-100 px-2 py-0.5 text-[11px] text-gray-600 dark:bg-gray-800 dark:text-gray-300"},Vm={class:"py-2 pr-4"},Sm={class:"py-2"},Mm={class:"mt-3 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400"},Rm=["disabled","onClick"],Km={key:3,class:"space-y-3 md:hidden"},zm={class:"mb-3 flex items-start justify-between"},Pm={class:"flex items-center gap-3"},Lm={class:"text-sm font-semibold text-gray-900"},jm={class:"mt-0.5 flex items-center gap-2"},Om={class:"text-xs text-gray-500 dark:text-gray-400"},Fm={class:"text-xs text-gray-500 dark:text-gray-400"},Dm={class:"mt-1 flex flex-wrap items-center gap-1"},Nm={key:1,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-[10px] font-medium text-gray-500 dark:bg-gray-700 dark:text-gray-400"},Em={class:"mb-3 grid grid-cols-2 gap-3"},qm={class:"space-y-1"},Wm={class:"flex items-center gap-1.5"},Gm={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},Bm={class:"flex items-center gap-1.5"},Qm={class:"text-xs text-gray-600 dark:text-gray-400"},Hm={class:"flex items-center gap-1.5"},Jm={class:"text-xs text-gray-600 dark:text-gray-400"},Ym={class:"space-y-1"},Zm={class:"flex items-center gap-1.5"},Xm={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},ey={class:"flex items-center gap-1.5"},ty={class:"text-xs text-gray-600 dark:text-gray-400"},sy={class:"flex items-center gap-1.5"},ay={class:"text-xs text-gray-600 dark:text-gray-400"},ry={key:0,class:"space-y-1"},ly={class:"flex items-center gap-1.5"},oy={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},ny={class:"flex items-center gap-1.5"},iy={class:"text-xs text-gray-600 dark:text-gray-400"},dy={key:1,class:"text-sm font-semibold text-gray-400"},uy={class:"mb-3 rounded-lg border border-gray-200 bg-white p-3 dark:border-gray-700 dark:bg-gray-900/60"},py={class:"mb-2 flex flex-wrap items-center justify-between gap-2"},gy={class:"flex items-center gap-1"},my=["disabled","onClick"],yy={key:0,class:"text-[11px] text-gray-500 dark:text-gray-400"},xy={key:1,class:"text-[11px] text-red-500"},fy={key:2,class:"text-[11px] text-gray-400"},by={key:3,class:"space-y-1"},cy={class:"flex flex-1 items-center gap-3 pr-2"},vy={class:"min-w-[120px] flex-1 truncate font-mono text-[10px] text-indigo-500 dark:text-indigo-300"},ky={class:"hidden min-w-[110px] flex-1 truncate text-[11px] text-gray-600 dark:text-gray-300 sm:block"},hy={class:"flex items-center gap-2 text-gray-600 dark:text-gray-300"},wy=["disabled","onClick"],$y={class:"mb-3 space-y-2"},Ay={key:0,class:"space-y-1.5 rounded-lg bg-gray-50 p-2 dark:bg-gray-700"},Cy={class:"flex items-center justify-between text-xs"},Uy={class:"flex items-center gap-1"},Ty={class:"font-medium text-gray-700 dark:text-gray-200"},Iy={class:"h-2 w-full overflow-hidden rounded-full bg-gray-200 dark:bg-gray-600"},_y={class:"flex items-center justify-between text-xs"},Vy={class:"text-gray-500 dark:text-gray-400"},Sy={key:0,class:"font-medium text-indigo-600"},My={key:1,class:"text-gray-500"},Ry={class:"flex items-center justify-between text-xs"},Ky={class:"text-gray-700 dark:text-gray-200"},zy={key:1,class:"flex items-center justify-between text-xs"},Py={class:"text-gray-700 dark:text-gray-200"},Ly={class:"flex items-center justify-between text-xs"},jy={class:"font-medium text-gray-700 dark:text-gray-200"},Oy={class:"mt-3 flex gap-2 border-t border-gray-100 pt-3"},Fy=["onClick"],Dy=["disabled","onClick"],Ny=["onClick"],Ey=["onClick"],qy={key:0,class:"mt-3 space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-3 text-xs text-gray-600 dark:border-gray-700 dark:bg-gray-800/60 dark:text-gray-300"},Wy={class:"grid gap-3 sm:grid-cols-3"},Gy={class:"flex items-center justify-between"},By={class:"font-semibold text-gray-800 dark:text-gray-100"},Qy={class:"text-[10px] text-gray-400 dark:text-gray-500"},Hy={class:"mt-2 space-y-1.5 text-[11px] text-gray-500 dark:text-gray-400"},Jy={class:"flex items-center justify-between"},Yy={class:"font-semibold text-gray-900 dark:text-gray-100"},Zy={class:"flex items-center justify-between"},Xy={class:"font-semibold text-gray-900 dark:text-gray-100"},ex={class:"flex items-center justify-between"},tx={class:"font-semibold text-gray-900 dark:text-gray-100"},sx={class:"flex items-center justify-between"},ax={class:"font-semibold text-gray-900 dark:text-gray-100"},rx={class:"flex items-center justify-between"},lx={class:"font-semibold text-gray-900 dark:text-gray-100"},ox={class:"flex flex-wrap gap-3 text-[11px] text-gray-500 dark:text-gray-400"},nx={__name:"AccountsView",setup(be){const{showConfirmModal:Ae,confirmOptions:v,showConfirm:ge,handleConfirm:V,handleCancel:G}=Vs(),X=I([]),g=I(!1),w=I("name"),q=I(""),j=I("asc"),H=I([]),W=I([]),B=I("all"),ee=I("all"),se=I(!1),F=I(!1),d=I(!1),f=I(new Map),P=I(new Set),K=I({}),c=Ns({}),U=I([{value:"name",label:"按名称排序",icon:"fa-font"},{value:"dailyTokens",label:"按今日Token排序",icon:"fa-coins"},{value:"dailyRequests",label:"按今日请求数排序",icon:"fa-chart-line"},{value:"totalTokens",label:"按总Token排序",icon:"fa-database"},{value:"lastUsed",label:"按最后使用排序",icon:"fa-clock"}]),E=I([{value:"all",label:"所有平台",icon:"fa-globe"},{value:"claude",label:"Claude",icon:"fa-brain"},{value:"claude-console",label:"Claude Console",icon:"fa-terminal"},{value:"gemini",label:"Gemini",icon:"fa-google"},{value:"openai",label:"OpenAi",icon:"fa-openai"},{value:"azure_openai",label:"Azure OpenAI",icon:"fab fa-microsoft"},{value:"bedrock",label:"Bedrock",icon:"fab fa-aws"},{value:"openai-responses",label:"OpenAI-Responses",icon:"fa-server"},{value:"ccr",label:"CCR",icon:"fa-code-branch"}]),ze=[{value:"total",label:"累计"},{value:"monthly",label:"本月"},{value:"daily",label:"今日"}],Pe=l=>(K.value[l]||(K.value[l]={items:[],total:0,totalTokens:0,offset:0,hasMore:!0,loading:!1,error:null,initialized:!1,range:"total"}),K.value[l]),s=async(l,{range:a="total",reset:x=!1}={})=>{if(!(l!=null&&l.id))return;const r=Pe(l.id);if(!r.loading&&(x&&(r.items=[],r.offset=0,r.hasMore=!0,r.initialized=!1),!(!r.hasMore&&r.initialized&&!x))){r.loading=!0,r.error=null,r.range=a;try{const D=await O.get(`/admin/accounts/${l.id}/usage-breakdown`,{params:{range:a,limit:20,offset:r.offset}})||{},J=D.items||[];r.items=x?J:[...r.items,...J],r.total=D.total??r.total,r.totalTokens=D.totalTokens??r.totalTokens,r.offset=D.nextOffset??r.offset+J.length,r.hasMore=D.hasMore??!1,r.initialized=!0}catch(L){console.error("Failed to load account usage breakdown:",L),r.error=(L==null?void 0:L.message)||"加载失败"}finally{r.loading=!1}}},Te=(l,a)=>{const x=Pe(l.id);x.range===a&&x.initialized&&!x.error||s(l,{range:a,reset:!0})},pt=l=>{const a=Pe(l.id);!a.hasMore||a.loading||s(l,{range:a.range})},T=l=>{if(!(l!=null&&l.id))return;const a=new Set(P.value);a.has(l.id)?a.delete(l.id):a.add(l.id),P.value=a;const x=Pe(l.id);!x.initialized&&!x.loading&&s(l,{range:x.range,reset:!0});const r=Ce(l.id);P.value.has(l.id)&&r&&!r.initialized&&!r.loading&&mt(l.id)},Re=l=>P.value.has(l),Be=l=>{if(l===""||l===null||l===void 0)return null;const a=Number(l);return Number.isFinite(a)?a:null},ot=(l={})=>({costPerMillion:l.costPerMillion??"",costPerToken:l.costPerToken??"",costPerRequest:l.costPerRequest??"",costPerPoint:l.costPerPoint??"",pointsPerRequest:l.pointsPerRequest??"",pointsPerToken:l.pointsPerToken??""}),Le=(l={})=>({billingType:l.billingType||"standard",costTrackingMode:l.costTrackingMode||"standard",currency:l.currency||"USD",derivedRates:ot(l.derivedRates||{}),relativeEfficiency:l.relativeEfficiency!==null&&l.relativeEfficiency!==void 0?String(l.relativeEfficiency):"",baselineAccountId:l.baselineAccountId||"",confidenceLevel:l.confidenceLevel||"",notes:l.notes||""}),Ze=()=>({billingPeriodStart:"",billingPeriodEnd:"",totalAmount:"",currency:"USD",totalUnits:"",unitName:"",exchangeRate:"",confidenceLevel:"confirmed",dataSource:"manual",documentUrl:"",notes:""}),Qe=()=>({capturedAt:"",balanceUnits:"",unitName:"",currency:"",confidenceLevel:"medium",dataSource:"manual",notes:""}),Ce=l=>l?(c[l]||(c[l]={initialized:!1,loading:!1,error:null,profile:null,form:Le(),editing:!1,saving:!1,bills:[],billsLoading:!1,billsError:null,billFormVisible:!1,billForm:Ze(),billSubmitting:!1,snapshots:[],snapshotsLoading:!1,snapshotsError:null,snapshotFormVisible:!1,snapshotForm:Qe(),snapshotSubmitting:!1}),c[l]):null,nt=[{value:"standard",label:"标准定价"},{value:"manual_billing",label:"账单反推"},{value:"estimated",label:"相对估算"}],gt=[{value:"standard",label:"标准计费"},{value:"points",label:"积分制"},{value:"quota",label:"额度制"}],Kt=[{value:"",label:"未设置"},{value:"high",label:"高"},{value:"medium",label:"中"},{value:"low",label:"低"}],mt=async l=>{const a=Ce(l);if(!(!a||a.loading)){a.loading=!0,a.error=null;try{await Promise.all([it(l),yt(l),xt(l)]),a.initialized=!0}catch(x){a.error=(x==null?void 0:x.message)||"加载成本信息失败"}finally{a.loading=!1}}},it=async l=>{var x;const a=Ce(l);if(a)try{const r=await O.get(`/admin/accounts/${l}/cost-profile`),L=((x=r==null?void 0:r.data)==null?void 0:x.data)||null;a.profile=L,a.form=Le(L||{})}catch(r){throw a.error=(r==null?void 0:r.message)||"加载成本配置失败",r}},yt=async l=>{var x;const a=Ce(l);if(a){a.billsLoading=!0,a.billsError=null;try{const r=await O.get(`/admin/accounts/${l}/bills`,{params:{limit:20}});a.bills=((x=r==null?void 0:r.data)==null?void 0:x.data)||[]}catch(r){a.billsError=(r==null?void 0:r.message)||"加载账单失败"}finally{a.billsLoading=!1}}},xt=async l=>{var x;const a=Ce(l);if(a){a.snapshotsLoading=!0,a.snapshotsError=null;try{const r=await O.get(`/admin/accounts/${l}/balance-snapshots`,{params:{limit:20}});a.snapshots=((x=r==null?void 0:r.data)==null?void 0:x.data)||[]}catch(r){a.snapshotsError=(r==null?void 0:r.message)||"加载余额快照失败"}finally{a.snapshotsLoading=!1}}},He=l=>{const a=Ce(l);a&&(a.form=Le(a.profile||{}),a.editing=!0)},Je=l=>{const a=Ce(l);a&&(a.form=Le(a.profile||{}),a.editing=!1)},b=async l=>{var x,r;const a=Ce(l);if(a){a.saving=!0;try{const L={};Object.entries(a.form.derivedRates||{}).forEach(([re,xe])=>{const me=Be(xe);me!==null&&(L[re]=me)});const D={billingType:a.form.billingType||"standard",costTrackingMode:a.form.costTrackingMode||"standard",currency:a.form.currency||"USD",derivedRates:L,relativeEfficiency:Be(a.form.relativeEfficiency),baselineAccountId:a.form.baselineAccountId||null,confidenceLevel:a.form.confidenceLevel||null,notes:a.form.notes||null,metadata:((x=a.profile)==null?void 0:x.metadata)||{}},J=await O.put(`/admin/accounts/${l}/cost-profile`,D);a.profile=((r=J==null?void 0:J.data)==null?void 0:r.data)||D,a.form=Le(a.profile||{}),a.editing=!1,R("成本配置已保存","success")}catch(L){R(`保存成本配置失败：${(L==null?void 0:L.message)||"未知错误"}`,"error")}finally{a.saving=!1}}},m=l=>{const a=Ce(l);a&&(a.billFormVisible=!a.billFormVisible,a.billFormVisible||(a.billForm=Ze()))},_=async l=>{const a=Ce(l);if(!(!a||a.billSubmitting)){a.billSubmitting=!0;try{const x={billingPeriodStart:a.billForm.billingPeriodStart,billingPeriodEnd:a.billForm.billingPeriodEnd,totalAmount:Number(a.billForm.totalAmount),currency:a.billForm.currency||"USD",totalUnits:Be(a.billForm.totalUnits),unitName:a.billForm.unitName||null,exchangeRate:Be(a.billForm.exchangeRate),confidenceLevel:a.billForm.confidenceLevel||null,dataSource:a.billForm.dataSource||"manual",documentUrl:a.billForm.documentUrl||null,notes:a.billForm.notes||null};if(!x.billingPeriodStart||!x.billingPeriodEnd||!Number.isFinite(x.totalAmount)){R("请填写完整账单信息","warning"),a.billSubmitting=!1;return}await O.post(`/admin/accounts/${l}/bills`,x),R("账单已记录","success"),a.billFormVisible=!1,a.billForm=Ze(),await yt(l),await it(l)}catch(x){R(`记录账单失败：${(x==null?void 0:x.message)||"未知错误"}`,"error")}finally{a.billSubmitting=!1}}},Ie=l=>{const a=Ce(l);a&&(a.snapshotFormVisible=!a.snapshotFormVisible,a.snapshotFormVisible||(a.snapshotForm=Qe()))},zt=async l=>{const a=Ce(l);if(!(!a||a.snapshotSubmitting)){a.snapshotSubmitting=!0;try{const x={capturedAt:a.snapshotForm.capturedAt,balanceUnits:Number(a.snapshotForm.balanceUnits),unitName:a.snapshotForm.unitName||null,currency:a.snapshotForm.currency||null,confidenceLevel:a.snapshotForm.confidenceLevel||null,dataSource:a.snapshotForm.dataSource||"manual",notes:a.snapshotForm.notes||null};if(!x.capturedAt||!Number.isFinite(x.balanceUnits)){R("请填写完整的余额快照信息","warning"),a.snapshotSubmitting=!1;return}await O.post(`/admin/accounts/${l}/balance-snapshots`,x),R("余额快照已记录","success"),a.snapshotFormVisible=!1,a.snapshotForm=Qe(),await xt(l)}catch(x){R(`记录余额快照失败：${(x==null?void 0:x.message)||"未知错误"}`,"error")}finally{a.snapshotSubmitting=!1}}},Zt=l=>{const a=nt.find(x=>x.value===l);return a?a.label:"标准定价"},Pt=l=>{const a=gt.find(x=>x.value===l);return a?a.label:"标准计费"},Xe=(l,a="USD")=>{if(l==null||l==="")return"--";const x=Number(l);return Number.isFinite(x)?`${a} ${x.toFixed(2)}`:"--"},_e=l=>{if(!l)return"--";try{return new Date(l).toISOString().slice(0,10)}catch{return l}},dt=(l,a=4)=>{if(l==null||l==="")return"--";const x=Number(l);return Number.isFinite(x)?x.toFixed(a):"--"},Lt=[{key:"claude",url:"/admin/claude-accounts"},{key:"claude-console",url:"/admin/claude-console-accounts"},{key:"bedrock",url:"/admin/bedrock-accounts"},{key:"gemini",url:"/admin/gemini-accounts"},{key:"openai",url:"/admin/openai-accounts"},{key:"azure_openai",url:"/admin/azure-openai-accounts"},{key:"openai-responses",url:"/admin/openai-responses-accounts"},{key:"ccr",url:"/admin/ccr-accounts"}],jt=Ge(()=>{const l=[{value:"all",label:"所有账户",icon:"fa-globe"},{value:"ungrouped",label:"未分组账户",icon:"fa-user"}];return W.value.forEach(a=>{l.push({value:a.id,label:`${a.name} (${a.platform==="claude"?"Claude":a.platform==="gemini"?"Gemini":"OpenAI"})`,icon:a.platform==="claude"?"fa-brain":a.platform==="gemini"?"fa-robot":"fa-openai"})}),l}),Ke=I(!1),Ee=I(null),qe=I(!1),Ye=I(null),et=Ge(()=>{const l=X.value;return q.value?[...l].sort((x,r)=>{var J,re,xe,me,fe,ve,ye,te,ke,Me,De,z;let L=x[q.value],D=r[q.value];return q.value==="dailyTokens"?(L=((re=(J=x.usage)==null?void 0:J.daily)==null?void 0:re.allTokens)||0,D=((me=(xe=r.usage)==null?void 0:xe.daily)==null?void 0:me.allTokens)||0):q.value==="dailyRequests"?(L=((ve=(fe=x.usage)==null?void 0:fe.daily)==null?void 0:ve.requests)||0,D=((te=(ye=r.usage)==null?void 0:ye.daily)==null?void 0:te.requests)||0):q.value==="totalTokens"&&(L=((Me=(ke=x.usage)==null?void 0:ke.total)==null?void 0:Me.allTokens)||0,D=((z=(De=r.usage)==null?void 0:De.total)==null?void 0:z.allTokens)||0),q.value==="lastUsed"&&(L=x.lastUsedAt?new Date(x.lastUsedAt).getTime():0,D=r.lastUsedAt?new Date(r.lastUsedAt).getTime():0),q.value==="status"&&(L=x.isActive?1:0,D=r.isActive?1:0),L<D?j.value==="asc"?-1:1:L>D?j.value==="asc"?1:-1:0}):l}),Ve=async(l=!1)=>{g.value=!0;try{const a={};let x=ee.value;if(B.value&&B.value!=="all"&&(a.groupId=B.value,x==="all"&&B.value!=="ungrouped")){const z=W.value.find(N=>N.id===B.value);z!=null&&z.platform&&(x=z.platform)}x!=="all"&&(a.platform=x);const r=Lt.map(({key:z,url:N})=>x==="all"||x===z?O.get(N,{params:a}):Promise.resolve({success:!0,data:[]}));await Promise.all([wt(l),Et(l)]),await qt(l);const[L,D,J,re,xe,me,fe,ve]=await Promise.all(r);let ye=[];try{const z=await O.get("/admin/accounts/usage-stats",{params:{range:"total"}});z!=null&&z.success&&(ye=z.data||[])}catch(z){console.error("Failed to load aggregated account usage stats:",z)}const te=[],ke=z=>z!=null&&z.id?z.groupInfos&&z.groupInfos.length>0?(f.value.set(z.id,z.groupInfos),z.groupInfos):f.value.get(z.id)||[]:[];if(L.success){const z=await Promise.all((L.data||[]).map(async N=>{const de=H.value.filter(we=>we.claudeAccountId===N.id).length,he=ke(N);return{...N,platform:"claude",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(D.success){const z=await Promise.all((D.data||[]).map(async N=>{const de=H.value.filter(we=>we.claudeConsoleAccountId===N.id).length,he=ke(N);return{...N,platform:"claude-console",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(J.success){const z=await Promise.all((J.data||[]).map(async N=>{const de=ke(N);return{...N,platform:"bedrock",boundApiKeysCount:0,groupInfos:de}}));te.push(...z)}if(re.success){const z=await Promise.all((re.data||[]).map(async N=>{const de=H.value.filter(we=>we.geminiAccountId===N.id).length,he=ke(N);return{...N,platform:"gemini",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(xe.success){const z=await Promise.all((xe.data||[]).map(async N=>{const de=H.value.filter(we=>we.openaiAccountId===N.id).length,he=ke(N);return{...N,platform:"openai",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(me&&me.success){const z=await Promise.all((me.data||[]).map(async N=>{const de=H.value.filter(we=>we.azureOpenaiAccountId===N.id).length,he=ke(N);return{...N,platform:"azure_openai",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(fe&&fe.success){const z=await Promise.all((fe.data||[]).map(async N=>{const de=H.value.filter(we=>we.openaiAccountId===`responses:${N.id}`).length,he=ke(N);return{...N,platform:"openai-responses",boundApiKeysCount:de,groupInfos:he}}));te.push(...z)}if(ve&&ve.success){const z=await Promise.all((ve.data||[]).map(async N=>{const de=ke(N);return{...N,platform:"ccr",boundApiKeysCount:0,groupInfos:de}}));te.push(...z)}if(ye.length>0){const z=new Map(ye.map(N=>[N.id,N.usage||{}]));te.forEach(N=>{z.has(N.id)&&(N.usage=z.get(N.id)),ft(N)})}else te.forEach(z=>ft(z));let Me=te;if(B.value!=="all")if(B.value==="ungrouped"){const z=te.filter(N=>!N.groupInfos||N.groupInfos.length===0);Me=z.length>0?z:te}else{const z=te.filter(N=>!N.groupInfos||N.groupInfos.length===0?!1:N.groupInfos.some(de=>de.id===B.value));Me=z.length>0?z:te}const De=[...P.value].filter(z=>Me.some(N=>N.id===z));P.value=new Set(De),X.value=Me}catch{R("加载账户失败","error")}finally{g.value=!1}},We=l=>{l&&(q.value===l?j.value=j.value==="asc"?"desc":"asc":(q.value=l,j.value="asc"))},ce=l=>{if(l==null)return"0";const a=Number(l);return a>=1e6?(a/1e6).toFixed(2):a>=1e3?(a/1e6).toFixed(4):(a/1e6).toFixed(6)},tt=l=>{if(l==null)return 0;const a=Number(l);return!Number.isFinite(a)||a<0?0:a},Ot=(l={},a)=>{if(!l||!l.total)return{rpm:0,tpm:0,dailyRequests:0,dailyTokens:0};let x=null;if(a)try{const te=new Date(a);Number.isNaN(te.getTime())||(x=te)}catch{}const r=Date.now(),L=x?x.getTime():r,D=Math.max(0,r-L),J=Math.max(1,D/(24*60*60*1e3)),re=Number(l.total.requests)||0,xe=Number(l.total.allTokens)||0,me=re/J,fe=xe/J,ve=me/(24*60),ye=fe/(24*60);return{rpm:ve,tpm:ye,dailyRequests:me,dailyTokens:fe}},Ft=(l={},a={})=>{const x=Ot(l,a.createdAt||a.created_at),r=l.averages||{};return l.averages={rpm:tt(r.rpm!==void 0?r.rpm:x.rpm),tpm:tt(r.tpm!==void 0?r.tpm:x.tpm),dailyRequests:tt(r.dailyRequests!==void 0?r.dailyRequests:x.dailyRequests),dailyTokens:tt(r.dailyTokens!==void 0?r.dailyTokens:x.dailyTokens)},l.averages},ft=l=>{!l||!l.usage||Ft(l.usage,l.metadata||{})},je=(l,a=2)=>l==null||Number.isNaN(Number(l))?"--":Number(l).toFixed(a),bt=l=>l==null?"--":`$${st(Number(l))}`,ct=l=>l==null||!Number.isFinite(Number(l))||Number(l)<=0?"--":`${ce(Number(l))}M`,vt=l=>l==null||!Number.isFinite(Number(l))||Number(l)<0?"--":`$${st(Number(l))}`,Dt=(l,a)=>{if(a==null)return null;const x=Number(a);if(!Number.isFinite(x)||x<=0)return null;const r=Number(l)||0;return r<=0?null:r/x},Nt=(l,a)=>{const x=Number(l)||0;if(x<=0)return null;const r=Number(a);if(!Number.isFinite(r)||r<0)return null;const L=x/1e6;return L<=0?null:r===0?0:r/L},kt=l=>{var r,L,D,J,re,xe,me,fe,ve;const a=(l==null?void 0:l.usage)||{};return[{key:"daily",title:"今日",subtitle:"今日实时统计",requests:((r=a.daily)==null?void 0:r.requests)||0,tokens:((L=a.daily)==null?void 0:L.allTokens)||0,cost:((D=a.daily)==null?void 0:D.cost)!==void 0?a.daily.cost:null},{key:"monthly",title:"本月",subtitle:"自然月累计",requests:((J=a.monthly)==null?void 0:J.requests)||0,tokens:((re=a.monthly)==null?void 0:re.allTokens)||0,cost:((xe=a.monthly)==null?void 0:xe.cost)!==void 0?a.monthly.cost:null},{key:"total",title:"累计",subtitle:"历史累计",requests:((me=a.total)==null?void 0:me.requests)||0,tokens:((fe=a.total)==null?void 0:fe.allTokens)||0,cost:((ve=a.total)==null?void 0:ve.cost)!==void 0?a.total.cost:null}].map(ye=>({...ye,tokensPerDollar:Dt(ye.tokens,ye.cost),costPerMillion:Nt(ye.tokens,ye.cost)}))},ht=l=>{if(!l)return"从未使用";const a=new Date(l),r=new Date-a;return r<6e4?"刚刚":r<36e5?`${Math.floor(r/6e4)} 分钟前`:r<864e5?`${Math.floor(r/36e5)} 小时前`:r<6048e5?`${Math.floor(r/864e5)} 天前`:a.toLocaleDateString("zh-CN")},wt=async(l=!1)=>{if(!(!l&&se.value))try{const a=await O.get("/admin/api-keys");a.success&&(H.value=a.data||[],se.value=!0)}catch{}},Et=async(l=!1)=>{if(!(!l&&F.value))try{const a=await O.get("/admin/account-groups");a.success&&(W.value=a.data||[],F.value=!0)}catch{}},qt=async(l=!1)=>{if(!(!l&&d.value)){if(f.value.clear(),!W.value||W.value.length===0){d.value=!0;return}try{const a=W.value.map(async x=>{try{const r=await O.get(`/admin/account-groups/${x.id}/members`);r.success&&(r.data||[]).forEach(D=>{if(!(D!=null&&D.id))return;const J=f.value.get(D.id)||[];J.some(re=>re.id===x.id)||J.push({id:x.id,name:x.name,platform:x.platform}),f.value.set(D.id,J)})}catch{}});await Promise.allSettled(a)}finally{d.value=!0}}},Wt=()=>{se.value=!1,F.value=!1,d.value=!1,f.value.clear()},Gt=()=>{Ve()},Bt=()=>{Ve()},ut=l=>{if(!l||!l.host||!l.port)return null;const a=l.type==="socks5"?"S5":l.type.toUpperCase();let x=l.host;x.length>15&&(x=x.substring(0,12)+"...");let r=`${a}://${x}:${l.port}`;return l.username&&(r=`${a}://***@${x}:${l.port}`),r},$t=(l,a)=>{if(!l||!a)return"--";const x=new Date(l),r=new Date(a),L=x.getHours().toString().padStart(2,"0"),D=x.getMinutes().toString().padStart(2,"0"),J=r.getHours().toString().padStart(2,"0"),re=r.getMinutes().toString().padStart(2,"0");return`${L}:${D} - ${J}:${re}`},At=l=>{if(!l||l<=0)return"已结束";const a=Math.floor(l/60),x=l%60;return a>0?`${a}小时${x}分钟`:`${x}分钟`},Qt=l=>{if(!l||l<=0)return"";l=Math.floor(l);const a=Math.floor(l/1440),x=l%1440,r=Math.floor(x/60),L=x%60;return a>0?r>0?`${a}天${r}小时`:`${a}天`:r>0?L>0?`${r}小时${L}分钟`:`${r}小时`:`${L}分钟`},u=()=>{Ee.value=null,Ke.value=!0},t=()=>{Ke.value=!1,Ee.value=null},i=l=>{Ye.value=l,qe.value=!0},Y=async l=>{const x=H.value.filter(D=>D.claudeAccountId===l.id||D.claudeConsoleAccountId===l.id||D.geminiAccountId===l.id||D.openaiAccountId===l.id||D.azureOpenaiAccountId===l.id||D.openaiAccountId===`responses:${l.id}`).length;let r=`确定要删除账户 "${l.name}" 吗？`;if(x>0&&(r+=`

⚠️ 注意：此账号有 ${x} 个 API Key 绑定。`,r+=`
删除后，这些 API Key 将自动切换为共享池模式。`),r+=`

此操作不可恢复。`,!!await ge("删除账户",r,"删除","取消"))try{let D;l.platform==="claude"?D=`/admin/claude-accounts/${l.id}`:l.platform==="claude-console"?D=`/admin/claude-console-accounts/${l.id}`:l.platform==="bedrock"?D=`/admin/bedrock-accounts/${l.id}`:l.platform==="openai"?D=`/admin/openai-accounts/${l.id}`:l.platform==="azure_openai"?D=`/admin/azure-openai-accounts/${l.id}`:l.platform==="openai-responses"?D=`/admin/openai-responses-accounts/${l.id}`:l.platform==="ccr"?D=`/admin/ccr-accounts/${l.id}`:D=`/admin/gemini-accounts/${l.id}`;const J=await O.delete(D);if(J.success){let re="账户已成功删除";J.unboundKeys>0&&(re+=`，${J.unboundKeys} 个 API Key 已切换为共享池模式`),R(re,"success"),d.value=!1,se.value=!1,Ve(),wt(!0)}else R(J.message||"删除失败","error")}catch{R("删除失败","error")}},Q=async l=>{if(l.isResetting)return;let a=!1;if(window.showConfirm?a=await window.showConfirm("重置账户状态","确定要重置此账户的所有异常状态吗？这将清除限流状态、401错误计数等所有异常标记。","确定重置","取消"):a=confirm("确定要重置此账户的所有异常状态吗？"),!!a)try{l.isResetting=!0;let x="";if(l.platform==="openai")x=`/admin/openai-accounts/${l.id}/reset-status`;else if(l.platform==="openai-responses")x=`/admin/openai-responses-accounts/${l.id}/reset-status`;else if(l.platform==="claude")x=`/admin/claude-accounts/${l.id}/reset-status`;else if(l.platform==="claude-console")x=`/admin/claude-console-accounts/${l.id}/reset-status`;else if(l.platform==="ccr")x=`/admin/ccr-accounts/${l.id}/reset-status`;else{R("不支持的账户类型","error"),l.isResetting=!1;return}const r=await O.post(x);r.success?(R("账户状态已重置","success"),Ve(!0)):R(r.message||"状态重置失败","error")}catch{R("状态重置失败","error")}finally{l.isResetting=!1}},Se=async l=>{if(!l.isTogglingSchedulable)try{l.isTogglingSchedulable=!0;let a;if(l.platform==="claude")a=`/admin/claude-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="claude-console")a=`/admin/claude-console-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="bedrock")a=`/admin/bedrock-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="gemini")a=`/admin/gemini-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="openai")a=`/admin/openai-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="azure_openai")a=`/admin/azure-openai-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="openai-responses")a=`/admin/openai-responses-accounts/${l.id}/toggle-schedulable`;else if(l.platform==="ccr")a=`/admin/ccr-accounts/${l.id}/toggle-schedulable`;else{R("该账户类型暂不支持调度控制","warning");return}const x=await O.put(a);x.success?(l.schedulable=x.schedulable,R(x.schedulable?"已启用调度":"已禁用调度","success")):R(x.message||"操作失败","error")}catch{R("切换调度状态失败","error")}finally{l.isTogglingSchedulable=!1}},S=()=>{Ke.value=!1,R("账户创建成功","success"),Wt(),Ve()},C=()=>{qe.value=!1,R("账户更新成功","success"),d.value=!1,Ve()},ne=l=>!l.lastRefreshAt||l.lastRefreshAt===""?"Setup":"OAuth",ie=()=>"OAuth",pe=()=>"OAuth",Oe=l=>{if(l.subscriptionInfo)try{const a=typeof l.subscriptionInfo=="string"?JSON.parse(l.subscriptionInfo):l.subscriptionInfo;return a.hasClaudeMax===!0?"Claude Max":a.hasClaudePro===!0?"Claude Pro":"Claude Free"}catch{return"Claude"}return"Claude"},ns=l=>{if(l.schedulable!==!1)return null;if(l.platform==="claude-console"){if(l.status==="unauthorized")return"API Key无效或已过期（401错误）";if(l.overloadStatus==="overloaded")return"服务过载（529错误）";if(l.rateLimitStatus==="limited")return"触发限流（429错误）";if(l.status==="blocked"&&l.errorMessage)return l.errorMessage}if(l.platform==="claude"){if(l.status==="unauthorized")return"认证失败（401错误）";if(l.status==="temp_error"&&l.errorMessage||l.status==="error"&&l.errorMessage)return l.errorMessage;if(l.isRateLimited)return"触发限流（429错误）";if(l.stoppedReason)return l.stoppedReason}if(l.platform==="openai"){if(l.status==="unauthorized")return"认证失败（401错误）";if(l.rateLimitStatus&&l.rateLimitStatus.isRateLimited||l.isRateLimited)return"触发限流（429错误）";if(l.status==="error"&&l.errorMessage)return l.errorMessage}if(l.platform==="openai-responses"){if(l.status==="unauthorized")return"认证失败（401错误）";if(l.rateLimitStatus&&l.rateLimitStatus.isRateLimited||l.isRateLimited)return"触发限流（429错误）";if(l.status==="error"&&l.errorMessage)return l.errorMessage;if(l.status==="rateLimited")return"触发限流（429错误）"}return l.stoppedReason?l.stoppedReason:l.errorMessage?l.errorMessage:"手动停止调度"},Ms=l=>l.status==="blocked"?"已封锁":l.status==="unauthorized"?"异常":l.isRateLimited||l.status==="rate_limited"||l.rateLimitStatus&&l.rateLimitStatus.isRateLimited||l.rateLimitStatus==="limited"?"限流中":l.status==="temp_error"?"临时异常":l.status==="error"||!l.isActive?"错误":l.schedulable===!1?"已暂停":"正常",Rs=l=>l.status==="blocked"||l.status==="unauthorized"?"bg-red-100 text-red-800":l.isRateLimited||l.status==="rate_limited"||l.rateLimitStatus&&l.rateLimitStatus.isRateLimited||l.rateLimitStatus==="limited"||l.status==="temp_error"?"bg-orange-100 text-orange-800":l.status==="error"||!l.isActive?"bg-red-100 text-red-800":l.schedulable===!1?"bg-gray-100 text-gray-800":"bg-green-100 text-green-800",Ks=l=>l.status==="blocked"||l.status==="unauthorized"?"bg-red-500":l.isRateLimited||l.status==="rate_limited"||l.rateLimitStatus&&l.rateLimitStatus.isRateLimited||l.rateLimitStatus==="limited"||l.status==="temp_error"?"bg-orange-500":l.status==="error"||!l.isActive?"bg-red-500":l.schedulable===!1?"bg-gray-500":"bg-green-500",is=l=>ht(l),ds=(l,a=null)=>{if(!l)return"bg-gradient-to-r from-blue-500 to-indigo-600";if(a&&(a.isRateLimited||a.status==="rate_limited"||a.rateLimitStatus&&a.rateLimitStatus.isRateLimited||a.rateLimitStatus==="limited"))return"bg-gradient-to-r from-red-500 to-red-600";const r=String(l).toLowerCase();return r==="rejected"?"bg-gradient-to-r from-red-500 to-red-600":r==="allowed_warning"?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-blue-500 to-indigo-600"},zs={primary:"主窗口",secondary:"备用窗口"},Xt=l=>{const a=Number(l);return Number.isFinite(a)?a<0?0:a>9999?9999:a:null},us=l=>{const a=Xt(l)??0;return a>=100||a>=90?"bg-red-500":a>=75?"bg-yellow-500":"bg-green-500"},ps=l=>{const a=Xt(l);return a===null?"0%":`${Math.min(100,a)}%`},gs=l=>{const a=Xt(l);return a===null?"--":a>=100?"100%+":a>=10?`${a.toFixed(1)}%`:`${a.toFixed(2)}%`},ms=l=>zs[l]||"窗口",ys=l=>{if(!l)return"--";const a=Number(l.remainingSeconds);if(Number.isFinite(a)){const x=Math.max(0,Math.floor(a));if(x<=0)return"即将重置";const r=Math.floor(x/3600),L=Math.floor(x%3600/60);return r>0?`${r}小时${L>0?`${L}分钟`:""}`.trim():L>0?`${L}分钟`:`${Math.max(1,x)}秒`}if(l.resetAt)try{const x=new Date(l.resetAt);if(!Number.isNaN(x.getTime()))return x.toLocaleString("zh-CN",{hour12:!1})}catch{}return"--"},st=l=>!l||l===0?"0.0000":l<1e-4?l.toExponential(2):l<.01?l.toFixed(6):l<1?l.toFixed(4):l.toFixed(2),es=l=>{var r,L;const a=Number(((L=(r=l==null?void 0:l.usage)==null?void 0:r.daily)==null?void 0:L.cost)||0),x=Number((l==null?void 0:l.dailyQuota)||0);return!x||x<=0?0:a/x*100},Ps=l=>l>=90?"bg-red-500":l>=70?"bg-yellow-500":"bg-green-500",Ls=l=>{var r,L;const a=Number(((L=(r=l==null?void 0:l.usage)==null?void 0:r.daily)==null?void 0:L.cost)||0),x=Number((l==null?void 0:l.dailyQuota)||0);return!x||x<=0?"0.00":Math.max(0,x-a).toFixed(2)},xs=l=>!l.usage||!l.usage.daily?"0.0000":l.usage.daily.cost!==void 0?st(l.usage.daily.cost):"0.0000";return le(w,l=>{const a={name:"name",dailyTokens:"dailyTokens",dailyRequests:"dailyRequests",totalTokens:"totalTokens",lastUsed:"lastUsed"};a[l]&&We(a[l])}),Yt(()=>{Ve(!0)}),(l,a)=>{const x=js;return o(),n("div",Ad,[e("div",Cd,[e("div",Ud,[a[20]||(a[20]=e("div",null,[e("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," 账户管理 "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"}," 管理您的 Claude、Gemini、OpenAI、Azure OpenAI、OpenAI-Responses 与 CCR 账户及代理配置 ")],-1)),e("div",Td,[e("div",Id,[e("div",_d,[a[14]||(a[14]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-indigo-500 to-blue-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),Fe(ss,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=r=>w.value=r),icon:"fa-sort-amount-down","icon-color":"text-indigo-500",options:U.value,placeholder:"选择排序",onChange:a[1]||(a[1]=r=>We())},null,8,["modelValue","options"])]),e("div",Vd,[a[15]||(a[15]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),Fe(ss,{modelValue:ee.value,"onUpdate:modelValue":a[2]||(a[2]=r=>ee.value=r),icon:"fa-server","icon-color":"text-blue-500",options:E.value,placeholder:"选择平台",onChange:Gt},null,8,["modelValue","options"])]),e("div",Sd,[a[16]||(a[16]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),Fe(ss,{modelValue:B.value,"onUpdate:modelValue":a[3]||(a[3]=r=>B.value=r),icon:"fa-layer-group","icon-color":"text-purple-500",options:jt.value,placeholder:"选择分组",onChange:Bt},null,8,["modelValue","options"])]),e("div",Md,[Fe(x,{content:"刷新数据 (Ctrl/⌘+点击强制刷新所有缓存)",effect:"dark",placement:"bottom"},{default:Mt(()=>[e("button",{class:"group relative flex items-center justify-center gap-2 rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm transition-all duration-200 hover:border-gray-300 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:border-gray-500 sm:w-auto",disabled:g.value,onClick:[a[4]||(a[4]=at(r=>Ve(!0),["ctrl","exact"])),a[5]||(a[5]=at(r=>Ve(!1),["exact"])),a[6]||(a[6]=at(r=>Ve(!0),["meta","exact"]))]},[a[17]||(a[17]=e("div",{class:"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-green-500 to-teal-500 opacity-0 blur transition duration-300 group-hover:opacity-20"},null,-1)),e("i",{class:M(["fas relative text-green-500",g.value?"fa-spinner fa-spin":"fa-sync-alt"])},null,2),a[18]||(a[18]=e("span",{class:"relative"},"刷新",-1))],8,Rd)]),_:1})])]),e("button",{class:"flex w-full items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-green-500 to-green-600 px-5 py-2.5 text-sm font-medium text-white shadow-md transition-all duration-200 hover:from-green-600 hover:to-green-700 hover:shadow-lg sm:w-auto",onClick:at(u,["stop"])},a[19]||(a[19]=[e("i",{class:"fas fa-plus"},null,-1),e("span",null,"添加账户",-1)]))])]),g.value?(o(),n("div",Kd,a[21]||(a[21]=[e("div",{class:"loading-spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载账户...",-1)]))):et.value.length===0?(o(),n("div",zd,a[22]||(a[22]=[e("div",{class:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-700"},[e("i",{class:"fas fa-user-circle text-xl text-gray-400"})],-1),e("p",{class:"text-lg text-gray-500 dark:text-gray-400"},"暂无账户",-1),e("p",{class:"mt-2 text-sm text-gray-400 dark:text-gray-500"},"点击上方按钮添加您的第一个账户",-1)]))):(o(),n("div",Pd,[e("table",Ld,[e("thead",jd,[e("tr",null,[e("th",{class:"w-[20%] min-w-[180px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600",onClick:a[7]||(a[7]=r=>We("name"))},[a[23]||(a[23]=$(" 名称 ",-1)),q.value==="name"?(o(),n("i",{key:0,class:M(["fas",j.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(o(),n("i",Od))]),a[30]||(a[30]=e("th",{class:"w-[16%] min-w-[160px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 分组 ",-1)),e("th",{class:"w-[15%] min-w-[120px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600",onClick:a[8]||(a[8]=r=>We("platform"))},[a[24]||(a[24]=$(" 平台/类型 ",-1)),q.value==="platform"?(o(),n("i",{key:0,class:M(["fas",j.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(o(),n("i",Fd))]),e("th",{class:"w-[12%] min-w-[100px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600",onClick:a[9]||(a[9]=r=>We("status"))},[a[25]||(a[25]=$(" 状态 ",-1)),q.value==="status"?(o(),n("i",{key:0,class:M(["fas",j.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(o(),n("i",Dd))]),e("th",{class:"w-[8%] min-w-[80px] cursor-pointer px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-600",onClick:a[10]||(a[10]=r=>We("priority"))},[a[26]||(a[26]=$(" 优先级 ",-1)),q.value==="priority"?(o(),n("i",{key:0,class:M(["fas",j.value==="asc"?"fa-sort-up":"fa-sort-down","ml-1"])},null,2)):(o(),n("i",Nd))]),a[31]||(a[31]=e("th",{class:"w-[10%] min-w-[100px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 代理 ",-1)),a[32]||(a[32]=e("th",{class:"w-[10%] min-w-[90px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 今日使用 ",-1)),a[33]||(a[33]=e("th",{class:"w-[10%] min-w-[100px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 总用量 ",-1)),e("th",Ed,[e("div",qd,[a[29]||(a[29]=e("span",null,"会话窗口",-1)),Fe(x,{placement:"top"},{content:Mt(()=>a[27]||(a[27]=[e("div",{class:"space-y-2"},[e("div",null,"会话窗口进度表示5小时窗口的时间进度"),e("div",{class:"space-y-1 text-xs"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"h-2 w-16 rounded bg-gradient-to-r from-blue-500 to-indigo-600"}),e("span",null,"正常：请求正常处理")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"h-2 w-16 rounded bg-gradient-to-r from-yellow-500 to-orange-500"}),e("span",null,"警告：接近限制")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"h-2 w-16 rounded bg-gradient-to-r from-red-500 to-red-600"}),e("span",null,"拒绝：达到速率限制")])])],-1)])),default:Mt(()=>[a[28]||(a[28]=e("i",{class:"fas fa-question-circle cursor-help text-xs text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400"},null,-1))]),_:1,__:[28]})])]),a[34]||(a[34]=e("th",{class:"w-[8%] min-w-[80px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 最后使用 ",-1)),a[35]||(a[35]=e("th",{class:"w-[15%] min-w-[180px] px-3 py-4 text-left text-xs font-bold uppercase tracking-wider text-gray-700 dark:text-gray-300"}," 操作 ",-1))])]),e("tbody",Wd,[(o(!0),n(ae,null,ue(et.value,r=>{var L,D,J,re,xe,me,fe,ve,ye,te,ke,Me,De,z,N,de,he,we,Ct,Ut,Tt,It,Z,_t,Vt,St,ts,fs,bs,cs,vs,ks,hs,ws;return o(),n(ae,{key:r.id},[e("tr",Gd,[e("td",Bd,[e("div",Qd,[a[39]||(a[39]=e("div",{class:"mr-2 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-gradient-to-br from-green-500 to-green-600"},[e("i",{class:"fas fa-user-circle text-xs text-white"})],-1)),e("div",Hd,[e("div",Jd,[e("div",{class:"truncate text-sm font-semibold text-gray-900 dark:text-gray-100",title:r.name},p(r.name),9,Yd),r.accountType==="dedicated"?(o(),n("span",Zd,a[36]||(a[36]=[e("i",{class:"fas fa-lock mr-1"},null,-1),$("专属 ",-1)]))):r.accountType==="group"?(o(),n("span",Xd,a[37]||(a[37]=[e("i",{class:"fas fa-layer-group mr-1"},null,-1),$("分组调度 ",-1)]))):(o(),n("span",e0,a[38]||(a[38]=[e("i",{class:"fas fa-share-alt mr-1"},null,-1),$("共享 ",-1)])))]),e("div",{class:"truncate text-xs text-gray-500 dark:text-gray-400",title:r.id},p(r.id),9,t0)])])]),e("td",s0,[e("div",a0,[r.groupInfos&&r.groupInfos.length>0?(o(!0),n(ae,{key:0},ue(r.groupInfos,h=>(o(),n("span",{key:h.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600 dark:bg-gray-700 dark:text-gray-400",title:`所属分组: ${h.name}`},[a[40]||(a[40]=e("i",{class:"fas fa-folder mr-1"},null,-1)),$(p(h.name),1)],8,r0))),128)):(o(),n("span",l0,a[41]||(a[41]=[e("i",{class:"fas fa-user mr-1"},null,-1),$("未分组 ",-1)])))])]),e("td",o0,[e("div",n0,[r.platform==="gemini"?(o(),n("div",i0,[a[42]||(a[42]=e("i",{class:"fas fa-robot text-xs text-yellow-700"},null,-1)),a[43]||(a[43]=e("span",{class:"text-xs font-semibold text-yellow-800"},"Gemini",-1)),a[44]||(a[44]=e("span",{class:"mx-1 h-4 w-px bg-yellow-300"},null,-1)),e("span",d0,p(ie()),1)])):r.platform==="claude-console"?(o(),n("div",u0,a[45]||(a[45]=[e("i",{class:"fas fa-terminal text-xs text-purple-700"},null,-1),e("span",{class:"text-xs font-semibold text-purple-800"},"Console",-1),e("span",{class:"mx-1 h-4 w-px bg-purple-300"},null,-1),e("span",{class:"text-xs font-medium text-purple-700"},"API Key",-1)]))):r.platform==="bedrock"?(o(),n("div",p0,a[46]||(a[46]=[e("i",{class:"fab fa-aws text-xs text-orange-700"},null,-1),e("span",{class:"text-xs font-semibold text-orange-800"},"Bedrock",-1),e("span",{class:"mx-1 h-4 w-px bg-orange-300"},null,-1),e("span",{class:"text-xs font-medium text-orange-700"},"AWS",-1)]))):r.platform==="openai"?(o(),n("div",g0,[a[47]||(a[47]=e("div",{class:"fa-openai"},null,-1)),a[48]||(a[48]=e("span",{class:"text-xs font-semibold text-gray-950"},"OpenAi",-1)),a[49]||(a[49]=e("span",{class:"mx-1 h-4 w-px bg-gray-400"},null,-1)),e("span",m0,p(pe()),1)])):r.platform==="azure_openai"?(o(),n("div",y0,a[50]||(a[50]=[e("i",{class:"fab fa-microsoft text-xs text-blue-700 dark:text-blue-400"},null,-1),e("span",{class:"text-xs font-semibold text-blue-800 dark:text-blue-300"},"Azure OpenAI",-1),e("span",{class:"mx-1 h-4 w-px bg-blue-300 dark:bg-blue-600"},null,-1),e("span",{class:"text-xs font-medium text-blue-700 dark:text-blue-400"},"API Key",-1)]))):r.platform==="openai-responses"?(o(),n("div",x0,a[51]||(a[51]=[e("i",{class:"fas fa-server text-xs text-teal-700 dark:text-teal-400"},null,-1),e("span",{class:"text-xs font-semibold text-teal-800 dark:text-teal-300"},"OpenAI-Responses",-1),e("span",{class:"mx-1 h-4 w-px bg-teal-300 dark:bg-teal-600"},null,-1),e("span",{class:"text-xs font-medium text-teal-700 dark:text-teal-400"},"API Key",-1)]))):r.platform==="claude"||r.platform==="claude-oauth"?(o(),n("div",f0,[a[52]||(a[52]=e("i",{class:"fas fa-brain text-xs text-indigo-700"},null,-1)),e("span",b0,p(Oe(r)),1),a[53]||(a[53]=e("span",{class:"mx-1 h-4 w-px bg-indigo-300"},null,-1)),e("span",c0,p(ne(r)),1)])):r.platform==="ccr"?(o(),n("div",v0,a[54]||(a[54]=[e("i",{class:"fas fa-code-branch text-xs text-teal-700 dark:text-teal-400"},null,-1),e("span",{class:"text-xs font-semibold text-teal-800 dark:text-teal-300"},"CCR",-1),e("span",{class:"mx-1 h-4 w-px bg-teal-300 dark:bg-teal-600"},null,-1),e("span",{class:"text-xs font-medium text-teal-700 dark:text-teal-300"},"Relay",-1)]))):(o(),n("div",k0,a[55]||(a[55]=[e("i",{class:"fas fa-question text-xs text-gray-700"},null,-1),e("span",{class:"text-xs font-semibold text-gray-800"},"未知",-1)])))])]),e("td",h0,[e("div",w0,[e("span",{class:M(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",r.status==="blocked"?"bg-orange-100 text-orange-800":r.status==="unauthorized"?"bg-red-100 text-red-800":r.status==="temp_error"?"bg-orange-100 text-orange-800":r.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("div",{class:M(["mr-2 h-2 w-2 rounded-full",r.status==="blocked"?"bg-orange-500":r.status==="unauthorized"?"bg-red-500":r.status==="temp_error"?"bg-orange-500":r.isActive?"bg-green-500":"bg-red-500"])},null,2),$(" "+p(r.status==="blocked"?"已封锁":r.status==="unauthorized"?"异常":r.status==="temp_error"?"临时异常":r.isActive?"正常":"异常"),1)],2),r.rateLimitStatus&&r.rateLimitStatus.isRateLimited||r.rateLimitStatus==="limited"?(o(),n("span",$0,[a[56]||(a[56]=e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1)),a[57]||(a[57]=$(" 限流中 ",-1)),r.rateLimitStatus&&typeof r.rateLimitStatus=="object"&&r.rateLimitStatus.minutesRemaining>0?(o(),n("span",A0,"("+p(Qt(r.rateLimitStatus.minutesRemaining))+")",1)):k("",!0)])):k("",!0),r.schedulable===!1?(o(),n("span",C0,[a[59]||(a[59]=e("i",{class:"fas fa-pause-circle mr-1"},null,-1)),a[60]||(a[60]=$(" 不可调度 ",-1)),ns(r)?(o(),Ne(x,{key:0,content:ns(r),effect:"dark",placement:"top"},{default:Mt(()=>a[58]||(a[58]=[e("i",{class:"fas fa-question-circle ml-1 cursor-help text-gray-500"},null,-1)])),_:2,__:[58]},1032,["content"])):k("",!0)])):k("",!0),r.status==="blocked"&&r.errorMessage?(o(),n("span",{key:2,class:"mt-1 max-w-xs truncate text-xs text-gray-500 dark:text-gray-400",title:r.errorMessage},p(r.errorMessage),9,U0)):k("",!0),r.accountType==="dedicated"?(o(),n("span",T0," 绑定: "+p(r.boundApiKeysCount||0)+" 个API Key ",1)):k("",!0)])]),e("td",I0,[r.platform==="claude"||r.platform==="claude-console"||r.platform==="bedrock"||r.platform==="gemini"||r.platform==="openai"||r.platform==="openai-responses"||r.platform==="azure_openai"||r.platform==="ccr"?(o(),n("div",_0,[e("div",V0,[e("div",{class:"h-2 rounded-full bg-gradient-to-r from-green-500 to-blue-600 transition-all duration-300",style:lt({width:101-(r.priority||50)+"%"})},null,4)]),e("span",S0,p(r.priority||50),1)])):(o(),n("div",M0,a[61]||(a[61]=[e("span",{class:"text-xs"},"N/A",-1)])))]),e("td",R0,[ut(r.proxy)?(o(),n("div",{key:0,class:"break-all rounded bg-blue-50 px-2 py-1 font-mono text-xs",title:ut(r.proxy)},p(ut(r.proxy)),9,K0)):(o(),n("div",z0,"无代理"))]),e("td",P0,[r.usage&&r.usage.daily?(o(),n("div",L0,[e("div",j0,[a[62]||(a[62]=e("div",{class:"h-2 w-2 rounded-full bg-blue-500"},null,-1)),e("span",O0,p(r.usage.daily.requests||0)+" 次",1)]),e("div",F0,[a[63]||(a[63]=e("div",{class:"h-2 w-2 rounded-full bg-purple-500"},null,-1)),e("span",D0,p(ce(r.usage.daily.allTokens||0))+"M",1)]),e("div",N0,[a[64]||(a[64]=e("div",{class:"h-2 w-2 rounded-full bg-green-500"},null,-1)),e("span",E0,"$"+p(xs(r)),1)]),r.usage.averages&&r.usage.averages.rpm>0?(o(),n("div",q0," 平均 "+p(r.usage.averages.rpm.toFixed(2))+" RPM ",1)):k("",!0)])):(o(),n("div",W0,"暂无数据"))]),e("td",G0,[r.usage&&r.usage.total?(o(),n("div",B0,[e("div",Q0,[a[65]||(a[65]=e("div",{class:"h-2 w-2 rounded-full bg-blue-600"},null,-1)),e("span",H0,p(r.usage.total.requests||0)+" 次",1)]),e("div",J0,[a[66]||(a[66]=e("div",{class:"h-2 w-2 rounded-full bg-purple-600"},null,-1)),e("span",Y0,p(ce(r.usage.total.allTokens||0))+"M",1)]),e("div",Z0,[a[67]||(a[67]=e("div",{class:"h-2 w-2 rounded-full bg-emerald-500"},null,-1)),e("span",X0,"平均每日 "+p(je((D=(L=r.usage)==null?void 0:L.averages)==null?void 0:D.dailyRequests))+" 次",1)])])):(o(),n("div",eu,"暂无数据"))]),e("td",tu,[r.platform==="claude"&&r.sessionWindow&&r.sessionWindow.hasActiveWindow?(o(),n("div",su,[r.usage&&r.usage.sessionWindow?(o(),n("div",au,[e("div",ru,[a[68]||(a[68]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-purple-500"},null,-1)),e("span",lu,p(ce(r.usage.sessionWindow.totalTokens))+"M ",1)]),e("div",ou,[a[69]||(a[69]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-green-500"},null,-1)),e("span",nu," $"+p(st(r.usage.sessionWindow.totalCost)),1)])])):k("",!0),e("div",iu,[e("div",du,[e("div",{class:M(["h-2 rounded-full transition-all duration-300",ds(r.sessionWindow.sessionWindowStatus,r)]),style:lt({width:r.sessionWindow.progress+"%"})},null,6)]),e("span",uu,p(r.sessionWindow.progress)+"% ",1)]),e("div",pu,[e("div",null,p($t(r.sessionWindow.windowStart,r.sessionWindow.windowEnd)),1),r.sessionWindow.remainingTime>0?(o(),n("div",gu," 剩余 "+p(At(r.sessionWindow.remainingTime)),1)):k("",!0)])])):r.platform==="claude-console"?(o(),n("div",mu,[Number(r.dailyQuota)>0?(o(),n("div",yu,[e("div",xu,[a[70]||(a[70]=e("span",{class:"text-gray-600 dark:text-gray-300"},"额度进度",-1)),e("span",fu,p(es(r).toFixed(1))+"% ",1)]),e("div",bu,[e("div",cu,[e("div",{class:M(["h-2 rounded-full transition-all duration-300",Ps(es(r))]),style:lt({width:Math.min(100,es(r))+"%"})},null,6)]),e("span",vu," $"+p(st(((re=(J=r.usage)==null?void 0:J.daily)==null?void 0:re.cost)||0))+" / $"+p(Number(r.dailyQuota).toFixed(2)),1)]),e("div",ku,[$(" 剩余 $"+p(Ls(r))+" ",1),e("span",hu,"重置 "+p(r.quotaResetTime||"00:00"),1)])])):(o(),n("div",wu,a[71]||(a[71]=[e("i",{class:"fas fa-minus"},null,-1)])))])):r.platform==="claude"?(o(),n("div",$u,a[72]||(a[72]=[e("i",{class:"fas fa-minus"},null,-1)]))):r.platform==="openai"?(o(),n("div",Au,[r.codexUsage?(o(),n("div",Cu,[e("div",Uu,[e("div",Tu,[e("span",Iu,p(ms("primary")),1),e("div",_u,[e("div",Vu,[e("div",Su,[e("div",{class:M(["h-2 rounded-full transition-all duration-300",us(r.codexUsage.primary.usedPercent)]),style:lt({width:ps(r.codexUsage.primary.usedPercent)})},null,6)]),e("span",Mu,p(gs(r.codexUsage.primary.usedPercent)),1)])])]),e("div",Ru," 重置剩余 "+p(ys(r.codexUsage.primary)),1)]),e("div",Ku,[e("div",zu,[e("span",Pu,p(ms("secondary")),1),e("div",Lu,[e("div",ju,[e("div",Ou,[e("div",{class:M(["h-2 rounded-full transition-all duration-300",us(r.codexUsage.secondary.usedPercent)]),style:lt({width:ps(r.codexUsage.secondary.usedPercent)})},null,6)]),e("span",Fu,p(gs(r.codexUsage.secondary.usedPercent)),1)])])]),e("div",Du," 重置剩余 "+p(ys(r.codexUsage.secondary)),1)])])):(o(),n("div",Nu,a[73]||(a[73]=[e("span",{class:"text-xs"},"N/A",-1)])))])):(o(),n("div",Eu,a[74]||(a[74]=[e("span",{class:"text-xs"},"N/A",-1)])))]),e("td",qu,p(ht(r.lastUsedAt)),1),e("td",Wu,[e("div",Gu,[e("button",{class:M(["rounded px-2.5 py-1 text-xs font-medium transition-colors",Re(r.id)?"bg-indigo-600 text-white hover:bg-indigo-500":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"]),title:Re(r.id)?"收起详情":"查看详情统计",onClick:h=>T(r)},[e("i",{class:M(["fas",Re(r.id)?"fa-chevron-up":"fa-info-circle"])},null,2),e("span",Qu,p(Re(r.id)?"收起":"详情"),1)],10,Bu),(r.platform==="claude"||r.platform==="claude-console"||r.platform==="openai"||r.platform==="openai-responses")&&(r.status==="unauthorized"||r.status!=="active"||(xe=r.rateLimitStatus)!=null&&xe.isRateLimited||r.rateLimitStatus==="limited"||!r.isActive)?(o(),n("button",{key:0,class:M(["rounded px-2.5 py-1 text-xs font-medium transition-colors",r.isResetting?"cursor-not-allowed bg-gray-100 text-gray-400":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"]),disabled:r.isResetting,title:r.isResetting?"重置中...":"重置所有异常状态",onClick:h=>Q(r)},[e("i",{class:M(["fas fa-redo",r.isResetting?"animate-spin":""])},null,2),a[75]||(a[75]=e("span",{class:"ml-1"},"重置状态",-1))],10,Hu)):k("",!0),e("button",{class:M(["rounded px-2.5 py-1 text-xs font-medium transition-colors",r.isTogglingSchedulable?"cursor-not-allowed bg-gray-100 text-gray-400":r.schedulable?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"]),disabled:r.isTogglingSchedulable,title:r.schedulable?"点击禁用调度":"点击启用调度",onClick:h=>Se(r)},[e("i",{class:M(["fas",r.schedulable?"fa-toggle-on":"fa-toggle-off"])},null,2),e("span",Yu,p(r.schedulable?"调度":"停用"),1)],10,Ju),e("button",{class:"rounded bg-blue-100 px-2.5 py-1 text-xs font-medium text-blue-700 transition-colors hover:bg-blue-200",title:"编辑账户",onClick:h=>i(r)},a[76]||(a[76]=[e("i",{class:"fas fa-edit"},null,-1),e("span",{class:"ml-1"},"编辑",-1)]),8,Zu),e("button",{class:"rounded bg-red-100 px-2.5 py-1 text-xs font-medium text-red-700 transition-colors hover:bg-red-200",title:"删除账户",onClick:h=>Y(r)},a[77]||(a[77]=[e("i",{class:"fas fa-trash"},null,-1),e("span",{class:"ml-1"},"删除",-1)]),8,Xu)])])]),Re(r.id)?(o(),n("tr",ep,[e("td",tp,[e("div",sp,[(o(!0),n(ae,null,ue(kt(r),h=>(o(),n("div",{key:h.key,class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-900/80"},[e("div",ap,[e("span",rp,p(h.title)+"使用 ",1),e("span",lp,p(h.subtitle),1)]),e("div",op,[e("div",np,[a[78]||(a[78]=e("span",null,"请求数",-1)),e("span",ip,p(h.requests),1)]),e("div",dp,[a[79]||(a[79]=e("span",null,"Tokens",-1)),e("span",up,p(ce(h.tokens))+"M ",1)]),e("div",pp,[a[80]||(a[80]=e("span",null,"费用",-1)),e("span",gp,p(bt(h.cost)),1)]),e("div",mp,[a[81]||(a[81]=e("span",null,"Tokens / $",-1)),e("span",yp,p(ct(h.tokensPerDollar)),1)]),e("div",xp,[a[82]||(a[82]=e("span",null,"$ / 1M Tokens",-1)),e("span",fp,p(vt(h.costPerMillion)),1)])])]))),128))]),e("div",bp,[e("span",null,"平均 RPM："+p(je((fe=(me=r.usage)==null?void 0:me.averages)==null?void 0:fe.rpm)),1),e("span",null,"平均 TPM："+p(je((ye=(ve=r.usage)==null?void 0:ve.averages)==null?void 0:ye.tpm)),1),e("span",null,"平均每日请求："+p(je((ke=(te=r.usage)==null?void 0:te.averages)==null?void 0:ke.dailyRequests)),1),e("span",null,"平均每日 Tokens："+p(ce(((De=(Me=r.usage)==null?void 0:Me.averages)==null?void 0:De.dailyTokens)||0))+"M",1)]),c[r.id]?(o(),n("div",cp,[e("div",vp,[e("div",kp,[e("div",null,[a[83]||(a[83]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"成本配置",-1)),(z=c[r.id].profile)!=null&&z.confidenceLevel?(o(),n("span",hp," 置信度："+p(c[r.id].profile.confidenceLevel),1)):k("",!0)]),e("div",wp,[c[r.id].editing?(o(),n("button",{key:1,class:"rounded bg-gray-100 px-2.5 py-1 text-xs font-medium text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",type:"button",onClick:h=>Je(r.id)}," 取消 ",8,Ap)):(o(),n("button",{key:0,class:"rounded bg-indigo-100 px-2.5 py-1 text-xs font-medium text-indigo-600 hover:bg-indigo-200 dark:bg-indigo-900/40 dark:text-indigo-200 dark:hover:bg-indigo-900",onClick:h=>He(r.id)}," 编辑 ",8,$p))])]),c[r.id].loading?(o(),n("div",Cp," 正在加载成本配置... ")):(o(),n("div",Up,[c[r.id].error?(o(),n("div",Tp,[e("span",null,p(c[r.id].error),1),e("button",{class:"rounded bg-yellow-500 px-2 py-1 text-[11px] text-white hover:bg-yellow-600",onClick:h=>mt(r.id)}," 重试 ",8,Ip)])):c[r.id].editing?(o(),n("form",{key:1,class:"space-y-3",onSubmit:at(h=>b(r.id),["prevent"])},[e("div",Vp,[e("label",Sp,[a[84]||(a[84]=$(" 计费类型 ",-1)),y(e("select",{"onUpdate:modelValue":h=>c[r.id].form.billingType=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},[(o(),n(ae,null,ue(gt,h=>e("option",{key:h.value,value:h.value},p(h.label),9,Rp)),64))],8,Mp),[[Jt,c[r.id].form.billingType]])]),e("label",Kp,[a[85]||(a[85]=$(" 成本模式 ",-1)),y(e("select",{"onUpdate:modelValue":h=>c[r.id].form.costTrackingMode=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},[(o(),n(ae,null,ue(nt,h=>e("option",{key:h.value,value:h.value},p(h.label),9,Pp)),64))],8,zp),[[Jt,c[r.id].form.costTrackingMode]])])]),e("div",Lp,[e("label",jp,[a[86]||(a[86]=$(" 币种 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].form.currency=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},null,8,Op),[[A,c[r.id].form.currency]])]),e("label",Fp,[a[87]||(a[87]=$(" 置信度 ",-1)),y(e("select",{"onUpdate:modelValue":h=>c[r.id].form.confidenceLevel=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},[(o(),n(ae,null,ue(Kt,h=>e("option",{key:h.value,value:h.value},p(h.label),9,Np)),64))],8,Dp),[[Jt,c[r.id].form.confidenceLevel]])])]),e("div",Ep,[e("label",qp,[a[88]||(a[88]=$(" 每百万 Token 成本 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].form.derivedRates.costPerMillion=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"单位：{{ costStates[account.id].form.currency || 'USD' }}",step:"0.0001",type:"number"},null,8,Wp),[[A,c[r.id].form.derivedRates.costPerMillion]])]),e("label",Gp,[a[89]||(a[89]=$(" 每请求成本 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].form.derivedRates.costPerRequest=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"单位：{{ costStates[account.id].form.currency || 'USD' }}",step:"0.0001",type:"number"},null,8,Bp),[[A,c[r.id].form.derivedRates.costPerRequest]])])]),e("div",Qp,[e("label",Hp,[a[90]||(a[90]=$(" 每积分成本 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].form.derivedRates.costPerPoint=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"单位：{{ costStates[account.id].form.currency || 'USD' }}",step:"0.0001",type:"number"},null,8,Jp),[[A,c[r.id].form.derivedRates.costPerPoint]])]),e("label",Yp,[a[91]||(a[91]=$(" 相对效率倍数 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].form.relativeEfficiency=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"例如 1.2",step:"0.01",type:"number"},null,8,Zp),[[A,c[r.id].form.relativeEfficiency]])])]),e("label",Xp,[a[92]||(a[92]=$(" 备注 ",-1)),y(e("textarea",{"onUpdate:modelValue":h=>c[r.id].form.notes=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"可记录成本来源、折扣等信息",rows:"2"},null,8,eg),[[A,c[r.id].form.notes]])]),e("div",tg,[e("button",{class:"rounded bg-gray-100 px-3 py-1 text-xs text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300",type:"button",onClick:h=>Je(r.id)}," 取消 ",8,sg),e("button",{class:"rounded bg-indigo-600 px-3 py-1 text-xs text-white hover:bg-indigo-700 disabled:opacity-60",disabled:c[r.id].saving,type:"submit"},p(c[r.id].saving?"保存中...":"保存"),9,ag)])],40,_p)):(o(),n("div",rg,[e("div",null," 计费类型："+p(Pt((N=c[r.id].profile)==null?void 0:N.billingType)),1),e("div",null," 成本模式："+p(Zt((de=c[r.id].profile)==null?void 0:de.costTrackingMode)),1),e("div",null,"币种："+p(((he=c[r.id].profile)==null?void 0:he.currency)||"USD"),1),e("div",null," 每百万 Token 成本： "+p(Xe((Ct=(we=c[r.id].profile)==null?void 0:we.derivedRates)==null?void 0:Ct.costPerMillion,(Ut=c[r.id].profile)==null?void 0:Ut.currency)),1),e("div",null," 每请求成本： "+p(Xe((It=(Tt=c[r.id].profile)==null?void 0:Tt.derivedRates)==null?void 0:It.costPerRequest,(Z=c[r.id].profile)==null?void 0:Z.currency)),1),e("div",null," 每积分成本： "+p(Xe((Vt=(_t=c[r.id].profile)==null?void 0:_t.derivedRates)==null?void 0:Vt.costPerPoint,(St=c[r.id].profile)==null?void 0:St.currency)),1),e("div",null," 相对效率倍数："+p(dt((ts=c[r.id].profile)==null?void 0:ts.relativeEfficiency,2)),1),e("div",null,"备注："+p(((fs=c[r.id].profile)==null?void 0:fs.notes)||"—"),1),e("div",lg," 最近更新："+p(_e((bs=c[r.id].profile)==null?void 0:bs.updatedAt)),1)]))]))]),e("div",og,[e("div",ng,[a[93]||(a[93]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"账单记录",-1)),e("button",{class:"rounded bg-blue-100 px-2.5 py-1 text-xs font-medium text-blue-600 hover:bg-blue-200 dark:bg-blue-900/40 dark:text-blue-200",onClick:h=>m(r.id)},p(c[r.id].billFormVisible?"取消":"录入账单"),9,ig)]),c[r.id].billsLoading?(o(),n("div",dg," 正在加载账单... ")):c[r.id].billsError?(o(),n("div",ug,p(c[r.id].billsError),1)):(o(),n("div",pg,[c[r.id].billFormVisible?(o(),n("form",{key:0,class:"space-y-2 rounded-md bg-gray-50 p-3 dark:bg-gray-900",onSubmit:at(h=>_(r.id),["prevent"])},[e("div",mg,[e("label",yg,[a[94]||(a[94]=$("开始日期 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.billingPeriodStart=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",type:"date"},null,8,xg),[[A,c[r.id].billForm.billingPeriodStart]])]),e("label",fg,[a[95]||(a[95]=$("结束日期 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.billingPeriodEnd=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",type:"date"},null,8,bg),[[A,c[r.id].billForm.billingPeriodEnd]])])]),e("div",cg,[e("label",vg,[a[96]||(a[96]=$("账单金额 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.totalAmount=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",step:"0.01",type:"number"},null,8,kg),[[A,c[r.id].billForm.totalAmount]])]),e("label",hg,[a[97]||(a[97]=$("币种 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.currency=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},null,8,wg),[[A,c[r.id].billForm.currency]])])]),e("div",$g,[e("label",Ag,[a[98]||(a[98]=$("消耗量 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.totalUnits=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"积分或额度",step:"0.0001",type:"number"},null,8,Cg),[[A,c[r.id].billForm.totalUnits]])]),e("label",Ug,[a[99]||(a[99]=$("单位名称 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].billForm.unitName=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",placeholder:"如 积分"},null,8,Tg),[[A,c[r.id].billForm.unitName]])])]),e("label",Ig,[a[100]||(a[100]=$("备注 ",-1)),y(e("textarea",{"onUpdate:modelValue":h=>c[r.id].billForm.notes=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",rows:"2"},null,8,_g),[[A,c[r.id].billForm.notes]])]),e("div",Vg,[e("button",{class:"rounded bg-gray-100 px-3 py-1 text-xs text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300",type:"button",onClick:h=>m(r.id)}," 取消 ",8,Sg),e("button",{class:"rounded bg-blue-600 px-3 py-1 text-xs text-white hover:bg-blue-700 disabled:opacity-60",disabled:c[r.id].billSubmitting,type:"submit"},p(c[r.id].billSubmitting?"保存中...":"保存"),9,Mg)])],40,gg)):k("",!0),c[r.id].billFormVisible?k("",!0):(o(),n("div",Rg,[!c[r.id].bills||c[r.id].bills.length===0?(o(),n("div",Kg," 暂无账单记录 ")):(o(),n("ul",zg,[(o(!0),n(ae,null,ue(c[r.id].bills,h=>(o(),n("li",{key:h.id,class:"rounded border border-gray-100 px-3 py-2 dark:border-gray-700"},[e("div",Pg,[e("span",null,p(_e(h.billingPeriodStart))+" ~ "+p(_e(h.billingPeriodEnd)),1),e("span",Lg,p(Xe(h.totalAmount,h.currency)),1)]),e("div",jg," 单位消耗："+p(dt(h.totalUnits,2))+" "+p(h.unitName||""),1)]))),128))]))]))]))]),e("div",Og,[e("div",Fg,[a[101]||(a[101]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"余额快照",-1)),e("button",{class:"rounded bg-emerald-100 px-2.5 py-1 text-xs font-medium text-emerald-600 hover:bg-emerald-200 dark:bg-emerald-900/40 dark:text-emerald-200",onClick:h=>Ie(r.id)},p(c[r.id].snapshotFormVisible?"取消":"新增快照"),9,Dg)]),c[r.id].snapshotsLoading?(o(),n("div",Ng," 正在加载余额... ")):c[r.id].snapshotsError?(o(),n("div",Eg,p(c[r.id].snapshotsError),1)):(o(),n("div",qg,[c[r.id].snapshotFormVisible?(o(),n("form",{key:0,class:"space-y-2 rounded-md bg-gray-50 p-3 dark:bg-gray-900",onSubmit:at(h=>zt(r.id),["prevent"])},[e("label",Gg,[a[102]||(a[102]=$("记录时间 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].snapshotForm.capturedAt=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",type:"datetime-local"},null,8,Bg),[[A,c[r.id].snapshotForm.capturedAt]])]),e("div",Qg,[e("label",Hg,[a[103]||(a[103]=$("余额数量 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].snapshotForm.balanceUnits=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",step:"0.0001",type:"number"},null,8,Jg),[[A,c[r.id].snapshotForm.balanceUnits]])]),e("label",Yg,[a[104]||(a[104]=$("单位 ",-1)),y(e("input",{"onUpdate:modelValue":h=>c[r.id].snapshotForm.unitName=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900"},null,8,Zg),[[A,c[r.id].snapshotForm.unitName]])])]),e("label",Xg,[a[105]||(a[105]=$("备注 ",-1)),y(e("textarea",{"onUpdate:modelValue":h=>c[r.id].snapshotForm.notes=h,class:"mt-1 w-full rounded border border-gray-200 px-2 py-1 text-xs dark:border-gray-600 dark:bg-gray-900",rows:"2"},null,8,em),[[A,c[r.id].snapshotForm.notes]])]),e("div",tm,[e("button",{class:"rounded bg-gray-100 px-3 py-1 text-xs text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300",type:"button",onClick:h=>Ie(r.id)}," 取消 ",8,sm),e("button",{class:"rounded bg-emerald-600 px-3 py-1 text-xs text-white hover:bg-emerald-700 disabled:opacity-60",disabled:c[r.id].snapshotSubmitting,type:"submit"},p(c[r.id].snapshotSubmitting?"保存中...":"保存"),9,am)])],40,Wg)):(o(),n("div",rm,[!c[r.id].snapshots||c[r.id].snapshots.length===0?(o(),n("div",lm," 暂无快照记录 ")):(o(),n("ul",om,[(o(!0),n(ae,null,ue(c[r.id].snapshots,h=>(o(),n("li",{key:h.id,class:"rounded border border-gray-100 px-3 py-2 dark:border-gray-700"},[e("div",nm,[e("span",null,p(_e(h.capturedAt)),1),e("span",im,p(dt(h.balanceUnits,2))+" "+p(h.unitName||""),1)]),e("div",dm," 置信度："+p(h.confidenceLevel||"未设置"),1)]))),128))]))]))]))])])):k("",!0),e("div",um,[e("div",pm,[e("div",gm,[a[106]||(a[106]=e("span",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},"API Key 明细",-1)),(cs=K.value[r.id])!=null&&cs.totalTokens?(o(),n("span",mm," 总 Tokens："+p(ce(K.value[r.id].totalTokens))+"M ",1)):k("",!0)]),e("div",ym,[(o(),n(ae,null,ue(ze,h=>{var $s,As,Cs;return e("button",{key:h.value,class:M(["rounded px-2 py-1 text-xs transition-colors",(($s=K.value[r.id])==null?void 0:$s.range)===h.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300"]),disabled:((As=K.value[r.id])==null?void 0:As.loading)&&((Cs=K.value[r.id])==null?void 0:Cs.range)===h.value,onClick:ix=>Te(r,h.value)},p(h.label),11,xm)}),64))])]),(vs=K.value[r.id])!=null&&vs.loading&&(((ks=K.value[r.id])==null?void 0:ks.items.length)===0||!((hs=K.value[r.id])!=null&&hs.initialized))?(o(),n("div",fm," 正在加载明细... ")):(ws=K.value[r.id])!=null&&ws.error?(o(),n("div",bm,[e("span",null,p(K.value[r.id].error),1),e("button",{class:"rounded bg-red-500 px-2 py-1 text-xs text-white hover:bg-red-600",onClick:h=>s(r,{range:K.value[r.id].range,reset:!0})}," 重试 ",8,cm)])):!K.value[r.id]||K.value[r.id].items.length===0?(o(),n("div",vm," 暂无明细数据 ")):(o(),n("div",km,[e("table",hm,[a[107]||(a[107]=e("thead",null,[e("tr",{class:"border-b border-gray-100 text-gray-500 dark:border-gray-700"},[e("th",{class:"py-2 pr-4 font-medium"},"API Key"),e("th",{class:"py-2 pr-4 font-medium"},"名称"),e("th",{class:"py-2 pr-4 font-medium"},"请求数"),e("th",{class:"py-2 pr-4 font-medium"},"Tokens (M)"),e("th",{class:"py-2 pr-4 font-medium"},"费用"),e("th",{class:"py-2 pr-4 font-medium"},"占比"),e("th",{class:"py-2 pr-4 font-medium"},"最后模型"),e("th",{class:"py-2 font-medium"},"最近更新")])],-1)),e("tbody",null,[(o(!0),n(ae,null,ue(K.value[r.id].items,h=>(o(),n("tr",{key:h.apiKeyId||h.keyId||h.id,class:"border-b border-gray-100 last:border-b-0 dark:border-gray-700"},[e("td",wm,p(h.apiKeyId||h.keyId||"-"),1),e("td",$m,[e("span",Am,p(h.apiKeyName||"-"),1)]),e("td",Cm,p(h.requests),1),e("td",Um,p(ce(h.totalTokens))+"M",1),e("td",Tm,p(h.totalCost&&h.totalCost>0?`$${st(h.totalCost)}`:"-"),1),e("td",Im,[e("span",_m,p(K.value[r.id].totalTokens>0?(h.totalTokens/K.value[r.id].totalTokens*100).toFixed(2):"0.00")+"% ",1)]),e("td",Vm,p(h.lastModel||"-"),1),e("td",Sm,p(h.lastUsedAt?is(h.lastUsedAt):"-"),1)]))),128))])]),e("div",Mm,[e("span",null,[$(" 共 "+p(K.value[r.id].total)+" 个 Key ",1),K.value[r.id].hasMore?(o(),n(ae,{key:0},[$(" ，已加载 "+p(K.value[r.id].items.length)+" 个 ",1)],64)):k("",!0)]),K.value[r.id].hasMore?(o(),n("button",{key:0,class:"rounded bg-gray-100 px-2 py-1 text-xs text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300",disabled:K.value[r.id].loading,onClick:h=>pt(r)},p(K.value[r.id].loading?"加载中...":"加载更多"),9,Rm)):k("",!0)])]))])])])):k("",!0)],64)}),128))])])])),!g.value&&et.value.length>0?(o(),n("div",Km,[(o(!0),n(ae,null,ue(et.value,r=>{var L,D,J,re,xe,me,fe,ve,ye,te,ke,Me,De,z,N,de,he,we,Ct,Ut,Tt,It;return o(),n("div",{key:r.id,class:"card p-4 transition-shadow hover:shadow-lg"},[e("div",zm,[e("div",Pm,[e("div",{class:M(["flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg",r.platform==="claude"?"bg-gradient-to-br from-purple-500 to-purple-600":r.platform==="bedrock"?"bg-gradient-to-br from-orange-500 to-red-600":r.platform==="azure_openai"?"bg-gradient-to-br from-blue-500 to-cyan-600":r.platform==="openai"?"bg-gradient-to-br from-gray-600 to-gray-700":r.platform==="ccr"?"bg-gradient-to-br from-teal-500 to-emerald-600":"bg-gradient-to-br from-blue-500 to-blue-600"])},[e("i",{class:M(["text-sm text-white",r.platform==="claude"?"fas fa-brain":r.platform==="bedrock"?"fab fa-aws":r.platform==="azure_openai"?"fab fa-microsoft":r.platform==="openai"?"fas fa-openai":r.platform==="ccr"?"fas fa-code-branch":"fas fa-robot"])},null,2)],2),e("div",null,[e("h4",Lm,p(r.name||r.email),1),e("div",jm,[e("span",Om,p(r.platform),1),a[108]||(a[108]=e("span",{class:"text-xs text-gray-400"},"|",-1)),e("span",Fm,p(r.type),1)]),e("div",Dm,[r.groupInfos&&r.groupInfos.length>0?(o(!0),n(ae,{key:0},ue(r.groupInfos,Z=>(o(),n("span",{key:Z.id,class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-[10px] font-medium text-gray-600 dark:bg-gray-700 dark:text-gray-400"},[a[109]||(a[109]=e("i",{class:"fas fa-folder mr-1"},null,-1)),$(p(Z.name),1)]))),128)):(o(),n("span",Nm,a[110]||(a[110]=[e("i",{class:"fas fa-user mr-1"},null,-1),$("未分组 ",-1)])))])])]),e("span",{class:M(["inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold",Rs(r)])},[e("div",{class:M(["mr-1.5 h-1.5 w-1.5 rounded-full",Ks(r)])},null,2),$(" "+p(Ms(r)),1)],2)]),e("div",Em,[e("div",null,[a[114]||(a[114]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"今日使用",-1)),e("div",qm,[e("div",Wm,[a[111]||(a[111]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-blue-500"},null,-1)),e("p",Gm,p(((D=(L=r.usage)==null?void 0:L.daily)==null?void 0:D.requests)||0)+" 次 ",1)]),e("div",Bm,[a[112]||(a[112]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-purple-500"},null,-1)),e("p",Qm,p(ce(((re=(J=r.usage)==null?void 0:J.daily)==null?void 0:re.allTokens)||0))+"M ",1)]),e("div",Hm,[a[113]||(a[113]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-green-500"},null,-1)),e("p",Jm," $"+p(xs(r)),1)])])]),e("div",null,[a[118]||(a[118]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"总用量",-1)),e("div",Ym,[e("div",Zm,[a[115]||(a[115]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-blue-600"},null,-1)),e("p",Xm,p(((me=(xe=r.usage)==null?void 0:xe.total)==null?void 0:me.requests)||0)+" 次 ",1)]),e("div",ey,[a[116]||(a[116]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-purple-600"},null,-1)),e("p",ty,p(ce(((ve=(fe=r.usage)==null?void 0:fe.total)==null?void 0:ve.allTokens)||0))+"M ",1)]),e("div",sy,[a[117]||(a[117]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-emerald-500"},null,-1)),e("p",ay," 平均每日 "+p(je((te=(ye=r.usage)==null?void 0:ye.averages)==null?void 0:te.dailyRequests))+" 次 ",1)])])]),e("div",null,[a[121]||(a[121]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"会话窗口",-1)),r.usage&&r.usage.sessionWindow?(o(),n("div",ry,[e("div",ly,[a[119]||(a[119]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-purple-500"},null,-1)),e("p",oy,p(ce(r.usage.sessionWindow.totalTokens))+"M ",1)]),e("div",ny,[a[120]||(a[120]=e("div",{class:"h-1.5 w-1.5 rounded-full bg-green-500"},null,-1)),e("p",iy," $"+p(st(r.usage.sessionWindow.totalCost)),1)])])):(o(),n("div",dy,"-"))])]),e("div",uy,[e("div",py,[a[122]||(a[122]=e("span",{class:"text-xs font-semibold text-gray-700 dark:text-gray-200"},"API Key 明细",-1)),e("div",gy,[(o(),n(ae,null,ue(ze,Z=>{var _t,Vt,St;return e("button",{key:Z.value,class:M(["rounded px-2 py-0.5 text-[11px] transition-colors",((_t=K.value[r.id])==null?void 0:_t.range)===Z.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300"]),disabled:((Vt=K.value[r.id])==null?void 0:Vt.loading)&&((St=K.value[r.id])==null?void 0:St.range)===Z.value,onClick:ts=>Te(r,Z.value)},p(Z.label),11,my)}),64))])]),(ke=K.value[r.id])!=null&&ke.loading&&(((Me=K.value[r.id])==null?void 0:Me.items.length)===0||!((De=K.value[r.id])!=null&&De.initialized))?(o(),n("div",yy," 正在加载明细... ")):(z=K.value[r.id])!=null&&z.error?(o(),n("div",xy,p(K.value[r.id].error),1)):!K.value[r.id]||K.value[r.id].items.length===0?(o(),n("div",fy," 暂无明细数据 ")):(o(),n("div",by,[(o(!0),n(ae,null,ue(K.value[r.id].items,Z=>(o(),n("div",{key:Z.apiKeyId||Z.keyId||Z.id,class:"flex items-center justify-between rounded bg-gray-50 px-2 py-1 text-[11px] dark:bg-gray-800"},[e("div",cy,[e("div",vy,p(Z.apiKeyId||Z.keyId||"-"),1),e("div",ky,p(Z.apiKeyName||"-"),1)]),e("div",hy,[e("span",null,p(Z.requests)+" 次",1),e("span",null,p(ce(Z.totalTokens))+"M",1),e("span",null,p(K.value[r.id].totalTokens>0?(Z.totalTokens/K.value[r.id].totalTokens*100).toFixed(1):"0.0")+"% ",1)])]))),128)),K.value[r.id].hasMore?(o(),n("button",{key:0,class:"mt-2 w-full rounded bg-gray-100 py-1 text-xs text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300",disabled:K.value[r.id].loading,onClick:Z=>pt(r)},p(K.value[r.id].loading?"加载中...":"加载更多"),9,wy)):k("",!0)]))]),e("div",$y,[r.platform==="claude"&&r.sessionWindow&&r.sessionWindow.hasActiveWindow?(o(),n("div",Ay,[e("div",Cy,[e("div",Uy,[a[124]||(a[124]=e("span",{class:"font-medium text-gray-600 dark:text-gray-300"},"会话窗口",-1)),Fe(x,{content:"会话窗口进度不代表使用量，仅表示距离下一个5小时窗口的剩余时间",placement:"top"},{default:Mt(()=>a[123]||(a[123]=[e("i",{class:"fas fa-question-circle cursor-help text-xs text-gray-400 hover:text-gray-600"},null,-1)])),_:1,__:[123]})]),e("span",Ty,p(r.sessionWindow.progress)+"% ",1)]),e("div",Iy,[e("div",{class:M(["h-full transition-all duration-300",ds(r.sessionWindow.sessionWindowStatus,r)]),style:lt({width:r.sessionWindow.progress+"%"})},null,6)]),e("div",_y,[e("span",Vy,p($t(r.sessionWindow.windowStart,r.sessionWindow.windowEnd)),1),r.sessionWindow.remainingTime>0?(o(),n("span",Sy," 剩余 "+p(At(r.sessionWindow.remainingTime)),1)):(o(),n("span",My," 已结束 "))])])):k("",!0),e("div",Ry,[a[125]||(a[125]=e("span",{class:"text-gray-500 dark:text-gray-400"},"最后使用",-1)),e("span",Ky,p(r.lastUsedAt?is(r.lastUsedAt):"从未使用"),1)]),r.proxyConfig&&r.proxyConfig.type!=="none"?(o(),n("div",zy,[a[126]||(a[126]=e("span",{class:"text-gray-500 dark:text-gray-400"},"代理",-1)),e("span",Py,p(r.proxyConfig.type.toUpperCase()),1)])):k("",!0),e("div",Ly,[a[127]||(a[127]=e("span",{class:"text-gray-500 dark:text-gray-400"},"优先级",-1)),e("span",jy,p(r.priority||50),1)])]),e("div",Oy,[e("button",{class:M(["flex flex-1 items-center justify-center gap-1 rounded-lg px-3 py-2 text-xs transition-colors",Re(r.id)?"bg-indigo-600 text-white hover:bg-indigo-500":"bg-indigo-50 text-indigo-600 hover:bg-indigo-100"]),onClick:Z=>T(r)},[e("i",{class:M(["fas",Re(r.id)?"fa-chevron-up":"fa-info-circle"])},null,2),$(" "+p(Re(r.id)?"收起":"详情"),1)],10,Fy),e("button",{class:M(["flex flex-1 items-center justify-center gap-1 rounded-lg px-3 py-2 text-xs transition-colors",r.schedulable?"bg-gray-50 text-gray-600 hover:bg-gray-100":"bg-green-50 text-green-600 hover:bg-green-100"]),disabled:r.isTogglingSchedulable,onClick:Z=>Se(r)},[e("i",{class:M(["fas",r.schedulable?"fa-pause":"fa-play"])},null,2),$(" "+p(r.schedulable?"暂停":"启用"),1)],10,Dy),e("button",{class:"flex-1 rounded-lg bg-gray-50 px-3 py-2 text-xs text-gray-600 transition-colors hover:bg-gray-100",onClick:Z=>i(r)},a[128]||(a[128]=[e("i",{class:"fas fa-edit mr-1"},null,-1),$(" 编辑 ",-1)]),8,Ny),e("button",{class:"rounded-lg bg-red-50 px-3 py-2 text-xs text-red-600 transition-colors hover:bg-red-100",onClick:Z=>Y(r)},a[129]||(a[129]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ey)]),Re(r.id)?(o(),n("div",qy,[e("div",Wy,[(o(!0),n(ae,null,ue(kt(r),Z=>(o(),n("div",{key:Z.key,class:"rounded-md border border-gray-200 bg-white/80 p-3 dark:border-gray-700 dark:bg-gray-900/80"},[e("div",Gy,[e("span",By,p(Z.title)+"使用 ",1),e("span",Qy,p(Z.subtitle),1)]),e("div",Hy,[e("div",Jy,[a[130]||(a[130]=e("span",null,"请求数",-1)),e("span",Yy,p(Z.requests),1)]),e("div",Zy,[a[131]||(a[131]=e("span",null,"Tokens",-1)),e("span",Xy,p(ce(Z.tokens))+"M ",1)]),e("div",ex,[a[132]||(a[132]=e("span",null,"费用",-1)),e("span",tx,p(bt(Z.cost)),1)]),e("div",sx,[a[133]||(a[133]=e("span",null,"Tokens / $",-1)),e("span",ax,p(ct(Z.tokensPerDollar)),1)]),e("div",rx,[a[134]||(a[134]=e("span",null,"$ / 1M Tokens",-1)),e("span",lx,p(vt(Z.costPerMillion)),1)])])]))),128))]),e("div",ox,[e("span",null,"平均 RPM："+p(je((de=(N=r.usage)==null?void 0:N.averages)==null?void 0:de.rpm)),1),e("span",null,"平均 TPM："+p(je((we=(he=r.usage)==null?void 0:he.averages)==null?void 0:we.tpm)),1),e("span",null,"平均每日请求："+p(je((Ut=(Ct=r.usage)==null?void 0:Ct.averages)==null?void 0:Ut.dailyRequests)),1),e("span",null,"平均每日 Tokens："+p(ce(((It=(Tt=r.usage)==null?void 0:Tt.averages)==null?void 0:It.dailyTokens)||0))+"M",1)])])):k("",!0)])}),128))])):k("",!0)]),Ke.value&&(!Ee.value||Ee.value!=="ccr")?(o(),Ne(Ts,{key:0,onClose:t,onPlatformChanged:a[11]||(a[11]=r=>Ee.value=r),onSuccess:S})):Ke.value&&Ee.value==="ccr"?(o(),Ne(Is,{key:1,onClose:t,onSuccess:S})):k("",!0),qe.value&&Ye.value&&Ye.value.platform==="ccr"?(o(),Ne(Is,{key:2,account:Ye.value,onClose:a[12]||(a[12]=r=>qe.value=!1),onSuccess:C},null,8,["account"])):qe.value?(o(),Ne(Ts,{key:3,account:Ye.value,onClose:a[13]||(a[13]=r=>qe.value=!1),onSuccess:C},null,8,["account"])):k("",!0),Fe(_s,{"cancel-text":Ue(v).cancelText,"confirm-text":Ue(v).confirmText,message:Ue(v).message,show:Ue(Ae),title:Ue(v).title,onCancel:Ue(G),onConfirm:Ue(V)},null,8,["cancel-text","confirm-text","message","show","title","onCancel","onConfirm"])])}}},xx=os(nx,[["__scopeId","data-v-f291ab5b"]]);export{xx as default};
