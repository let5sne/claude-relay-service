# Privateåˆ†æ”¯å·¥ä½œæµæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®é‡‡ç”¨**ç§æœ‰åˆ†æ”¯ç­–ç•¥**æ¥ä¿æŠ¤å•†ä¸šåŠŸèƒ½ï¼ŒåŒæ—¶æŒç»­æ¥æ”¶ä¸Šæ¸¸çš„æ ¸å¿ƒæ›´æ–°ã€‚

## ğŸŒ³ åˆ†æ”¯ç»“æ„

```
upstream/main (ä¸Šæ¸¸åŸå§‹ä»“åº“)
    â†“ å®šæœŸåŒæ­¥
origin/main (ä½ çš„å…¬å¼€fork)
    â†“ åˆå¹¶
origin/private (ä½ çš„ç§æœ‰å•†ä¸šåŠŸèƒ½åˆ†æ”¯) ğŸ”’
```

## ğŸ” ä¿æŠ¤æœºåˆ¶

### Git Hookä¿æŠ¤

- `.husky/pre-push` å·²é…ç½®è‡ªåŠ¨æ‹¦æˆª
- æ‰§è¡Œ `git push origin private` ä¼šè¢«è‡ªåŠ¨é˜»æ­¢
- éœ€è¦æ˜ç¡®ä½¿ç”¨ `--no-verify` æ‰èƒ½æ¨é€

### å¼ºåˆ¶ç¡®è®¤æ¨é€

å¦‚æœç¡®å®éœ€è¦æ¨é€privateåˆ†æ”¯ï¼š

```bash
git push --no-verify origin private
```

## ğŸ”„ æ—¥å¸¸å·¥ä½œæµ

### 1. å¼€å‘æ–°åŠŸèƒ½ï¼ˆåœ¨privateåˆ†æ”¯ï¼‰

```bash
# ç¡®ä¿åœ¨privateåˆ†æ”¯
git checkout private

# å¼€å‘ä½ çš„å•†ä¸šåŠŸèƒ½
# ... ç¼–ç  ...

# æäº¤åˆ°æœ¬åœ°
git add .
git commit -m "feat: æ·»åŠ æ–°çš„å•†ä¸šåŠŸèƒ½"

# âš ï¸ ä¸è¦æ¨é€åˆ°è¿œç¨‹ï¼ˆé™¤éæ˜ç¡®éœ€è¦ï¼‰
```

### 2. ä»ä¸Šæ¸¸åŒæ­¥æ›´æ–°ï¼ˆæ¨èä½¿ç”¨è„šæœ¬ï¼‰

#### æ–¹å¼Aï¼šä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
./scripts/sync-from-upstream.sh
```

#### æ–¹å¼Bï¼šæ‰‹åŠ¨åŒæ­¥

```bash
# 1. è·å–ä¸Šæ¸¸æ›´æ–°
git fetch upstream

# 2. æ›´æ–°mainåˆ†æ”¯
git checkout main
git merge upstream/main

# 3. ï¼ˆå¯é€‰ï¼‰æ¨é€mainåˆ°ä½ çš„fork
git push origin main

# 4. å°†ä¸Šæ¸¸æ›´æ–°åˆå¹¶åˆ°private
git checkout private
git merge main

# 5. è§£å†³å¯èƒ½çš„å†²çª
# å¦‚æœæœ‰å†²çªï¼Œæ‰‹åŠ¨è§£å†³åï¼š
git add .
git commit -m "merge: åŒæ­¥ä¸Šæ¸¸æ›´æ–°"
```

### 3. å‘ä¸Šæ¸¸è´¡çŒ®ä»£ç 

å¦‚æœä½ æƒ³è´¡çŒ®éå•†ä¸šåŠŸèƒ½åˆ°ä¸Šæ¸¸ï¼š

```bash
# 1. ä»privateåˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout private
git checkout -b feature/my-contribution

# 2. åªæäº¤æƒ³è¦è´¡çŒ®çš„ä»£ç 
git add <specific-files>
git commit -m "feat: æ·»åŠ æŸä¸ªåŠŸèƒ½"

# 3. æ¨é€åˆ°ä½ çš„fork
git push origin feature/my-contribution

# 4. åœ¨GitHubä¸Šåˆ›å»ºPRåˆ°ä¸Šæ¸¸
```

## ğŸ“Š æŸ¥çœ‹åˆ†æ”¯çŠ¶æ€

### æ£€æŸ¥æœ¬åœ°ä¸ä¸Šæ¸¸çš„å·®å¼‚

```bash
# æŸ¥çœ‹ä¸Šæ¸¸æœ‰å“ªäº›æ–°æäº¤
git log main..upstream/main

# æŸ¥çœ‹ä½ é¢†å…ˆä¸Šæ¸¸çš„æäº¤
git log upstream/main..main

# æŸ¥çœ‹privateåˆ†æ”¯ä¸mainçš„å·®å¼‚
git log main..private
```

### æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯

```bash
git remote -v
git branch -a
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### âœ… å¯ä»¥åšçš„

- âœ… åœ¨privateåˆ†æ”¯è‡ªç”±å¼€å‘å’Œæäº¤
- âœ… å®šæœŸä»ä¸Šæ¸¸åŒæ­¥æ›´æ–°åˆ°private
- âœ… æ¨é€mainåˆ†æ”¯åˆ°origin
- âœ… åˆ›å»ºåŠŸèƒ½åˆ†æ”¯è´¡çŒ®ä»£ç 

### âŒ é¿å…åšçš„

- âŒ ç›´æ¥æ¨é€privateåˆ†æ”¯ï¼ˆé™¤éæ˜ç¡®éœ€è¦ï¼‰
- âŒ åœ¨mainåˆ†æ”¯å¼€å‘å•†ä¸šåŠŸèƒ½
- âŒ å°†privateåˆ†æ”¯çš„å•†ä¸šä»£ç åˆå¹¶åˆ°main
- âŒ åœ¨å…¬å¼€PRä¸­æš´éœ²å•†ä¸šé€»è¾‘

## ğŸ”§ æ•…éšœæ’é™¤

### åˆå¹¶å†²çª

å¦‚æœåŒæ­¥æ—¶é‡åˆ°å†²çªï¼š

```bash
# 1. æŸ¥çœ‹å†²çªæ–‡ä»¶
git status

# 2. æ‰‹åŠ¨ç¼–è¾‘è§£å†³å†²çª

# 3. æ ‡è®°ä¸ºå·²è§£å†³
git add <resolved-files>

# 4. å®Œæˆåˆå¹¶
git commit
```

### è¯¯æ¨é€privateåˆ†æ”¯

å¦‚æœä¸å°å¿ƒæ¨é€äº†privateåˆ†æ”¯ï¼š

```bash
# ä»è¿œç¨‹åˆ é™¤ï¼ˆè°¨æ…æ“ä½œï¼ï¼‰
git push origin --delete private

# é‡æ–°åˆ›å»ºå¹²å‡€çš„privateåˆ†æ”¯
git checkout main
git branch -D private
git checkout -b private
```

### é‡ç½®åˆ°ä¸Šæ¸¸çŠ¶æ€

å¦‚æœæƒ³å®Œå…¨é‡ç½®mainåˆ°ä¸Šæ¸¸ï¼š

```bash
git checkout main
git reset --hard upstream/main
git push origin main --force
```

## ğŸ“ æœ€ä½³å®è·µ

1. **å®šæœŸåŒæ­¥**ï¼šæ¯å‘¨è‡³å°‘åŒæ­¥ä¸€æ¬¡ä¸Šæ¸¸æ›´æ–°
2. **å°æ­¥æäº¤**ï¼šåœ¨privateåˆ†æ”¯é¢‘ç¹æäº¤ï¼Œä¾¿äºå›æ»š
3. **æ¸…æ™°å‘½å**ï¼šæäº¤ä¿¡æ¯æ¸…æ™°ï¼Œä¾¿äºåŒºåˆ†å•†ä¸šåŠŸèƒ½å’Œä¸Šæ¸¸åŠŸèƒ½
4. **å¤‡ä»½é‡è¦**ï¼šå®šæœŸå¤‡ä»½privateåˆ†æ”¯ï¼ˆå¯ä»¥æ¨é€åˆ°ç§æœ‰ä»“åº“ï¼‰
5. **ç¯å¢ƒå˜é‡**ï¼šæ•æ„Ÿé…ç½®ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä¸è¦ç¡¬ç¼–ç 

## ğŸš€ å¿«é€Ÿå‚è€ƒ

```bash
# åŒæ­¥ä¸Šæ¸¸ï¼ˆä½¿ç”¨è„šæœ¬ï¼‰
./scripts/sync-from-upstream.sh

# æŸ¥çœ‹å½“å‰åˆ†æ”¯
git branch --show-current

# åˆ‡æ¢åˆ°privateåˆ†æ”¯
git checkout private

# æŸ¥çœ‹ä¸Šæ¸¸æ›´æ–°
git fetch upstream && git log main..upstream/main --oneline

# å¼ºåˆ¶æ¨é€privateï¼ˆéœ€è¦æ˜ç¡®ç¡®è®¤ï¼‰
git push --no-verify origin private
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹GitçŠ¶æ€ï¼š`git status`
2. æŸ¥çœ‹æäº¤å†å²ï¼š`git log --oneline --graph --all -20`
3. æŸ¥çœ‹è¿œç¨‹é…ç½®ï¼š`git remote -v`
4. å¤‡ä»½å½“å‰å·¥ä½œï¼š`git stash` æˆ–åˆ›å»ºä¸´æ—¶åˆ†æ”¯

---

**è®°ä½ï¼šprivateåˆ†æ”¯æ˜¯ä½ çš„å•†ä¸šç§˜å¯†ï¼Œè°¨æ…æ¨é€ï¼** ğŸ”’
